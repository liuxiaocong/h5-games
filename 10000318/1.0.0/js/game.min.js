function SpritePool(){if(SpritePool._isBirth)throw new Error("This class is a singleton!");SpritePool._instance=this,SpritePool._isBirth=!0;var a=[];this.get=function(b){for(var c in a)if(a[c].texture===PIXI.TextureCache[b])return a.splice(c,1)[0];return PIXI.Sprite.fromFrame(b)},this.recycle=function(b){a.push(b)}}function onReady(){FidoAudio.init(),stressTest=new PIXI.StressTest(onStressTestComplete),resize()}function onStressTestComplete(){GAME.lowMode=stressTest.result<40,interactive=!1,document.body.scroll="no",loader=new PIXI.AssetLoader(["img/stretched_hyper_tile.jpg","img/SplashAssets.json","img/WorldAssets-hd.json","img/HudAssets-hd.json","img/PixiAssets-hd.json","img/iP4_BGtile.jpg","img/blackSquare.jpg","assets/hud/pausedPanel.png","assets/hud/pixieRevised_controls.png","assets/hud/ContinuePlay.png","assets/hud/RestartPlay.png","assets/hud/soundOff.png","assets/hud/soundOn.png","assets/hud/pause.png","assets/hud/PersonalBest.png"]),loader.addEventListener("onComplete",function(){init(),clearInterval(loadInterval)}),loader.load(),resize()}function onTap(a){if("button"!==a.target.type){if(!interactive)return;gameMode===GAME_MODE.INTRO?(interactive=!1,gameMode=GAME_MODE.TITLE,logo.alpha=0,logo.scale.x=1.5,logo.scale.y=1.5,logo.setTexture(PIXI.Texture.fromFrame("assets/hud/pixieRevised_controls.png")),TweenLite.to(logo,.1,{alpha:1}),TweenLite.to(logo.scale,1,{x:1,y:1,ease:Elastic.easeOut,onComplete:onIntroFaded})):gameMode===GAME_MODE.TITLE?(interactive=!1,game.start(),gameMode=GAME_MODE.COUNT_DOWN,FidoAudio.setVolume("runRegular",1),black&&TweenLite.to(black,.2,{alpha:0}),TweenLite.to(logo,.3,{alpha:0,onComplete:function(){logo.visible=!1,logo.setTexture(PIXI.Texture.fromFrame("gameOver.png")),game.view.showHud(),game.view.hud.removeChild(black),countdown.startCountDown(onCountdownComplete)}})):gameMode===GAME_MODE.GAME_OVER?TGS.Advertisement.DisplayInterstitialAd({closeCallback:function(){interactive=!1,game.view.stage.addChild(black),TweenLite.to(black,.3,{alpha:1,onComplete:function(){game.steve.normalMode(),game.joyrideComplete(),game.steve.position.x=0,GAME.camera.x=game.steve.position.x-100,game.reset(),logo.visible=!1,gameMode=GAME_MODE.COUNT_DOWN,TweenLite.killTweensOf(GAME.camera),GAME.camera.zoom=1,TweenLite.to(black,.3,{alpha:0,onComplete:function(){logo.visible=!1,game.start(),FidoAudio.fadeIn("gameMusic"),countdown.startCountDown(onCountdownComplete)}})}})}.bind(this)}):(thrusters=!0,game.isPlaying&&game.steve.jump())}}function init(){gameMode=GAME_MODE.INTRO,interactive=!1,game=new GAME.RprEngine,document.body.appendChild(game.view.renderer.view),game.view.renderer.view.style.position="absolute",game.view.renderer.view.webkitImageSmoothingEnabled=!1,GAME.lowMode?setInterval(update,1e3/30):requestAnimFrame(update),game.onGameover=onGameover,black=new PIXI.Sprite.fromImage("img/blackSquare.jpg"),this.game.view.hud.addChild(black),TweenLite.to(black,.3,{alpha:.75,delay:.5}),logo=PIXI.Sprite.fromFrame("runLogo.png"),logo.anchor.x=.5,logo.anchor.y=.5,logo.alpha=0,this.game.view.hud.addChild(logo),personalBestTitle=PIXI.Sprite.fromImage("assets/hud/PersonalBest.png"),personalBestTitle.anchor.x=.5,personalBestTitle.anchor.y=.5,personalBestTitle.alpha=0,personalBestTitle.scale.x=1.5,personalBestTitle.scale.y=1.5,this.game.view.hud.addChild(personalBestTitle);var a=PIXI.Sprite.fromFrame("spaceStart.png");a.anchor.x=.5,a.position.y=200,TweenLite.to(logo,.1,{alpha:1,delay:.6,onComplete:onIntroFaded}),countdown=new GAME.Countdown,this.game.view.hud.addChild(countdown),pauseButton=PIXI.Sprite.fromFrame("assets/hud/pause.png"),pauseButton.interactive=!0,pauseButton.anchor.x=.5,pauseButton.anchor.y=.5,pauseButton.alpha=0,pauseButton.visible=!1,pauseButton.type="button",pauseScreen=PIXI.Sprite.fromImage("assets/hud/pausedPanel.png"),pauseScreen.anchor.x=.5,pauseScreen.anchor.y=.5,pauseScreen.scale.x=1.5,pauseScreen.scale.y=1.5,pauseScreen.alpha=0,pauseScreen.visible=!1,resumeButton=PIXI.Sprite.fromImage("assets/hud/ContinuePlay.png"),resumeButton.anchor.x=.5,resumeButton.anchor.y=.5,resumeButton.scale.x=0,resumeButton.scale.y=0,resumeButton.alpha=0,resumeButton.interactive=!0,resumeButton.touchstart=resumeButton.mousedown=function(){onResumePressed()},restartButton=PIXI.Sprite.fromImage("assets/hud/RestartPlay.png"),restartButton.anchor.x=.5,restartButton.anchor.y=.5,restartButton.scale.x=0,restartButton.scale.y=0,restartButton.alpha=0,restartButton.interactive=!0,restartButton.touchstart=restartButton.mousedown=function(){onRestartPressed()},soundOffButton=PIXI.Sprite.fromImage("assets/hud/soundOff.png"),soundOffButton.anchor.x=.5,soundOffButton.anchor.y=.5,soundOffButton.scale.x=0,soundOffButton.scale.y=0,soundOffButton.alpha=0,soundOffButton.interactive=!0,soundOffButton.touchstart=soundOffButton.mousedown=function(){onSoundOffPressed()},soundOnButton=PIXI.Sprite.fromImage("assets/hud/soundOn.png"),soundOnButton.anchor.x=.5,soundOnButton.anchor.y=.5,soundOnButton.scale.x=0,soundOnButton.scale.y=0,soundOnButton.alpha=0,soundOnButton.interactive=!0,soundOnButton.touchstart=soundOnButton.mousedown=function(){onSoundOnPressed()},this.game.view.stage.addChild(pauseScreen),this.game.view.stage.addChild(resumeButton),this.game.view.stage.addChild(restartButton),this.game.view.stage.addChild(soundOffButton),this.game.view.stage.addChild(soundOnButton),this.game.view.stage.addChild(pauseButton),pauseButton.touchstart=pauseButton.mousedown=function(a){a.originalEvent.preventDefault(),onPaused()},this.game.view.container.mousedown=this.game.view.container.touchstart=function(a){onTap(a)},this.game.view.container.mouseup=this.game.view.container.touchend=function(a){onTouchEnd(a)},FidoAudio.play("gameMusic"),FidoAudio.play("runRegular"),FidoAudio.play("runFast"),this.stressTest.remove(),resize()}function onResumePressed(){onPaused()}function onRestartPressed(){onPaused(),game.steve.die(),game.gameover()}function onSoundOnPressed(){FidoAudio.muteAll(),TweenLite.to(soundOnButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(soundOnButton,.1,{alpha:0}),TweenLite.to(soundOffButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),TweenLite.to(soundOffButton,.1,{alpha:1})}function onSoundOffPressed(){FidoAudio.unMuteAll(),TweenLite.to(soundOffButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(soundOffButton,.1,{alpha:0}),TweenLite.to(soundOnButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),TweenLite.to(soundOnButton,.1,{alpha:1})}function pauseEnded(){pauseScreen.visible=!1,pauseScreen.scale.x=1.5,pauseScreen.scale.y=1.5,resumeButton.alpha=0,resumeButton.visible=!1,restartButton.alpha=0,restartButton.visible=!1,soundOnButton.alpha=0,soundOnButton.visible=!1,soundOffButton.alpha=0,soundOffButton.visible=!1}function onPaused(){pauseButton.scale.set(.5),TweenLite.to(pauseButton.scale,.5,{x:1,y:1,ease:Elastic.easeOut}),gameMode===GAME_MODE.PAUSED?(game.steve.resume(),interactive=!0,gameMode=prevState,prevState=!1,TweenLite.to(soundOffButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(soundOffButton,.1,{alpha:0}),TweenLite.to(soundOnButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(soundOnButton,.1,{alpha:0}),TweenLite.to(resumeButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(resumeButton,.1,{alpha:0}),TweenLite.to(restartButton.scale,.6,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(restartButton,.1,{alpha:0}),TweenLite.to(pauseScreen.scale,1,{x:0,y:0,ease:Elastic.easeOut}),TweenLite.to(pauseScreen,.1,{alpha:0})):(game.steve.stop(),prevState=gameMode,gameMode=GAME_MODE.PAUSED,interactive=!1,pauseScreen.visible=!0,TweenLite.to(pauseScreen,.1,{alpha:1}),TweenLite.to(pauseScreen.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),FidoAudio.isMuted()===!1?(TweenLite.to(soundOnButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),TweenLite.to(soundOnButton,.1,{alpha:1})):(TweenLite.to(soundOffButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),TweenLite.to(soundOffButton,.1,{alpha:1})),TweenLite.to(resumeButton,.1,{alpha:1}),TweenLite.to(resumeButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}),TweenLite.to(restartButton,.1,{alpha:1}),TweenLite.to(restartButton.scale,.6,{x:1,y:1,ease:Elastic.easeOut}))}function onIntroFaded(){interactive=!0}function onGameover(){FidoAudio.setVolume("thrusters",0),TweenLite.to(pauseButton,.6,{alpha:0,onComplete:function(){pauseButton.visible=!1}}),gameMode=GAME_MODE.GAME_OVER,interactive=!1}function showGameover(){logo.visible=!0,TweenLite.to(logo,.3,{alpha:1,onComplete:onGameoverShown})}function onGameoverShown(){this.isGameReallyOver=!0,interactive=!0}function onTouchStart(a){onTap(a)}function onCountdownComplete(){interactive=!0,gameMode=GAME_MODE.PLAYING,pauseButton.visible=!0,TweenLite.to(pauseButton,.6,{alpha:1})}function onTouchEnd(a){a.originalEvent.preventDefault(),thrusters=!1,FidoAudio.setVolume("thrusters",0),game.isPlaying&&game.steve.fall()}function resize(){var a=window.innerWidth||document.body.clientWidth,b=window.innerHeight||document.body.clientHeight,c=b/640;if(this.stressTest.resize(a,b),game){var d=game.view.renderer.view;d.style.height=640*c+"px";var e=a/c;d.style.width=a+"px",this.logo.position.x=e/2,this.logo.position.y=300,black&&(black.scale.x=e/16,black.scale.y=40),this.countdown.position.x=e/2,this.countdown.position.y=320,game.view.resize(e,640),pauseButton.position.x=e-60,pauseButton.position.y=580,pauseScreen.position.x=.5*e,pauseScreen.position.y=320,resumeButton.position.x=.5*e,resumeButton.position.y=320,restartButton.position.x=.5*e+125,restartButton.position.y=320,soundOffButton.position.x=.5*e-125,soundOffButton.position.y=320,soundOnButton.position.x=.5*e-125,soundOnButton.position.y=320}GAME.width=a/c,GAME.height=640}function update(){game.update(),GAME.lowMode||(FidoAudio.isMuted()===!1&&(thrustersVolume+=thrusters===!0?.1*(.4-thrustersVolume):.1*(0-thrustersVolume),.01>thrustersVolume&&(thrustersVolume=0),FidoAudio.setVolume("thrusters",thrustersVolume)),requestAnimFrame(update))}function formatScore(a){for(var b=a.toString().split(""),c="",d=b.length,e=d%3-1,f=0;d>f;f++)c+=b[f],(f-e)%3==0&&f!=d-1&&(c+=",");return c}data=[{length:3405.1,floor:[0,1135,2270],blocks:[2297,460,2577,460,2888,460,3172,464],coins:[757,452,1058,452,904,452,1228,452,1385,452,1718,350,1545,452,1892,254,2114,168,2466,132,2777,154,3039,132,3283,122]},{length:3405.1,floor:[0,1135,2270],blocks:[809,292,1057,292,1293,292,1517,292,2127,394,2349,290,2611,314,2802,290,157,416],coins:[757,452,1058,452,904,452,1228,452,1385,452,2103,178,1545,452,2341,82,2643,82,3025,132,3293,264]},{length:3405.1,floor:[0,2270],blocks:[1420,588,2466,462,2630,466,2549,360,335,106,1440,480,1736,588,1716,488,1736,382,1728,274,2038,588,2054,488,2038,382,687,152,871,208,1081,88],coins:[69,264,1058,452,904,452,1192,396,1337,320,2103,192,1455,204,2265,152,3075,272,3319,264,1604,132,1769,92,1914,154,2403,118,504,452,624,452,211,300,3191,260]},{length:3405.1,floor:[0,2270],blocks:[2466,462,2630,466,2549,360,896,464,1061,468,980,362,1659,300,1633,198,1653,94,1633,-12],coins:[69,264,3075,224,3319,264,211,300,3191,260,349,346,487,340,615,254,753,152,1559,554,1681,542,1831,520,1441,462,1943,448,2055,350,2425,124,2917,210,2743,152]},{length:3405.1,floor:[0,1135,2270],blocks:[2466,462,2630,466,2549,360,896,464,1061,468,690,468,664,366,684,262,868,360],coins:[69,264,3075,224,3319,264,211,264,3191,260,349,210,1725,412,1817,369,1943,410,1641,488,2055,448,2163,412,2255,310,2917,210,2743,152,469,128,595,90,947,164,1241,478,1339,488,1431,488,1533,488,2389,214,2569,164]},{length:5445.3,floor:[0,4310],blocks:[1844,248,2001,292,3223,102,3608,120,3285,492,2303,230,4740,102,5352,462,2158,216,4021,444,4081,154,4928,188,5073,144,4199,536,2583,592,2625,488,2828,592,2784,492,2706,390,3259,592,3666,662,3686,554,3666,444,1494,492,1151,120,875,26],coins:[205,258,953,306,1344,308,3245,308,2708,158,3e3,256,4086,308,4012,286,3934,276,4164,340,3502,292,801,274,4961,452,5041,452,5121,452,5201,406,4881,452,1932,66,1132,362,5293,320,251,306,251,220,297,268,385,258,431,306,431,220,477,268,565,258,611,306,611,220,657,268,1514,206,1672,108,2148,52,2414,72,3744,268,4364,394,4616,448,5399,276,61,268]},{length:2270.1,floor:[1135],blocks:[158,404,352,534,1840,248,1160,209,1150,98,443,160,1170,-10,649,241,529,16,921,291,2178,82],coins:[404,347,66,272,580,481,228,270,750,504,1541,194,1705,96,1848,72,1978,128,2070,255,949,504,1123,430,1302,368,1411,267]},{length:3405.1,floor:[0,1135],blocks:[352,468,1160,468,718,218,710,101,730,-7,3310,454,1288,468,1226,366,1433,468,1350,366,1266,254,1922,326,1782,234,3302,88,2570,352,2349,326],coins:[1838,494,448,304,66,250,608,378,3179,290,3341,282,228,270,798,408,961,304,1053,238,1145,96,1726,494,2078,494,1966,494,2300,492,2188,492,2538,494,2426,494,2802,464,2666,494,3038,346,2926,418]},{length:5445.3,floor:[0,1720,4310],blocks:[1042,114,2066,114,2269,114,3415,326,4425,468,408,260,2736,464,3575,322,3743,330,3911,334],coins:[1089,460,768,456,2041,332,1851,332,2704,176,3048,256,1009,460,929,460,849,460,1169,476,1249,516,2137,384,1947,384,2401,332,2211,332,2497,384,2307,384,3488,484,3608,484,3728,484,3848,484,4274,256,4408,224,4550,266,4652,372,4900,446,5e3,374,5128,310,5252,266,5384,262,4764,458,688,456,608,456,528,456]},{length:5445.3,floor:[0,4310],blocks:[1236,178,1674,380,2229,122,3223,102,3984,364,3285,492,2552,496,4740,102,5352,462],coins:[293,296,641,106,953,306,1668,204,2087,444,2636,138,3e3,256,4048,524,3896,504,4168,436,4252,308,3752,420,801,226,4961,452,5041,452,5121,452,5201,406,4881,452,2372,306,1294,394,5325,276,1576,538,1636,538,1696,538,1756,538]},{length:3405.1,floor:[0,1135,2270],blocks:[966,332,1145,300,1321,308,2217,224,2349,290,2510,348,2802,290,1526,332,1694,376,849,32,1030,12,1185,-28,1361,-12,1566,12,1734,36,660,472,797,380,1834,472,653,60],coins:[842,204,2039,88,2224,444,2381,468,2901,88,922,180,1002,180,1082,160,1162,148,1242,152,1322,152,1402,164,1482,176,1562,176,1642,204,1894,164,70,276,382,234,526,266,2541,468,2701,468,2861,468,2555,128,3129,296,3293,272,3015,382,650,276,750,234,238,262,1947,326]},{length:3405.1,floor:[0,1135,2270],blocks:[190,468,438,468,1827,469,2706,469,1840,248,1166,241,1158,124,2988,92,347,98,1852,359,2706,190,2732,84,2702,-22,1178,16,3238,28,3090,468],coins:[2103,210,2452,304,448,304,66,250,608,240,3035,250,3179,274,3341,282,228,270,776,316,928,368,1669,118,1727,76,1799,96,1860,76,1940,62,2002,118,2544,323,2618,336,2700,340,2792,330,2894,274,1053,494,1125,494,1205,494,1285,474,1347,412]},{length:3405.1,floor:[0,1135,2270],blocks:[518,462,1845,462,157,194,1205,98,3217,86,3039,462,2187,208,2595,298,1417,224,2309,258,2447,291,2735,268],coins:[757,426,1058,452,904,452,1228,452,1385,452,2224,444,1545,452,2341,448,2467,448,2585,448,2685,448,2805,448,273,392,352,284,496,240,630,314]},{length:5445.3,floor:[],blocks:[785,84,1179,362,1823,468,3415,326,4425,468,584,502,4868,144,3743,356,3911,334,3258,408,3040,520,4123,372,2131,132,2580,502,201,104,2804,96,2980,116,4711,74,985,304,1628,510],coins:[294,346,2526,270,2806,286,4368,164,4608,244,4712,294,4810,338,4902,378,4996,416,5092,414,5182,386,5274,334,5378,312,390,316,506,276,626,312,750,398,906,484,1050,504,1196,504,1352,442,1476,380,1560,324,1660,276,1790,256,1909,312,2037,380,2163,400,2287,364,2393,312,2654,244,2936,330,3060,298,3152,212,3234,140,3350,98,3474,86,3613,126,3756,110,3868,86,4004,90,4132,110,4248,132,4492,190,194,322,68,302]},{length:5445.3,floor:[],blocks:[2439,304,967,294,4573,286,3146,344,1119,314,1463,84,2019,52,1453,574,248,460,390,414,570,488,2636,606,2778,560,3290,364,3600,70,4152,90,4896,594,5078,106,5272,126],coins:[192,282,2546,434,4980,314,5122,336,5262,310,5376,300,67,304,330,246,468,216,626,272,750,358,906,444,1050,464,1196,464,1352,402,1476,340,1560,284,1660,236,1790,216,1909,272,2037,380,2163,446,2295,504,2421,484,2654,370,756,220,848,150,978,130,1118,150,1242,210,1352,292,1568,430,1690,450,1802,426,1909,392,2103,282,2211,196,2311,128,2575,182,2435,144,2687,268,4730,416,2806,322,2930,408,3086,494,3230,514,3376,514,3532,452,3640,380,3744,306,3845,258,3975,238,4094,294,4222,362,4348,428,4480,486,4606,466,4838,352,2936,270,3028,200,3158,180,3298,200,3422,260,3532,342,3753,452,3875,472,3987,448,4094,414,4288,264,4396,178,4496,110,4760,164,4620,126,4872,250]},{length:5763.35,floor:[0,1720,3182,4626],blocks:[976,240,2066,114,2227,168,3415,296,4797,260,288,468,4035,144,3575,322,3743,330,3911,272,1291,606,1454,580,1588,608,2480,92,3271,154,3081,-14,5329,468,5603,468,5033,92],coins:[621,330,300,262,1987,434,1167,388,2575,398,3048,256,541,302,461,280,381,266,701,370,781,426,2087,458,1897,458,2347,434,2157,434,2447,458,2257,458,3488,484,3608,484,3728,484,3848,484,4274,256,4408,224,4550,266,4652,372,4900,446,5e3,374,5128,310,5252,254,5414,236,4764,458,220,262,140,262,60,262,1293,298,1431,256,1588,310,1734,416,2686,312,2861,256,4002,475,4126,372,3228,388,5556,256,5688,256]}],function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}(),!function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()}("domready",function(){function a(a){for(g=1;a=c.shift();)a()}var b,c=[],d=!1,e=document,f="DOMContentLoaded",g=/^loaded|^c/.test(e.readyState);return e.addEventListener(f,b=function(){e.removeEventListener(f,b,d),a()},d),function(a){g?a():c.push(a)}}),(window._gsQueue||(window._gsQueue=[])).push(function(){_gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(a,b,c){"use strict";var d=function(a){b.call(this,a),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;for(var c,d,f=e.length;--f>-1;)if(d=this.vars[e[f]])for(c=d.length;--c>-1;)"{self}"===d[c]&&(d=this.vars[e[f]]=d.concat(),d[c]=this);this.vars.tweens instanceof Array&&this.add(this.vars.tweens,0,this.vars.align,this.vars.stagger)},e=["onStartParams","onUpdateParams","onCompleteParams","onReverseCompleteParams","onRepeatParams"],f=[],g=function(a){var b,c={};for(b in a)c[b]=a[b];return c},h=d.prototype=new b;return d.version="1.8.0",h.constructor=d,h.kill()._gc=!1,h.to=function(a,b,d,e){return this.add(new c(a,b,d),e)},h.from=function(a,b,d,e){return this.add(c.from(a,b,d),e)},h.fromTo=function(a,b,d,e,f){return this.add(c.fromTo(a,b,d,e),f)},h.staggerTo=function(a,b,e,f,h,i,j,k){var l=new d({onComplete:i,onCompleteParams:j,onCompleteScope:k});f=f||0;for(var m=0;a.length>m;m++)null!=e.startAt&&(e.startAt=g(e.startAt)),l.add(new c(a[m],b,g(e)),m*f);return this.add(l,h)},h.staggerFrom=function(a,b,c,d,e,f,g,h){return null==c.immediateRender&&(c.immediateRender=!0),c.runBackwards=!0,this.staggerTo(a,b,c,d,e,f,g,h)},h.staggerFromTo=function(a,b,c,d,e,f,g,h,i){return d.startAt=c,c.immediateRender&&(d.immediateRender=!0),this.staggerTo(a,b,d,e,f,g,h,i)},h.call=function(a,b,d,e){return this.add(c.delayedCall(0,a,b,d),e)},h.set=function(a,b,d){return b.immediateRender=!1,this.add(new c(a,0,b),d)},d.exportRoot=function(a,b){a=a||{},null==a.smoothChildTiming&&(a.smoothChildTiming=!0);var e=new d(a),f=e._timeline;null==b&&(b=!0),f._remove(e,!0),e._startTime=0,e._rawPrevTime=e._time=e._totalTime=f._time;for(var g,h=f._first;h;)g=h._next,b&&h instanceof c&&h.target===h.vars.onComplete||e.add(h,h._startTime-h._delay),h=g;return f.add(e,0),e},h.add=function(e,f,g,h){if("number"!=typeof f&&(f=this._parseTimeOrLabel(f,0,!0,e)),e instanceof a);else{if(e instanceof Array){g=g||"normal",h=h||0;var i,j,k=f,l=e.length;for(i=0;l>i;i++)(j=e[i])instanceof Array&&(j=new d({tweens:j})),this.add(j,k),"string"!=typeof j&&"function"!=typeof j&&("sequence"===g?k=j._startTime+j.totalDuration()/j._timeScale:"start"===g&&(j._startTime-=j.delay())),k+=h;return this._uncache(!0)}if("string"==typeof e)return this.addLabel(e,f);if("function"!=typeof e)throw"Cannot add "+e+" into the TimelineLite/Max: it is neither a tween, timeline, function, nor a String.";e=c.delayedCall(0,e)}if(b.prototype.add.call(this,e,f),this._gc&&!this._paused&&this._time===this._duration&&this._time<this.duration())for(var m=this;m._gc&&m._timeline;)m._timeline.smoothChildTiming?m.totalTime(m._totalTime,!0):m._enabled(!0,!1),m=m._timeline;return this},h.remove=function(b){if(b instanceof a)return this._remove(b,!1);if(b instanceof Array){for(var c=b.length;--c>-1;)this.remove(b[c]);return this}return"string"==typeof b?this.removeLabel(b):this.kill(null,b)},h.append=function(a,b){return this.add(a,this._parseTimeOrLabel(null,b,!0,a))},h.insert=h.insertMultiple=function(a,b,c,d){return this.add(a,b||0,c,d)},h.appendMultiple=function(a,b,c,d){return this.add(a,this._parseTimeOrLabel(null,b,!0,a),c,d)},h.addLabel=function(a,b){return this._labels[a]=this._parseTimeOrLabel(b),this},h.removeLabel=function(a){return delete this._labels[a],this},h.getLabelTime=function(a){return null!=this._labels[a]?this._labels[a]:-1},h._parseTimeOrLabel=function(b,c,d,e){var f;if(e instanceof a&&e.timeline===this)this.remove(e);else if(e instanceof Array)for(f=e.length;--f>-1;)e[f]instanceof a&&e[f].timeline===this&&this.remove(e[f]);if("string"==typeof c)return this._parseTimeOrLabel(c,d&&"number"==typeof b&&null==this._labels[c]?b-this.duration():0,d);if(c=c||0,"string"!=typeof b||!isNaN(b)&&null==this._labels[b])null==b&&(b=this.duration());else{if(f=b.indexOf("="),-1===f)return null==this._labels[b]?d?this._labels[b]=this.duration()+c:c:this._labels[b]+c;c=parseInt(b.charAt(f-1)+"1",10)*Number(b.substr(f+1)),b=f>1?this._parseTimeOrLabel(b.substr(0,f-1),0,d):this.duration()}return Number(b)+c},h.seek=function(a,b){return this.totalTime("number"==typeof a?a:this._parseTimeOrLabel(a),b!==!1)},h.stop=function(){return this.paused(!0)},h.gotoAndPlay=function(a,c){return b.prototype.play.call(this,a,c)},h.gotoAndStop=function(a,b){return this.pause(a,b)},h.render=function(a,b,c){this._gc&&this._enabled(!0,!1),this._active=!this._paused;var d,e,g,h,i=this._dirty?this.totalDuration():this._totalDuration,j=this._time,k=this._startTime,l=this._timeScale,m=this._paused;if(a>=i?(this._totalTime=this._time=i,this._reversed||this._hasPausedChild()||(e=!0,h="onComplete",0===this._duration&&(0===a||0>this._rawPrevTime)&&this._rawPrevTime!==a&&(c=!0)),this._rawPrevTime=a,a=i+1e-6):0>=a?(this._totalTime=this._time=0,(0!==j||0===this._duration&&this._rawPrevTime>0)&&(h="onReverseComplete",e=this._reversed),0>a?(this._active=!1,0===this._duration&&this._rawPrevTime>=0&&(c=!0)):this._initted||(c=!0),this._rawPrevTime=a,a=-1e-6):this._totalTime=this._time=this._rawPrevTime=a,this._time!==j||c){if(this._initted||(this._initted=!0),0===j&&this.vars.onStart&&0!==this._time&&(b||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||f)),this._time>j)for(d=this._first;d&&(g=d._next,!this._paused||m);)(d._active||d._startTime<=this._time&&!d._paused&&!d._gc)&&(d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,!1):d.render((a-d._startTime)*d._timeScale,b,!1)),d=g;else for(d=this._last;d&&(g=d._prev,!this._paused||m);)(d._active||j>=d._startTime&&!d._paused&&!d._gc)&&(d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,!1):d.render((a-d._startTime)*d._timeScale,b,!1)),d=g;this._onUpdate&&(b||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||f)),h&&(this._gc||(k===this._startTime||l!=this._timeScale)&&(0===this._time||i>=this.totalDuration())&&(e&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),b||this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||f)))}},h._hasPausedChild=function(){for(var a=this._first;a;){if(a._paused||a instanceof d&&a._hasPausedChild())return!0;a=a._next}return!1},h.getChildren=function(a,b,d,e){e=e||-9999999999;for(var f=[],g=this._first,h=0;g;)e>g._startTime||(g instanceof c?b!==!1&&(f[h++]=g):(d!==!1&&(f[h++]=g),a!==!1&&(f=f.concat(g.getChildren(!0,b,d)),h=f.length))),g=g._next;return f},h.getTweensOf=function(a,b){for(var d=c.getTweensOf(a),e=d.length,f=[],g=0;--e>-1;)(d[e].timeline===this||b&&this._contains(d[e]))&&(f[g++]=d[e]);return f},h._contains=function(a){for(var b=a.timeline;b;){if(b===this)return!0;b=b.timeline}return!1},h.shiftChildren=function(a,b,c){c=c||0;for(var d=this._first;d;)d._startTime>=c&&(d._startTime+=a),d=d._next;if(b)for(var e in this._labels)this._labels[e]>=c&&(this._labels[e]+=a);return this._uncache(!0)},h._kill=function(a,b){if(null==a&&null==b)return this._enabled(!1,!1);for(var c=null==b?this.getChildren(!0,!0,!1):this.getTweensOf(b),d=c.length,e=!1;--d>-1;)c[d]._kill(a,b)&&(e=!0);return e},h.clear=function(a){var b=this.getChildren(!1,!0,!0),c=b.length;for(this._time=this._totalTime=0;--c>-1;)b[c]._enabled(!1,!1);return a!==!1&&(this._labels={}),this._uncache(!0)},h.invalidate=function(){for(var a=this._first;a;)a.invalidate(),a=a._next;return this},h._enabled=function(a,c){if(a===this._gc)for(var d=this._first;d;)d._enabled(a,!0),d=d._next;return b.prototype._enabled.call(this,a,c)},h.progress=function(a){return arguments.length?this.totalTime(this.duration()*a,!1):this._time/this.duration()},h.duration=function(a){return arguments.length?(0!==this.duration()&&0!==a&&this.timeScale(this._duration/a),this):(this._dirty&&this.totalDuration(),this._duration)},h.totalDuration=function(a){if(!arguments.length){if(this._dirty){for(var b,c,d=0,e=this._first,f=-999999999999;e;)b=e._next,f>e._startTime&&this._sortChildren?this.add(e,e._startTime-e._delay):f=e._startTime,0>e._startTime&&(d-=e._startTime,this.shiftChildren(-e._startTime,!1,-9999999999)),c=e._startTime+(e._dirty?e.totalDuration():e._totalDuration)/e._timeScale,c>d&&(d=c),e=b;this._duration=this._totalDuration=d,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==a&&this.timeScale(this._totalDuration/a),this},h.usesFrames=function(){for(var b=this._timeline;b._timeline;)b=b._timeline;return b===a._rootFramesTimeline},h.rawTime=function(){return this._paused||0!==this._totalTime&&this._totalTime!==this._totalDuration?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},d},!0)}),window._gsDefine&&_gsQueue.pop()(),function(a){"use strict";var b,c,d,e,f=a.GreenSockGlobals||a,g=function(a){var b,c=a.split("."),d=f;for(b=0;c.length>b;b++)d[c[b]]=d=d[c[b]]||{};return d},h=g("com.greensock"),i={},j=function(b,c,d,e){this.sc=i[b]?i[b].sc:[],i[b]=this,this.gsClass=null,this.func=d;var h=[];this.check=function(k){for(var l,m,n,o,p=c.length,q=p;--p>-1;)(l=i[c[p]]||new j(c[p],[])).gsClass?(h[p]=l.gsClass,q--):k&&l.sc.push(this);if(0===q&&d)for(m=("com.greensock."+b).split("."),n=m.pop(),o=g(m.join("."))[n]=this.gsClass=d.apply(d,h),e&&(f[n]=o,"function"==typeof define&&define.amd?define((a.GreenSockAMDPath?a.GreenSockAMDPath+"/":"")+b.split(".").join("/"),[],function(){return o}):"undefined"!=typeof module&&module.exports&&(module.exports=o)),p=0;this.sc.length>p;p++)this.sc[p].check()},this.check(!0)},k=a._gsDefine=function(a,b,c,d){return new j(a,b,c,d)},l=h._class=function(a,b,c){return b=b||function(){},k(a,[],function(){return b},c),b},m=[0,0,1,1],n=[],o=l("easing.Ease",function(a,b,c,d){this._func=a,this._type=c||0,this._power=d||0,this._params=b?m.concat(b):m},!0),p=o.map={},q=o.register=function(a,b,c,d){for(var e,f,g,i,j=b.split(","),k=j.length,m=(c||"easeIn,easeOut,easeInOut").split(",");--k>-1;)for(f=j[k],e=d?l("easing."+f,null,!0):h.easing[f]||{},g=m.length;--g>-1;)i=m[g],p[f+"."+i]=p[i+f]=e[i]=a.getRatio?a:a[i]||new a};for(d=o.prototype,d._calcEnd=!1,d.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var b=this._type,c=this._power,d=1===b?1-a:2===b?a:.5>a?2*a:2*(1-a);return 1===c?d*=d:2===c?d*=d*d:3===c?d*=d*d*d:4===c&&(d*=d*d*d*d),1===b?1-d:2===b?d:.5>a?d/2:1-d/2},b=["Linear","Quad","Cubic","Quart","Quint,Strong"],c=b.length;--c>-1;)d=b[c]+",Power"+c,q(new o(null,null,1,c),d,"easeOut",!0),q(new o(null,null,2,c),d,"easeIn"+(0===c?",easeNone":"")),q(new o(null,null,3,c),d,"easeInOut");p.linear=h.easing.Linear.easeIn,p.swing=h.easing.Quad.easeInOut;var r=l("events.EventDispatcher",function(a){this._listeners={},this._eventTarget=a||this});d=r.prototype,d.addEventListener=function(a,b,c,d,e){e=e||0;var f,g,h=this._listeners[a],i=0;for(null==h&&(this._listeners[a]=h=[]),g=h.length;--g>-1;)f=h[g],f.c===b?h.splice(g,1):0===i&&e>f.pr&&(i=g+1);h.splice(i,0,{c:b,s:c,up:d,pr:e})},d.removeEventListener=function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].c===b)return void d.splice(c,1)},d.dispatchEvent=function(a){var b=this._listeners[a];if(b)for(var c,d=b.length,e=this._eventTarget;--d>-1;)c=b[d],c.up?c.c.call(c.s||e,{type:a,target:e}):c.c.call(c.s||e)};var s=a.requestAnimationFrame,t=a.cancelAnimationFrame,u=Date.now||function(){return(new Date).getTime()};for(b=["ms","moz","webkit","o"],c=b.length;--c>-1&&!s;)s=a[b[c]+"RequestAnimationFrame"],t=a[b[c]+"CancelAnimationFrame"]||a[b[c]+"CancelRequestAnimationFrame"];l("Ticker",function(b,c){var d,e,f,g,h,i=this,j=u(),k=c!==!1&&s,l=function(){null!=f&&(k&&t?t(f):a.clearTimeout(f),f=null)},m=function(a){i.time=(u()-j)/1e3,(!d||i.time>=h||a===!0)&&(i.frame++,h=i.time>h?i.time+g-(i.time-h):i.time+g-.001,i.time+.001>h&&(h=i.time+.001),i.dispatchEvent("tick")),a!==!0&&(f=e(m))};r.call(i),this.time=this.frame=0,this.tick=function(){m(!0)},this.fps=function(a){return arguments.length?(d=a,g=1/(d||60),h=this.time+g,e=0===d?function(){}:k&&s?s:function(a){return setTimeout(a,1e3*(h-i.time)+1>>0||1)},l(),void(f=e(m))):d},this.useRAF=function(a){return arguments.length?(l(),k=a,void i.fps(d)):k},i.fps(b),setTimeout(function(){k&&!f&&i.useRAF(!1)},1e3)}),d=h.Ticker.prototype=new h.events.EventDispatcher,d.constructor=h.Ticker;var v=l("core.Animation",function(a,b){if(this.vars=b||{},this._duration=this._totalDuration=a||0,this._delay=Number(this.vars.delay)||0,this._timeScale=1,this._active=this.vars.immediateRender===!0,this.data=this.vars.data,this._reversed=this.vars.reversed===!0,I){e||(w.tick(),e=!0);var c=this.vars.useFrames?H:I;c.add(this,c._time),this.vars.paused&&this.paused(!0)}}),w=v.ticker=new h.Ticker;d=v.prototype,d._dirty=d._gc=d._initted=d._paused=!1,d._totalTime=d._time=0,d._rawPrevTime=-1,d._next=d._last=d._onUpdate=d._timeline=d.timeline=null,d._paused=!1,d.play=function(a,b){return arguments.length&&this.seek(a,b),this.reversed(!1),this.paused(!1)},d.pause=function(a,b){return arguments.length&&this.seek(a,b),this.paused(!0)},d.resume=function(a,b){return arguments.length&&this.seek(a,b),this.paused(!1)},d.seek=function(a,b){return this.totalTime(Number(a),b!==!1)},d.restart=function(a,b){return this.reversed(!1),this.paused(!1),this.totalTime(a?-this._delay:0,b!==!1)},d.reverse=function(a,b){return arguments.length&&this.seek(a||this.totalDuration(),b),this.reversed(!0),this.paused(!1)},d.render=function(){},d.invalidate=function(){return this},d._enabled=function(a,b){return this._gc=!a,this._active=a&&!this._paused&&this._totalTime>0&&this._totalTime<this._totalDuration,b!==!0&&(a&&null==this.timeline?this._timeline.add(this,this._startTime-this._delay):a||null==this.timeline||this._timeline._remove(this,!0)),!1},d._kill=function(){return this._enabled(!1,!1)},d.kill=function(a,b){return this._kill(a,b),this},d._uncache=function(a){for(var b=a?this:this.timeline;b;)b._dirty=!0,b=b.timeline;return this},d.eventCallback=function(a,b,c,d){if(null==a)return null;if("on"===a.substr(0,2)){if(1===arguments.length)return this.vars[a];if(null==b)delete this.vars[a];else if(this.vars[a]=b,this.vars[a+"Params"]=c,this.vars[a+"Scope"]=d,c)for(var e=c.length;--e>-1;)"{self}"===c[e]&&(c=this.vars[a+"Params"]=c.concat(),c[e]=this);"onUpdate"===a&&(this._onUpdate=b)
}return this},d.delay=function(a){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay),this._delay=a,this):this._delay},d.duration=function(a){return arguments.length?(this._duration=this._totalDuration=a,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0),this):(this._dirty=!1,this._duration)},d.totalDuration=function(a){return this._dirty=!1,arguments.length?this.duration(a):this._totalDuration},d.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),a>this._duration&&(a=this._duration),this.totalTime(a,b)):this._time},d.totalTime=function(a,b){if(!arguments.length)return this._totalTime;if(this._timeline){if(0>a&&(a+=this.totalDuration()),this._timeline.smoothChildTiming&&(this._dirty&&this.totalDuration(),a>this._totalDuration&&(a=this._totalDuration),this._startTime=(this._paused?this._pauseTime:this._timeline._time)-(this._reversed?this._totalDuration-a:a)/this._timeScale,this._timeline._dirty||this._uncache(!1),!this._timeline._active))for(var c=this._timeline;c._timeline;)c.totalTime(c._totalTime,!0),c=c._timeline;this._gc&&this._enabled(!0,!1),this._totalTime!==a&&this.render(a,b,!1)}return this},d.startTime=function(a){return arguments.length?(a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,a-this._delay)),this):this._startTime},d.timeScale=function(a){if(!arguments.length)return this._timeScale;if(a=a||1e-6,this._timeline&&this._timeline.smoothChildTiming){var b=this._pauseTime||0===this._pauseTime?this._pauseTime:this._timeline._totalTime;this._startTime=b-(b-this._startTime)*this._timeScale/a}return this._timeScale=a,this._uncache(!1)},d.reversed=function(a){return arguments.length?(a!=this._reversed&&(this._reversed=a,this.totalTime(this._totalTime,!0)),this):this._reversed},d.paused=function(a){return arguments.length?(a!=this._paused&&this._timeline&&(!a&&this._timeline.smoothChildTiming&&(this._startTime+=this._timeline.rawTime()-this._pauseTime,this._uncache(!1)),this._pauseTime=a?this._timeline.rawTime():null,this._paused=a,this._active=!this._paused&&this._totalTime>0&&this._totalTime<this._totalDuration),this._gc&&(a||this._enabled(!0,!1)),this):this._paused};var x=l("core.SimpleTimeline",function(a){v.call(this,0,a),this.autoRemoveChildren=this.smoothChildTiming=!0});d=x.prototype=new v,d.constructor=x,d.kill()._gc=!1,d._first=d._last=null,d._sortChildren=!1,d.add=function(a,b){var c,d;if(a._startTime=Number(b||0)+a._delay,a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale),a.timeline&&a.timeline._remove(a,!0),a.timeline=a._timeline=this,a._gc&&a._enabled(!0,!0),c=this._last,this._sortChildren)for(d=a._startTime;c&&c._startTime>d;)c=c._prev;return c?(a._next=c._next,c._next=a):(a._next=this._first,this._first=a),a._next?a._next._prev=a:this._last=a,a._prev=c,this._timeline&&this._uncache(!0),this},d.insert=d.add,d._remove=function(a,b){return a.timeline===this&&(b||a._enabled(!1,!0),a.timeline=null,a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),this._timeline&&this._uncache(!0)),this},d.render=function(a,b){var c,d=this._first;for(this._totalTime=this._time=this._rawPrevTime=a;d;)c=d._next,(d._active||a>=d._startTime&&!d._paused)&&(d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,!1):d.render((a-d._startTime)*d._timeScale,b,!1)),d=c},d.rawTime=function(){return this._totalTime};var y=l("TweenLite",function(a,b,c){if(v.call(this,b,c),null==a)throw"Cannot tween an undefined reference.";this.target=a="string"!=typeof a?a:y.selector(a)||a,this._overwrite=null==this.vars.overwrite?G[y.defaultOverwrite]:"number"==typeof this.vars.overwrite?this.vars.overwrite>>0:G[this.vars.overwrite];var d,e,f=a.jquery||"function"==typeof a.each&&a[0]&&a[0].nodeType&&a[0].style;if((f||a instanceof Array)&&"number"!=typeof a[0])for(this._targets=f&&!a.slice?A(a):a.slice(0),this._propLookup=[],this._siblings=[],d=0;this._targets.length>d;d++)e=this._targets[d],e?"string"!=typeof e?"function"==typeof e.each&&e[0]&&e[0].nodeType&&e[0].style?(this._targets.splice(d--,1),this._targets=this._targets.concat(A(e))):(this._siblings[d]=J(e,this,!1),1===this._overwrite&&this._siblings[d].length>1&&K(e,this,null,1,this._siblings[d])):(e=this._targets[d--]=y.selector(e),"string"==typeof e&&this._targets.splice(d+1,1)):this._targets.splice(d--,1);else this._propLookup={},this._siblings=J(a,this,!1),1===this._overwrite&&this._siblings.length>1&&K(a,this,null,1,this._siblings);(this.vars.immediateRender||0===b&&0===this._delay&&this.vars.immediateRender!==!1)&&this.render(-this._delay,!1,!0)},!0),z=function(a){return"function"==typeof a.each&&a[0]&&a[0].nodeType&&a[0].style},A=function(a){var b=[];return a.each(function(){b.push(this)}),b},B=function(a){var b,c={};for(b in a)!F[b]&&(!C[b]||C[b]&&C[b]._autoCSS)&&(c[b]=a[b],delete a[b]);a.css=c};d=y.prototype=new v,d.constructor=y,d.kill()._gc=!1,d.ratio=0,d._firstPT=d._targets=d._overwrittenProps=null,d._notifyPluginsOfEnabled=!1,y.version="1.8.1",y.defaultEase=d._ease=new o(null,null,1,1),y.defaultOverwrite="auto",y.ticker=w,y.selector=a.$||a.jQuery||function(b){return a.$?(y.selector=a.$,a.$(b)):a.document?a.document.getElementById("#"===b.charAt(0)?b.substr(1):b):b};var C=y._plugins={},D=y._tweenLookup={},E=0,F={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,orientToBezier:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1},G={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},H=v._rootFramesTimeline=new x,I=v._rootTimeline=new x;I._startTime=w.time,H._startTime=w.frame,I._active=H._active=!0,v._updateRoot=function(){if(I.render((w.time-I._startTime)*I._timeScale,!1,!1),H.render((w.frame-H._startTime)*H._timeScale,!1,!1),!(w.frame%120)){var a,b,c;for(c in D){for(b=D[c].tweens,a=b.length;--a>-1;)b[a]._gc&&b.splice(a,1);0===b.length&&delete D[c]}}},w.addEventListener("tick",v._updateRoot);var J=function(a,b,c){var d,e,f=a._gsTweenID;if(D[f||(a._gsTweenID=f="t"+E++)]||(D[f]={target:a,tweens:[]}),b&&(d=D[f].tweens,d[e=d.length]=b,c))for(;--e>-1;)d[e]===b&&d.splice(e,1);return D[f].tweens},K=function(a,b,c,d,e){var f,g,h,i;if(1===d||d>=4){for(i=e.length,f=0;i>f;f++)if((h=e[f])!==b)h._gc||h._enabled(!1,!1)&&(g=!0);else if(5===d)break;return g}var j,k=b._startTime+1e-10,l=[],m=0,n=0===b._duration;for(f=e.length;--f>-1;)(h=e[f])===b||h._gc||h._paused||(h._timeline!==b._timeline?(j=j||L(b,0,n),0===L(h,j,n)&&(l[m++]=h)):k>=h._startTime&&h._startTime+h.totalDuration()/h._timeScale+1e-10>k&&((n||!h._initted)&&2e-10>=k-h._startTime||(l[m++]=h)));for(f=m;--f>-1;)h=l[f],2===d&&h._kill(c,a)&&(g=!0),(2!==d||!h._firstPT&&h._initted)&&h._enabled(!1,!1)&&(g=!0);return g},L=function(a,b,c){for(var d=a._timeline,e=d._timeScale,f=a._startTime;d._timeline;){if(f+=d._startTime,e*=d._timeScale,d._paused)return-100;d=d._timeline}return f/=e,f>b?f-b:c&&f===b||!a._initted&&2e-10>f-b?1e-10:(f+=a.totalDuration()/a._timeScale/e)>b?0:f-b-1e-10};d._init=function(){var a,b,c,d=this.vars,e=d.ease;if(d.startAt&&(d.startAt.overwrite=0,d.startAt.immediateRender=!0,y.to(this.target,0,d.startAt)),this._ease=e?e instanceof o?d.easeParams instanceof Array?e.config.apply(e,d.easeParams):e:"function"==typeof e?new o(e,d.easeParams):p[e]||y.defaultEase:y.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(a=this._targets.length;--a>-1;)this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],this._overwrittenProps?this._overwrittenProps[a]:null)&&(b=!0);else b=this._initProps(this.target,this._propLookup,this._siblings,this._overwrittenProps);if(b&&y._onPluginEvent("_onInitAllProps",this),this._overwrittenProps&&null==this._firstPT&&"function"!=typeof this.target&&this._enabled(!1,!1),d.runBackwards)for(c=this._firstPT;c;)c.s+=c.c,c.c=-c.c,c=c._next;this._onUpdate=d.onUpdate,this._initted=!0},d._initProps=function(a,b,c,d){var e,f,g,h,i,j,k;if(null==a)return!1;this.vars.css||a.style&&a.nodeType&&C.css&&this.vars.autoCSS!==!1&&B(this.vars);for(e in this.vars){if(F[e]){if(("onStartParams"===e||"onUpdateParams"===e||"onCompleteParams"===e||"onReverseCompleteParams"===e||"onRepeatParams"===e)&&(i=this.vars[e]))for(f=i.length;--f>-1;)"{self}"===i[f]&&(i=this.vars[e]=i.concat(),i[f]=this)}else if(C[e]&&(h=new C[e])._onInitTween(a,this.vars[e],this)){for(this._firstPT=j={_next:this._firstPT,t:h,p:"setRatio",s:0,c:1,f:!0,n:e,pg:!0,pr:h._priority},f=h._overwriteProps.length;--f>-1;)b[h._overwriteProps[f]]=this._firstPT;(h._priority||h._onInitAllProps)&&(g=!0),(h._onDisable||h._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=b[e]=j={_next:this._firstPT,t:a,p:e,f:"function"==typeof a[e],n:e,pg:!1,pr:0},j.s=j.f?a[e.indexOf("set")||"function"!=typeof a["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(a[e]),k=this.vars[e],j.c="string"==typeof k&&"="===k.charAt(1)?parseInt(k.charAt(0)+"1",10)*Number(k.substr(2)):Number(k)-j.s||0;j&&j._next&&(j._next._prev=j)}return d&&this._kill(d,a)?this._initProps(a,b,c,d):this._overwrite>1&&this._firstPT&&c.length>1&&K(a,this,b,this._overwrite,c)?(this._kill(b,a),this._initProps(a,b,c,d)):g},d.render=function(a,b,c){var d,e,f,g=this._time;if(a>=this._duration)this._totalTime=this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(d=!0,e="onComplete"),0===this._duration&&((0===a||0>this._rawPrevTime)&&this._rawPrevTime!==a&&(c=!0),this._rawPrevTime=a);else if(0>=a)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==g||0===this._duration&&this._rawPrevTime>0)&&(e="onReverseComplete",d=this._reversed),0>a?(this._active=!1,0===this._duration&&(this._rawPrevTime>=0&&(c=!0),this._rawPrevTime=a)):this._initted||(c=!0);else if(this._totalTime=this._time=a,this._easeType){var h=a/this._duration,i=this._easeType,j=this._easePower;(1===i||3===i&&h>=.5)&&(h=1-h),3===i&&(h*=2),1===j?h*=h:2===j?h*=h*h:3===j?h*=h*h*h:4===j&&(h*=h*h*h*h),this.ratio=1===i?1-h:2===i?h:.5>a/this._duration?h/2:1-h/2}else this.ratio=this._ease.getRatio(a/this._duration);if(this._time!==g||c){for(this._initted||(this._init(),!d&&this._time&&(this.ratio=this._ease.getRatio(this._time/this._duration))),this._active||this._paused||(this._active=!0),0===g&&this.vars.onStart&&(0!==this._time||0===this._duration)&&(b||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||n)),f=this._firstPT;f;)f.f?f.t[f.p](f.c*this.ratio+f.s):f.t[f.p]=f.c*this.ratio+f.s,f=f._next;this._onUpdate&&(b||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||n)),e&&(this._gc||(d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),b||this.vars[e]&&this.vars[e].apply(this.vars[e+"Scope"]||this,this.vars[e+"Params"]||n)))}},d._kill=function(a,b){if("all"===a&&(a=null),null==a&&(null==b||b===this.target))return this._enabled(!1,!1);b="string"!=typeof b?b||this._targets||this.target:y.selector(b)||b;var c,d,e,f,g,h,i,j;if((b instanceof Array||z(b))&&"number"!=typeof b[0])for(c=b.length;--c>-1;)this._kill(a,b[c])&&(h=!0);else{if(this._targets){for(c=this._targets.length;--c>-1;)if(b===this._targets[c]){g=this._propLookup[c]||{},this._overwrittenProps=this._overwrittenProps||[],d=this._overwrittenProps[c]=a?this._overwrittenProps[c]||{}:"all";break}}else{if(b!==this.target)return!1;g=this._propLookup,d=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}if(g){i=a||g,j=a!==d&&"all"!==d&&a!==g&&(null==a||a._tempKill!==!0);for(e in i)(f=g[e])&&(f.pg&&f.t._kill(i)&&(h=!0),f.pg&&0!==f.t._overwriteProps.length||(f._prev?f._prev._next=f._next:f===this._firstPT&&(this._firstPT=f._next),f._next&&(f._next._prev=f._prev),f._next=f._prev=null),delete g[e]),j&&(d[e]=1)}}return h},d.invalidate=function(){return this._notifyPluginsOfEnabled&&y._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},d._enabled=function(a,b){if(a&&this._gc)if(this._targets)for(var c=this._targets.length;--c>-1;)this._siblings[c]=J(this._targets[c],this,!0);else this._siblings=J(this.target,this,!0);return v.prototype._enabled.call(this,a,b),this._notifyPluginsOfEnabled&&this._firstPT?y._onPluginEvent(a?"_onEnable":"_onDisable",this):!1},y.to=function(a,b,c){return new y(a,b,c)},y.from=function(a,b,c){return c.runBackwards=!0,c.immediateRender!==!1&&(c.immediateRender=!0),new y(a,b,c)},y.fromTo=function(a,b,c,d){return d.startAt=c,c.immediateRender&&(d.immediateRender=!0),new y(a,b,d)},y.delayedCall=function(a,b,c,d,e){return new y(b,0,{delay:a,onComplete:b,onCompleteParams:c,onCompleteScope:d,onReverseComplete:b,onReverseCompleteParams:c,onReverseCompleteScope:d,immediateRender:!1,useFrames:e,overwrite:0})},y.set=function(a,b){return new y(a,0,b)},y.killTweensOf=y.killDelayedCallsTo=function(a,b){for(var c=y.getTweensOf(a),d=c.length;--d>-1;)c[d]._kill(b,a)},y.getTweensOf=function(a){if(null!=a){a="string"!=typeof a?a:y.selector(a)||a;var b,c,d,e;if((a instanceof Array||z(a))&&"number"!=typeof a[0]){for(b=a.length,c=[];--b>-1;)c=c.concat(y.getTweensOf(a[b]));for(b=c.length;--b>-1;)for(e=c[b],d=b;--d>-1;)e===c[d]&&c.splice(b,1)}else for(c=J(a).concat(),b=c.length;--b>-1;)c[b]._gc&&c.splice(b,1);return c}};var M=l("plugins.TweenPlugin",function(a,b){this._overwriteProps=(a||"").split(","),this._propName=this._overwriteProps[0],this._priority=b||0},!0);if(d=M.prototype,M.version=12,M.API=2,d._firstPT=null,d._addTween=function(a,b,c,d,e,f){var g,h;null!=d&&(g="number"==typeof d||"="!==d.charAt(1)?Number(d)-c:parseInt(d.charAt(0)+"1",10)*Number(d.substr(2)))&&(this._firstPT=h={_next:this._firstPT,t:a,p:b,s:c,c:g,f:"function"==typeof a[b],n:e||b,r:f},h._next&&(h._next._prev=h))},d.setRatio=function(a){for(var b,c=this._firstPT;c;)b=c.c*a+c.s,c.r&&(b=b+(b>0?.5:-.5)>>0),c.f?c.t[c.p](b):c.t[c.p]=b,c=c._next},d._kill=function(a){if(null!=a[this._propName])this._overwriteProps=[];else for(var b=this._overwriteProps.length;--b>-1;)null!=a[this._overwriteProps[b]]&&this._overwriteProps.splice(b,1);for(var c=this._firstPT;c;)null!=a[c.n]&&(c._next&&(c._next._prev=c._prev),c._prev?(c._prev._next=c._next,c._prev=null):this._firstPT===c&&(this._firstPT=c._next)),c=c._next;return!1},d._roundProps=function(a,b){for(var c=this._firstPT;c;)(a[this._propName]||null!=c.n&&a[c.n.split(this._propName+"_").join("")])&&(c.r=b),c=c._next},y._onPluginEvent=function(a,b){var c,d=b._firstPT;if("_onInitAllProps"===a){for(var e,f,g,h;d;){for(h=d._next,e=f;e&&e.pr>d.pr;)e=e._next;(d._prev=e?e._prev:g)?d._prev._next=d:f=d,(d._next=e)?e._prev=d:g=d,d=h}d=b._firstPT=f}for(;d;)d.pg&&"function"==typeof d.t[a]&&d.t[a]()&&(c=!0),d=d._next;return c},M.activate=function(a){for(var b=a.length;--b>-1;)a[b].API===M.API&&(y._plugins[(new a[b])._propName]=a[b]);return!0},b=a._gsQueue){for(c=0;b.length>c;c++)b[c]();for(d in i)i[d].func||a.console.log("GSAP encountered missing dependency: com.greensock."+d)}e=!1}(window),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";_gsDefine("easing.Back",["easing.Ease"],function(a){var b,c,d=window.GreenSockGlobals||window,e=d.com.greensock,f=2*Math.PI,g=Math.PI/2,h=e._class,i=function(b,c){var d=h("easing."+b,function(){},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,d},j=a.register||function(){},k=function(a,b,c,d){var e=h("easing."+a,{easeOut:new b,easeIn:new c,easeInOut:new d},!0);return j(e,a),e},l=function(b,c){var d=h("easing."+b,function(a){this._p1=a||0===a?a:1.70158,this._p2=1.525*this._p1},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,e.config=function(a){return new d(a)},d},m=k("Back",l("BackOut",function(a){return(a-=1)*a*((this._p1+1)*a+this._p1)+1}),l("BackIn",function(a){return a*a*((this._p1+1)*a-this._p1)}),l("BackInOut",function(a){return 1>(a*=2)?.5*a*a*((this._p2+1)*a-this._p2):.5*((a-=2)*a*((this._p2+1)*a+this._p2)+2)})),n=h("easing.SlowMo",function(a,b,c){b=b||0===b?b:.7,null==a?a=.7:a>1&&(a=1),this._p=1!==a?b:0,this._p1=(1-a)/2,this._p2=a,this._p3=this._p1+this._p2,this._calcEnd=c===!0},!0),o=n.prototype=new a;return o.constructor=n,o.getRatio=function(a){var b=a+(.5-a)*this._p;return this._p1>a?this._calcEnd?1-(a=1-a/this._p1)*a:b-(a=1-a/this._p1)*a*a*a*b:a>this._p3?this._calcEnd?1-(a=(a-this._p3)/this._p1)*a:b+(a-b)*(a=(a-this._p3)/this._p1)*a*a*a:this._calcEnd?1:b},n.ease=new n(.7,.7),o.config=n.config=function(a,b,c){return new n(a,b,c)},b=h("easing.SteppedEase",function(a){a=a||1,this._p1=1/a,this._p2=a+1},!0),o=b.prototype=new a,o.constructor=b,o.getRatio=function(a){return 0>a?a=0:a>=1&&(a=.999999999),(this._p2*a>>0)*this._p1},o.config=b.config=function(a){return new b(a)},k("Bounce",i("BounceOut",function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),i("BounceIn",function(a){return 1/2.75>(a=1-a)?1-7.5625*a*a:2/2.75>a?1-(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?1-(7.5625*(a-=2.25/2.75)*a+.9375):1-(7.5625*(a-=2.625/2.75)*a+.984375)}),i("BounceInOut",function(a){var b=.5>a;return a=b?1-2*a:2*a-1,a=1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375,b?.5*(1-a):.5*a+.5})),k("Circ",i("CircOut",function(a){return Math.sqrt(1-(a-=1)*a)}),i("CircIn",function(a){return-(Math.sqrt(1-a*a)-1)}),i("CircInOut",function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)})),c=function(b,c,d){var e=h("easing."+b,function(a,b){this._p1=a||1,this._p2=b||d,this._p3=this._p2/f*(Math.asin(1/this._p1)||0)},!0),g=e.prototype=new a;return g.constructor=e,g.getRatio=c,g.config=function(a,b){return new e(a,b)},e},k("Elastic",c("ElasticOut",function(a){return this._p1*Math.pow(2,-10*a)*Math.sin((a-this._p3)*f/this._p2)+1},.3),c("ElasticIn",function(a){return-(this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*f/this._p2))},.3),c("ElasticInOut",function(a){return 1>(a*=2)?-.5*this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*f/this._p2):.5*this._p1*Math.pow(2,-10*(a-=1))*Math.sin((a-this._p3)*f/this._p2)+1},.45)),k("Expo",i("ExpoOut",function(a){return 1-Math.pow(2,-10*a)}),i("ExpoIn",function(a){return Math.pow(2,10*(a-1))-.001}),i("ExpoInOut",function(a){return 1>(a*=2)?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*(a-1)))})),k("Sine",i("SineOut",function(a){return Math.sin(a*g)}),i("SineIn",function(a){return-Math.cos(a*g)+1}),i("SineInOut",function(a){return-.5*(Math.cos(Math.PI*a)-1)})),h("easing.EaseLookup",{find:function(b){return a.map[b]}},!0),j(d.SlowMo,"SlowMo","ease,"),j(b,"SteppedEase","ease,"),m},!0)}),window._gsDefine&&_gsQueue.pop()();var Stats=function(){var a=Date.now(),b=a,c=0,d=1/0,e=0,f=0,g=1/0,h=0,i=0,j=0,k=document.createElement("div");k.id="stats",k.addEventListener("mousedown",function(a){a.preventDefault(),s(++j%2)},!1),k.style.cssText="width:80px;opacity:0.9;cursor:pointer";var l=document.createElement("div");l.id="fps",l.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",k.appendChild(l);var m=document.createElement("div");m.id="fpsText",m.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="FPS",l.appendChild(m);var n=document.createElement("div");for(n.id="fpsGraph",n.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",l.appendChild(n);74>n.children.length;){var o=document.createElement("span");o.style.cssText="width:1px;height:30px;float:left;background-color:#113",n.appendChild(o)}var p=document.createElement("div");p.id="ms",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",k.appendChild(p);var q=document.createElement("div");q.id="msText",q.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",q.innerHTML="MS",p.appendChild(q);var r=document.createElement("div");for(r.id="msGraph",r.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",p.appendChild(r);74>r.children.length;)o=document.createElement("span"),o.style.cssText="width:1px;height:30px;float:left;background-color:#131",r.appendChild(o);var s=function(a){switch(j=a){case 0:l.style.display="block",p.style.display="none";break;case 1:l.style.display="none",p.style.display="block"}};return{REVISION:11,domElement:k,setMode:s,begin:function(){a=Date.now()},end:function(){var j=Date.now();c=j-a,d=Math.min(d,c),e=Math.max(e,c),q.textContent=c+" MS ("+d+"-"+e+")";var k=Math.min(30,30-30*(c/200));return r.appendChild(r.firstChild).style.height=k+"px",i++,j>b+1e3&&(f=Math.round(1e3*i/(j-b)),g=Math.min(g,f),h=Math.max(h,f),m.textContent=f+" FPS ("+g+"-"+h+")",k=Math.min(30,30-30*(f/100)),n.appendChild(n.firstChild).style.height=k+"px",b=j,i=0),j},update:function(){a=this.end()}}};(function(){function c(){return e.Matrix="undefined"!=typeof Float32Array?Float32Array:Array,e.Matrix}var d=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.Point=function(a,b){this.x=a||0,this.y=b||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.constructor=e.Point,e.Point.prototype.set=function(a,b){this.x=a||0,this.y=b||(0!==b?this.x:0)},e.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=this.x;if(a>=c&&a<=c+this.width){var d=this.y;if(b>=d&&b<=d+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.Polygon=function(a){if(a instanceof Array||(a=Array.prototype.slice.call(arguments)),"number"==typeof a[0]){for(var b=[],c=0,d=a.length;d>c;c+=2)b.push(new e.Point(a[c],a[c+1]));a=b}this.points=a},e.Polygon.prototype.clone=function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b].clone());return new e.Polygon(a)},e.Polygon.prototype.contains=function(a,b){for(var c=!1,d=0,e=this.points.length-1;d<this.points.length;e=d++){var f=this.points[d].x,g=this.points[d].y,h=this.points[e].x,i=this.points[e].y,j=g>b!=i>b&&(h-f)*(b-g)/(i-g)+f>a;j&&(c=!c)}return c},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(a,b){if(this.radius<=0)return!1;var c=this.x-a,d=this.y-b,e=this.radius*this.radius;return c*=c,d*=d,e>=c+d},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=(a-this.x)/this.width-.5,d=(b-this.y)/this.height-.5;return c*=c,d*=d,.25>c+d},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,c(),e.mat3={},e.mat3.create=function(){var a=new e.Matrix(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.mat3.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.mat4={},e.mat4.create=function(){var a=new e.Matrix(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.mat3.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=b[0],n=b[1],o=b[2],p=b[3],q=b[4],r=b[5],s=b[6],t=b[7],u=b[8];return c[0]=m*d+n*g+o*j,c[1]=m*e+n*h+o*k,c[2]=m*f+n*i+o*l,c[3]=p*d+q*g+r*j,c[4]=p*e+q*h+r*k,c[5]=p*f+q*i+r*l,c[6]=s*d+t*g+u*j,c[7]=s*e+t*h+u*k,c[8]=s*f+t*i+u*l,c},e.mat3.clone=function(a){var b=new e.Matrix(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.mat3.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[5];return a[1]=a[3],a[2]=a[6],a[3]=c,a[5]=a[7],a[6]=d,a[7]=e,a}return b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8],b},e.mat3.toMat4=function(a,b){return b||(b=e.mat4.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},e.mat4.create=function(){var a=new e.Matrix(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.mat4.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=d,a[9]=f,a[11]=a[14],a[12]=e,a[13]=g,a[14]=h,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},e.mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14],s=a[15],t=b[0],u=b[1],v=b[2],w=b[3];return c[0]=t*d+u*h+v*l+w*p,c[1]=t*e+u*i+v*m+w*q,c[2]=t*f+u*j+v*n+w*r,c[3]=t*g+u*k+v*o+w*s,t=b[4],u=b[5],v=b[6],w=b[7],c[4]=t*d+u*h+v*l+w*p,c[5]=t*e+u*i+v*m+w*q,c[6]=t*f+u*j+v*n+w*r,c[7]=t*g+u*k+v*o+w*s,t=b[8],u=b[9],v=b[10],w=b[11],c[8]=t*d+u*h+v*l+w*p,c[9]=t*e+u*i+v*m+w*q,c[10]=t*f+u*j+v*n+w*r,c[11]=t*g+u*k+v*o+w*s,t=b[12],u=b[13],v=b[14],w=b[15],c[12]=t*d+u*h+v*l+w*p,c[13]=t*e+u*i+v*m+w*q,c[14]=t*f+u*j+v*n+w*r,c[15]=t*g+u*k+v*o+w*s,c},e.identityMatrix=e.mat3.create(),e.DisplayObject=function(){this.last=this,this.first=this,this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=e.mat3.create(),this.localTransform=e.mat3.create(),this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=new e.Rectangle(0,0,1,1),this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(a){this.interactive=a},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(a){this._interactive=a,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.isMask=!1),this._mask=a,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(a){if(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].passes,e=0;e<d.length;e++)b.push(d[e]);this._filterBlock={target:this,filterPasses:b}}this._filters=a}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var a=this.localTransform,b=this.parent.worldTransform,c=this.worldTransform;a[0]=this._cr*this.scale.x,a[1]=-this._sr*this.scale.y,a[3]=this._sr*this.scale.x,a[4]=this._cr*this.scale.y;var d=this.pivot.x,e=this.pivot.y,f=a[0],g=a[1],h=this.position.x-a[0]*d-e*a[1],i=a[3],j=a[4],k=this.position.y-a[4]*e-d*a[3],l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5];a[2]=h,a[5]=k,c[0]=l*f+m*i,c[1]=l*g+m*j,c[2]=l*h+m*k+n,c[3]=o*f+p*i,c[4]=o*g+p*j,c[5]=o*h+p*k+q,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(){return e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=e.identityMatrix,this.updateTransform();var b=this.getBounds();return this.worldTransform=a,b},e.DisplayObject.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype._renderWebGL=function(a){a=a},e.DisplayObject.prototype._renderCanvas=function(a){a=a},e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,e.DisplayObjectContainer.prototype.addChild=function(a){a.parent&&a!==this&&a.parent.removeChild(a),a.parent=this,this.children.push(a),this.stage&&a.setStageReference(this.stage)},e.DisplayObjectContainer.prototype.addChildAt=function(a,b){if(!(b>=0&&b<=this.children.length))throw new Error(a+" The index "+b+" supplied is out of bounds "+this.children.length);a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),this.stage&&a.setStageReference(this.stage)},e.DisplayObjectContainer.prototype.swapChildren=function(a,b){if(a!==b){var c=this.children.indexOf(a),d=this.children.indexOf(b);if(0>c||0>d)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[c]=b,this.children[d]=a}},e.DisplayObjectContainer.prototype.getChildAt=function(a){if(a>=0&&a<this.children.length)return this.children[a];throw new Error("The supplied DisplayObjects must be a child of the caller "+this)},e.DisplayObjectContainer.prototype.removeChild=function(a){var b=this.children.indexOf(a);if(-1===b)throw new Error(a+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&a.removeStageReference(),a.parent=void 0,this.children.splice(b,1)},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){e.DisplayObject.prototype.updateTransform.call(this);for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform()}},e.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return e.EmptyRectangle;for(var a,b,c,d=1/0,f=1/0,g=-1/0,h=-1/0,i=0,j=this.children.length;j>i;i++){var k=this.children[i];k.visible&&(a=this.children[i].getBounds(),d=d<a.x?d:a.x,f=f<a.y?f:a.y,b=a.width+a.x,c=a.height+a.y,g=g>b?g:b,h=h>c?h:c)}var l=this._bounds;return l.x=d,l.y=f,l.width=g-d,l.height=h-f,l},e.DisplayObjectContainer.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d.setStageReference(a)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var a=0,b=this.children.length;b>a;a++){var c=this.children[a];c.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha){var b,c;if(this._mask||this._filters){for(this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(a),a.spriteBatch.start()
}else for(b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},e.DisplayObjectContainer.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){this._mask&&a.maskManager.pushMask(this._mask,a.context);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d._renderCanvas(a)}this._mask&&a.maskManager.popMask(a.context)}},e.blendModes={},e.blendModes.NORMAL=0,e.blendModes.ADD=1,e.blendModes.MULTIPLY=2,e.blendModes.SCREEN=3,e.Sprite=function(a){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=a,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,a.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width,this._width=a}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height,this._height=a}}),e.Sprite.prototype.setTexture=function(a){this.texture.baseTexture!==a.baseTexture?(this.textureChange=!0,this.texture=a):this.texture=a,this.cachedTint=16777215,this.updateFrame=!0},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},e.Sprite.prototype.getBounds=function(){var a=this.texture.frame.width,b=this.texture.frame.height,c=a*(1-this.anchor.x),d=a*-this.anchor.x,e=b*(1-this.anchor.y),f=b*-this.anchor.y,g=this.worldTransform,h=g[0],i=g[3],j=g[1],k=g[4],l=g[2],m=g[5],n=h*d+j*f+l,o=k*f+i*d+m,p=h*c+j*f+l,q=k*f+i*c+m,r=h*c+j*e+l,s=k*e+i*c+m,t=h*d+j*e+l,u=k*e+i*d+m,v=-1/0,w=-1/0,x=1/0,y=1/0;x=x>n?n:x,x=x>p?p:x,x=x>r?r:x,x=x>t?t:x,y=y>o?o:y,y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,v=n>v?n:v,v=p>v?p:v,v=r>v?r:v,v=t>v?t:v,w=o>w?o:w,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w;var z=this._bounds;return z.x=x,z.width=v-x,z.y=y,z.height=w-y,this._currentBounds=z,z},e.Sprite.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha){var b,c;if(this._mask||this._filters){var d=a.spriteBatch;for(this._mask&&(d.stop(),a.maskManager.pushMask(this.mask,a),d.start()),this._filters&&(d.flush(),a.filterManager.pushFilter(this._filterBlock)),d.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);d.stop(),this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(a),d.start()}else for(a.spriteBatch.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},e.Sprite.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){this._mask&&a.maskManager.pushMask(this._mask,a.context);var b=this.texture.frame,c=a.context,d=this.texture;if(b&&b.width&&b.height&&d.baseTexture.source){c.globalAlpha=this.worldAlpha;var f=this.worldTransform;if(c.setTransform(f[0],f[3],f[1],f[4],f[2],f[5]),this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,c.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]),16777215!==this.tint){if(this.cachedTint!==this.tint){if(!d.baseTexture.hasLoaded)return;this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)}c.drawImage(this.tintedTexture,0,0,b.width,b.height,this.anchor.x*-b.width,this.anchor.y*-b.height,b.width,b.height)}else if(d.trimmed){var g=d.trim;c.drawImage(this.texture.baseTexture.source,b.x,b.y,b.width,b.height,g.x-this.anchor.x*g.realWidth,g.y-this.anchor.y*g.realHeight,b.width,b.height)}else c.drawImage(this.texture.baseTexture.source,b.x,b.y,b.width,b.height,this.anchor.x*-b.width,this.anchor.y*-b.height,b.width,b.height)}for(var h=0,i=this.children.length;i>h;h++){var j=this.children[h];j._renderCanvas(a)}this._mask&&a.maskManager.popMask(a.context)}},e.Sprite.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache'+this);return new e.Sprite(b)},e.Sprite.fromImage=function(a){var b=e.Texture.fromImage(a);return new e.Sprite(b)},e.SpriteBatch=function(a){e.DisplayObjectContainer.call(this),this.textureThing=a,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(a){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(a),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(a){this.visible&&(this.ready||this.initWebGL(a.gl),a.spriteBatch.stop(),a.shaderManager.activateShader(a.shaderManager.fastShader),this.fastSpriteBatch.begin(this,a),this.fastSpriteBatch.render(this),a.shaderManager.activateShader(a.shaderManager.defaultShader),a.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(a){var b=a.context;b.globalAlpha=this.worldAlpha;var c=this.worldTransform;b.setTransform(c[0],c[3],c[1],c[4],c[2],c[5]),b.save();for(var d=0;d<this.children.length;d++){var f=this.children[d],g=f.texture,h=g.frame;f.rotation%(2*Math.PI)===0?b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*-h.width*f.scale.x+f.position.x+.5|0,f.anchor.y*-h.height*f.scale.y+f.position.y+.5|0,h.width*f.scale.x,h.height*f.scale.y):(e.DisplayObject.prototype.updateTransform.call(f),c=f.localTransform,b.setTransform(c[0],c[3],c[1],c[4],c[2],c[5]),b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*-h.width+.5|0,f.anchor.y*-h.height+.5|0,h.width,h.height))}b.restore()},e.MovieClip=function(a){e.Sprite.call(this,a[0]),this.textures=a,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(a){this.playing=!1,this.currentFrame=a;var b=this.currentFrame+.5|0;this.setTexture(this.textures[b%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(a){this.currentFrame=a,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var a=this.currentFrame+.5|0;this.loop||a<this.textures.length?this.setTexture(this.textures[a%this.textures.length]):a>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,e.Text.prototype.setStyle=function(a){a=a||{},a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.stroke=a.stroke||"black",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,this.style=a,this.dirty=!0},e.Text.prototype.setText=function(a){this.text=a.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.wordWrap(this.text));for(var b=a.split(/(?:\r\n|\r|\n)/),c=[],d=0,f=0;f<b.length;f++){var g=this.context.measureText(b[f]).width;c[f]=g,d=Math.max(d,g)}this.canvas.width=d+this.style.strokeThickness;var h=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;for(this.canvas.height=h*b.length,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",f=0;f<b.length;f++){var i=new e.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+f*h);"right"===this.style.align?i.x+=d-c[f]:"center"===this.style.align&&(i.x+=(d-c[f])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(b[f],i.x,i.y),this.style.fill&&this.context.fillText(b[f],i.x,i.y)}this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},e.Text.prototype._renderWebGL=function(a){this.requiresUpdate&&(this.requiresUpdate=!1,e.updateWebGLTexture(this.texture.baseTexture,a.gl)),e.Sprite.prototype._renderWebGL.call(this,a)},e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.Sprite.prototype.updateTransform.call(this)},e.Text.prototype.determineFontHeight=function(a){var b=e.Text.heightCache[a];if(!b){var c=document.getElementsByTagName("body")[0],d=document.createElement("div"),f=document.createTextNode("M");d.appendChild(f),d.setAttribute("style",a+";position:absolute;top:0;left:0"),c.appendChild(d),b=d.offsetHeight,e.Text.heightCache[a]=b,c.removeChild(d)}return b},e.Text.prototype.wordWrap=function(a){for(var b="",c=a.split("\n"),d=0;d<c.length;d++){for(var e=this.style.wordWrapWidth,f=c[d].split(" "),g=0;g<f.length;g++){var h=this.context.measureText(f[g]).width,i=h+this.context.measureText(" ").width;i>e?(g>0&&(b+="\n"),b+=f[g]+" ",e=this.style.wordWrapWidth-h):(e-=i,b+=f[g]+" ")}b+="\n"}return b},e.Text.prototype.destroy=function(a){a&&this.texture.destroy()},e.Text.heightCache={},e.BitmapText=function(a,b){e.DisplayObjectContainer.call(this),this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(a){this.text=a||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(a){a=a||{},a.align=a.align||"left",this.style=a;var b=a.font.split(" ");this.fontName=b[b.length-1],this.fontSize=b.length>=2?parseInt(b[b.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0},e.BitmapText.prototype.updateText=function(){for(var a=e.BitmapText.fonts[this.fontName],b=new e.Point,c=null,d=[],f=0,g=[],h=0,i=this.fontSize/a.size,j=0;j<this.text.length;j++){var k=this.text.charCodeAt(j);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(j)))g.push(b.x),f=Math.max(f,b.x),h++,b.x=0,b.y+=a.lineHeight,c=null;else{var l=a.chars[k];l&&(c&&l[c]&&(b.x+=l.kerning[c]),d.push({texture:l.texture,line:h,charCode:k,position:new e.Point(b.x+l.xOffset,b.y+l.yOffset)}),b.x+=l.xAdvance,c=k)}}g.push(b.x),f=Math.max(f,b.x);var m=[];for(j=0;h>=j;j++){var n=0;"right"===this.style.align?n=f-g[j]:"center"===this.style.align&&(n=(f-g[j])/2),m.push(n)}for(j=0;j<d.length;j++){var o=new e.Sprite(d[j].texture);o.position.x=(d[j].position.x+m[d[j].line])*i,o.position.y=d[j].position.y*i,o.scale.x=o.scale.y=i,this.addChild(o)}this.width=f*i,this.height=(b.y+a.lineHeight)*i},e.BitmapText.prototype.updateTransform=function(){if(this.dirty){for(;this.children.length>0;)this.removeChild(this.getChildAt(0));this.updateText(),this.dirty=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionManager=function(a){this.stage=a,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(a,b){for(var c=a.children,d=c.length,e=d-1;e>=0;e--){var f=c[e];f.interactive?(b.interactiveChildren=!0,this.interactiveItems.push(f),f.children.length>0&&this.collectInteractiveSprite(f,f)):(f.__iParent=null,f.children.length>0&&this.collectInteractiveSprite(f,b))}},e.InteractionManager.prototype.setTarget=function(a){this.target=a,null===this.interactionDOMElement&&this.setTargetDomElement(a.view),document.body.addEventListener("mouseup",this.onMouseUp,!0)},e.InteractionManager.prototype.setTargetDomElement=function(a){null!==this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0)),window.navigator.msPointerEnabled&&(a.style["-ms-content-zooming"]="none",a.style["-ms-touch-action"]="none"),this.interactionDOMElement=a,a.addEventListener("mousemove",this.onMouseMove,!0),a.addEventListener("mousedown",this.onMouseDown,!0),a.addEventListener("mouseout",this.onMouseOut,!0),a.addEventListener("touchstart",this.onTouchStart,!0),a.addEventListener("touchend",this.onTouchEnd,!0),a.addEventListener("touchmove",this.onTouchMove,!0)},e.InteractionManager.prototype.update=function(){if(this.target){var a=Date.now(),b=a-this.last;if(b=30*b/1e3,!(1>b)){this.last=a;var c=0;if(this.dirty){this.dirty=!1;var d=this.interactiveItems.length;for(c=0;d>c;c++)this.interactiveItems[c].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}var e=this.interactiveItems.length;for(this.interactionDOMElement.style.cursor="inherit",c=0;e>c;c++){var f=this.interactiveItems[c];(f.mouseover||f.mouseout||f.buttonMode)&&(f.__hit=this.hitTest(f,this.mouse),this.mouse.target=f,f.__hit?(f.buttonMode&&(this.interactionDOMElement.style.cursor=f.defaultCursor),f.__isOver||(f.mouseover&&f.mouseover(this.mouse),f.__isOver=!0)):f.__isOver&&(f.mouseout&&f.mouseout(this.mouse),f.__isOver=!1))}}}},e.InteractionManager.prototype.onMouseMove=function(a){this.mouse.originalEvent=a||window.event;var b=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(a.clientX-b.left)*(this.target.width/b.width),this.mouse.global.y=(a.clientY-b.top)*(this.target.height/b.height);for(var c=this.interactiveItems.length,d=0;c>d;d++){var e=this.interactiveItems[d];e.mousemove&&e.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(a){this.mouse.originalEvent=a||window.event;for(var b=this.interactiveItems.length,c=0;b>c;c++){var d=this.interactiveItems[c];if((d.mousedown||d.click)&&(d.__mouseIsDown=!0,d.__hit=this.hitTest(d,this.mouse),d.__hit&&(d.mousedown&&d.mousedown(this.mouse),d.__isDown=!0,!d.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseOut=function(){var a=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var b=0;a>b;b++){var c=this.interactiveItems[b];c.__isOver&&(this.mouse.target=c,c.mouseout&&c.mouseout(this.mouse),c.__isOver=!1)}},e.InteractionManager.prototype.onMouseUp=function(a){this.mouse.originalEvent=a||window.event;for(var b=this.interactiveItems.length,c=!1,d=0;b>d;d++){var e=this.interactiveItems[d];(e.mouseup||e.mouseupoutside||e.click)&&(e.__hit=this.hitTest(e,this.mouse),e.__hit&&!c?(e.mouseup&&e.mouseup(this.mouse),e.__isDown&&e.click&&e.click(this.mouse),e.interactiveChildren||(c=!0)):e.__isDown&&e.mouseupoutside&&e.mouseupoutside(this.mouse),e.__isDown=!1)}},e.InteractionManager.prototype.hitTest=function(a,b){var c=b.global;if(!a.worldVisible)return!1;var d=a instanceof e.Sprite,f=a.worldTransform,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=f[5],m=1/(g*k+h*-j),n=k*m*c.x+-h*m*c.y+(l*h-i*k)*m,o=g*m*c.y+-j*m*c.x+(-l*g+i*j)*m;if(b.target=a,a.hitArea&&a.hitArea.contains)return a.hitArea.contains(n,o)?(b.target=a,!0):!1;if(d){var p,q=a.texture.frame.width,r=a.texture.frame.height,s=-q*a.anchor.x;if(n>s&&s+q>n&&(p=-r*a.anchor.y,o>p&&p+r>o))return b.target=a,!0}for(var t=a.children.length,u=0;t>u;u++){var v=a.children[u],w=this.hitTest(v,b);if(w)return b.target=a,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(a){var b,c=this.interactionDOMElement.getBoundingClientRect(),d=a.changedTouches,e=0;for(e=0;e<d.length;e++){var f=d[e];b=this.touchs[f.identifier],b.originalEvent=a||window.event,b.global.x=(f.clientX-c.left)*(this.target.width/c.width),b.global.y=(f.clientY-c.top)*(this.target.height/c.height),navigator.isCocoonJS&&(b.global.x=f.clientX,b.global.y=f.clientY)}var g=this.interactiveItems.length;for(e=0;g>e;e++){var h=this.interactiveItems[e];h.touchmove&&h.touchmove(b)}},e.InteractionManager.prototype.onTouchStart=function(a){for(var b=this.interactionDOMElement.getBoundingClientRect(),c=a.changedTouches,d=0;d<c.length;d++){var f=c[d],g=this.pool.pop();g||(g=new e.InteractionData),g.originalEvent=a||window.event,this.touchs[f.identifier]=g,g.global.x=(f.clientX-b.left)*(this.target.width/b.width),g.global.y=(f.clientY-b.top)*(this.target.height/b.height),navigator.isCocoonJS&&(g.global.x=f.clientX,g.global.y=f.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i];if((j.touchstart||j.tap)&&(j.__hit=this.hitTest(j,g),j.__hit&&(j.touchstart&&j.touchstart(g),j.__isDown=!0,j.__touchData=g,!j.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(a){for(var b=this.interactionDOMElement.getBoundingClientRect(),c=a.changedTouches,d=0;d<c.length;d++){var e=c[d],f=this.touchs[e.identifier],g=!1;f.global.x=(e.clientX-b.left)*(this.target.width/b.width),f.global.y=(e.clientY-b.top)*(this.target.height/b.height),navigator.isCocoonJS&&(f.global.x=e.clientX,f.global.y=e.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i],k=j.__touchData;j.__hit=this.hitTest(j,f),k===f&&(f.originalEvent=a||window.event,(j.touchend||j.tap)&&(j.__hit&&!g?(j.touchend&&j.touchend(f),j.__isDown&&j.tap&&j.tap(f),j.interactiveChildren||(g=!0)):j.__isDown&&j.touchendoutside&&j.touchendoutside(f),j.__isDown=!1),j.__touchData=null)}this.pool.push(f),this.touchs[e.identifier]=null}},e.InteractionData=function(){this.global=new e.Point,this.local=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(a){var b=a.worldTransform,c=this.global,d=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5],k=1/(d*i+f*-h);return new e.Point(i*k*c.x+-f*k*c.y+(j*f-g*i)*k,d*k*c.y+-h*k*c.x+(-j*d+g*h)*k)},e.InteractionData.prototype.constructor=e.InteractionData,e.Stage=function(a){e.DisplayObjectContainer.call(this),this.worldTransform=e.mat3.create(),this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(a)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(a){this.interactionManager.setTargetDomElement(a)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(a){this.backgroundColor=a||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var b=this.backgroundColor.toString(16);b="000000".substr(0,6-b.length)+b,this.backgroundColorString="#"+b},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var f=0,h=["ms","moz","webkit","o"],i=0;i<h.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[h[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[h[i]+"CancelAnimationFrame"]||window[h[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-f)),d=window.setTimeout(function(){a(b+c)},c);return f=b+c,d}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.requestAnimFrame=window.requestAnimationFrame,e.hex2rgb=function(a){return[(a>>16&255)/255,(a>>8&255)/255,(255&a)/255]},e.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(b){function c(){var f=e.concat(a.call(arguments));d.apply(this instanceof c?this:b,f)}var d=this,e=a.call(arguments,1);if("function"!=typeof d)throw new TypeError;return c.prototype=function f(a){return a&&(f.prototype=a),this instanceof f?void 0:new f}(d.prototype),c}}()),e.AjaxRequest=function(){var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var b=0;b<a.length;b++)try{return new window.ActiveXObject(a[b])}catch(c){}},e.canUseNewCanvasBlendModes=function(){var a=document.createElement("canvas");a.width=1,a.height=1;var b=a.getContext("2d");return b.fillStyle="#000",b.fillRect(0,0,1,1),b.globalCompositeOperation="multiply",b.fillStyle="#fff",b.fillRect(0,0,1,1),0===b.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(a){if(a>0&&0===(a&a-1))return a;for(var b=1;a>b;)b<<=1;return b},e.EventTarget=function(){var a={};this.addEventListener=this.on=function(b,c){void 0===a[b]&&(a[b]=[]),-1===a[b].indexOf(c)&&a[b].push(c)},this.dispatchEvent=this.emit=function(b){if(a[b.type]&&a[b.type].length)for(var c=0,d=a[b.type].length;d>c;c++)a[b.type][c](b)},this.removeEventListener=this.off=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)},this.removeAllEventListeners=function(b){var c=a[b];c&&(c.length=0)}},e.autoDetectRenderer=function(a,b,c,d,f){a||(a=800),b||(b=600);var g=function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}();return g?new e.WebGLRenderer(a,b,c,d,f):new e.CanvasRenderer(a,b,c,d)},e.PolyK={},e.PolyK.Triangulate=function(a){var b=!0,c=a.length>>1;if(3>c)return[];for(var d=[],f=[],g=0;c>g;g++)f.push(g);g=0;for(var h=c;h>3;){var i=f[(g+0)%h],j=f[(g+1)%h],k=f[(g+2)%h],l=a[2*i],m=a[2*i+1],n=a[2*j],o=a[2*j+1],p=a[2*k],q=a[2*k+1],r=!1;if(e.PolyK._convex(l,m,n,o,p,q,b)){r=!0;for(var s=0;h>s;s++){var t=f[s];if(t!==i&&t!==j&&t!==k&&e.PolyK._PointInTriangle(a[2*t],a[2*t+1],l,m,n,o,p,q)){r=!1;break}}}if(r)d.push(i,j,k),f.splice((g+1)%h,1),h--,g=0;else if(g++>3*h){if(!b)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(d=[],f=[],g=0;c>g;g++)f.push(g);g=0,h=c,b=!1}}return d.push(f[0],f[1],f[2]),d},e.PolyK._PointInTriangle=function(a,b,c,d,e,f,g,h){var i=g-c,j=h-d,k=e-c,l=f-d,m=a-c,n=b-d,o=i*i+j*j,p=i*k+j*l,q=i*m+j*n,r=k*k+l*l,s=k*m+l*n,t=1/(o*r-p*p),u=(r*q-p*s)*t,v=(o*s-p*q)*t;return u>=0&&v>=0&&1>u+v},e.PolyK._convex=function(a,b,c,d,e,f,g){return(b-d)*(e-c)+(c-a)*(f-d)>=0===g},e.initDefaultShaders=function(){},e.CompileVertexShader=function(a,b){return e._CompileShader(a,b,a.VERTEX_SHADER)},e.CompileFragmentShader=function(a,b){return e._CompileShader(a,b,a.FRAGMENT_SHADER)},e._CompileShader=function(a,b,c){var d=b.join("\n"),e=a.createShader(c);return a.shaderSource(e,d),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(window.console.log(a.getShaderInfoLog(e)),null)},e.compileProgram=function(a,b,c){var d=e.CompileFragmentShader(a,c),f=e.CompileVertexShader(a,b),g=a.createProgram();return a.attachShader(g,f),a.attachShader(g,d),a.linkProgram(g),a.getProgramParameter(g,a.LINK_STATUS)||window.console.log("Could not initialise shaders"),g},e.PixiShader=function(a){this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var c in this.uniforms)this.uniforms[c].uniformLocation=a.getUniformLocation(b,c);this.initUniforms(),this.program=b},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms){a=this.uniforms[c];var d=a.type;"sampler2D"===d?(a._init=!1,null!==a.value&&this.initSampler2D(a)):"mat2"===d||"mat3"===d||"mat4"===d?(a.glMatrix=!0,a.glValueLength=1,"mat2"===d?a.glFunc=b.uniformMatrix2fv:"mat3"===d?a.glFunc=b.uniformMatrix3fv:"mat4"===d&&(a.glFunc=b.uniformMatrix4fv)):(a.glFunc=b["uniform"+d],a.glValueLength="2f"===d||"2i"===d?2:"3f"===d||"3i"===d?3:"4f"===d||"4i"===d?4:1)}},e.PixiShader.prototype.initSampler2D=function(a){if(a.value&&a.value.baseTexture&&a.value.baseTexture.hasLoaded){var b=this.gl;if(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTexture),a.textureData){var c=a.textureData,d=c.magFilter?c.magFilter:b.LINEAR,e=c.minFilter?c.minFilter:b.LINEAR,f=c.wrapS?c.wrapS:b.CLAMP_TO_EDGE,g=c.wrapT?c.wrapT:b.CLAMP_TO_EDGE,h=c.luminance?b.LUMINANCE:b.RGBA;if(c.repeat&&(f=b.REPEAT,g=b.REPEAT),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),c.width){var i=c.width?c.width:512,j=c.height?c.height:2,k=c.border?c.border:0;b.texImage2D(b.TEXTURE_2D,0,h,i,j,k,h,b.UNSIGNED_BYTE,null)}else b.texImage2D(b.TEXTURE_2D,0,h,b.RGBA,b.UNSIGNED_BYTE,a.value.baseTexture.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,f),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,g)}b.uniform1i(a.uniformLocation,this.textureCount),a._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms)a=this.uniforms[c],1===a.glValueLength?a.glMatrix===!0?a.glFunc.call(b,a.uniformLocation,a.transpose,a.value):a.glFunc.call(b,a.uniformLocation,a.value):2===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y):3===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z):4===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z,a.value.w):"sampler2D"===a.type&&(a._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]||e.createWebGLTexture(a.value.baseTexture,b)),b.uniform1i(a.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(a))},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(a){this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.uMatrix=a.getUniformLocation(b,"uMatrix"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aPositionCoord=a.getAttribLocation(b,"aPositionCoord"),this.aScale=a.getAttribLocation(b,"aScale"),this.aRotation=a.getAttribLocation(b,"aRotation"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=b},e.StripShader=function(){this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","uniform vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]},e.StripShader.prototype.init=function(){var a=e.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b
},e.PrimitiveShader=function(a){this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.tintColor=a.getUniformLocation(b,"tint"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(a,b){var c=b.gl,d=b.projection,f=b.offset,g=b.shaderManager.primitiveShader;a._webGL[c.id]||(a._webGL[c.id]={points:[],indices:[],lastIndex:0,buffer:c.createBuffer(),indexBuffer:c.createBuffer()});var h=a._webGL[c.id];a.dirty&&(a.dirty=!1,a.clearDirty&&(a.clearDirty=!1,h.lastIndex=0,h.points=[],h.indices=[]),e.WebGLGraphics.updateGraphics(a,c)),b.shaderManager.activatePrimitiveShader(),e.mat3.transpose(a.worldTransform,e.tempMatrix),c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA),c.uniformMatrix3fv(g.translationMatrix,!1,e.tempMatrix),c.uniform2f(g.projectionVector,d.x,-d.y),c.uniform2f(g.offsetVector,-f.x,-f.y),c.uniform3fv(g.tintColor,e.hex2rgb(a.tint)),c.uniform1f(g.alpha,a.worldAlpha),c.bindBuffer(c.ARRAY_BUFFER,h.buffer),c.vertexAttribPointer(g.aVertexPosition,2,c.FLOAT,!1,24,0),c.vertexAttribPointer(g.colorAttribute,4,c.FLOAT,!1,24,8),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,h.indexBuffer),c.drawElements(c.TRIANGLE_STRIP,h.indices.length,c.UNSIGNED_SHORT,0),b.shaderManager.deactivatePrimitiveShader()},e.WebGLGraphics.updateGraphics=function(a,b){for(var c=a._webGL[b.id],d=c.lastIndex;d<a.graphicsData.length;d++){var f=a.graphicsData[d];f.type===e.Graphics.POLY?(f.fill&&f.points.length>3&&e.WebGLGraphics.buildPoly(f,c),f.lineWidth>0&&e.WebGLGraphics.buildLine(f,c)):f.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(f,c):(f.type===e.Graphics.CIRC||f.type===e.Graphics.ELIP)&&e.WebGLGraphics.buildCircle(f,c)}c.lastIndex=a.graphicsData.length,c.glPoints=new Float32Array(c.points),b.bindBuffer(b.ARRAY_BUFFER,c.buffer),b.bufferData(b.ARRAY_BUFFER,c.glPoints,b.STATIC_DRAW),c.glIndicies=new Uint16Array(c.indices),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,c.glIndicies,b.STATIC_DRAW)},e.WebGLGraphics.buildRectangle=function(a,b){var c=a.points,d=c[0],f=c[1],g=c[2],h=c[3];if(a.fill){var i=e.hex2rgb(a.fillColor),j=a.fillAlpha,k=i[0]*j,l=i[1]*j,m=i[2]*j,n=b.points,o=b.indices,p=n.length/6;n.push(d,f),n.push(k,l,m,j),n.push(d+g,f),n.push(k,l,m,j),n.push(d,f+h),n.push(k,l,m,j),n.push(d+g,f+h),n.push(k,l,m,j),o.push(p,p,p+1,p+2,p+3,p+3)}if(a.lineWidth){var q=a.points;a.points=[d,f,d+g,f,d+g,f+h,d,f+h,d,f],e.WebGLGraphics.buildLine(a,b),a.points=q}},e.WebGLGraphics.buildCircle=function(a,b){var c=a.points,d=c[0],f=c[1],g=c[2],h=c[3],i=40,j=2*Math.PI/i,k=0;if(a.fill){var l=e.hex2rgb(a.fillColor),m=a.fillAlpha,n=l[0]*m,o=l[1]*m,p=l[2]*m,q=b.points,r=b.indices,s=q.length/6;for(r.push(s),k=0;i+1>k;k++)q.push(d,f,n,o,p,m),q.push(d+Math.sin(j*k)*g,f+Math.cos(j*k)*h,n,o,p,m),r.push(s++,s++);r.push(s-1)}if(a.lineWidth){var t=a.points;for(a.points=[],k=0;i+1>k;k++)a.points.push(d+Math.sin(j*k)*g,f+Math.cos(j*k)*h);e.WebGLGraphics.buildLine(a,b),a.points=t}},e.WebGLGraphics.buildLine=function(a,b){var c=0,d=a.points;if(0!==d.length){if(a.lineWidth%2)for(c=0;c<d.length;c++)d[c]+=.5;var f=new e.Point(d[0],d[1]),g=new e.Point(d[d.length-2],d[d.length-1]);if(f.x===g.x&&f.y===g.y){d.pop(),d.pop(),g=new e.Point(d[d.length-2],d[d.length-1]);var h=g.x+.5*(f.x-g.x),i=g.y+.5*(f.y-g.y);d.unshift(h,i),d.push(h,i)}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=b.points,H=b.indices,I=d.length/2,J=d.length,K=G.length/6,L=a.lineWidth/2,M=e.hex2rgb(a.lineColor),N=a.lineAlpha,O=M[0]*N,P=M[1]*N,Q=M[2]*N;for(l=d[0],m=d[1],n=d[2],o=d[3],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(l-r,m-s,O,P,Q,N),G.push(l+r,m+s,O,P,Q,N),c=1;I-1>c;c++)l=d[2*(c-1)],m=d[2*(c-1)+1],n=d[2*c],o=d[2*c+1],p=d[2*(c+1)],q=d[2*(c+1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,t=-(o-q),u=n-p,F=Math.sqrt(t*t+u*u),t/=F,u/=F,t*=L,u*=L,x=-s+m-(-s+o),y=-r+n-(-r+l),z=(-r+l)*(-s+o)-(-r+n)*(-s+m),A=-u+q-(-u+o),B=-t+n-(-t+p),C=(-t+p)*(-u+o)-(-t+n)*(-u+q),D=x*B-A*y,Math.abs(D)<.1?(D+=10.1,G.push(n-r,o-s,O,P,Q,N),G.push(n+r,o+s,O,P,Q,N)):(j=(y*C-B*z)/D,k=(A*z-x*C)/D,E=(j-n)*(j-n)+(k-o)+(k-o),E>19600?(v=r-t,w=s-u,F=Math.sqrt(v*v+w*w),v/=F,w/=F,v*=L,w*=L,G.push(n-v,o-w),G.push(O,P,Q,N),G.push(n+v,o+w),G.push(O,P,Q,N),G.push(n-v,o-w),G.push(O,P,Q,N),J++):(G.push(j,k),G.push(O,P,Q,N),G.push(n-(j-n),o-(k-o)),G.push(O,P,Q,N)));for(l=d[2*(I-2)],m=d[2*(I-2)+1],n=d[2*(I-1)],o=d[2*(I-1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(n-r,o-s),G.push(O,P,Q,N),G.push(n+r,o+s),G.push(O,P,Q,N),H.push(K),c=0;J>c;c++)H.push(K++);H.push(K-1)}},e.WebGLGraphics.buildPoly=function(a,b){var c=a.points;if(!(c.length<6)){var d=b.points,f=b.indices,g=c.length/2,h=e.hex2rgb(a.fillColor),i=a.fillAlpha,j=h[0]*i,k=h[1]*i,l=h[2]*i,m=e.PolyK.Triangulate(c),n=d.length/6,o=0;for(o=0;o<m.length;o+=3)f.push(m[o]+n),f.push(m[o]+n),f.push(m[o+1]+n),f.push(m[o+2]+n),f.push(m[o+2]+n);for(o=0;g>o;o++)d.push(c[2*o],c[2*o+1],j,k,l,i)}},e.glContexts=[],e.WebGLRenderer=function(a,b,c,d,f){e.defaultRenderer||(e.defaultRenderer=this),this.type=e.WEBGL_RENDERER,this.transparent=!!d,this.width=a||800,this.height=b||600,this.view=c||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var g=this;this.view.addEventListener("webglcontextlost",function(a){g.handleContextLost(a)},!1),this.view.addEventListener("webglcontextrestored",function(a){g.handleContextRestored(a)},!1),this.options={alpha:this.transparent,antialias:!!f,premultipliedAlpha:!1,stencil:!0};try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(h){try{this.gl=this.view.getContext("webgl",this.options)}catch(i){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var j=this.gl;this.glContextId=j.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=j,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[j.ONE,j.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[j.SRC_ALPHA,j.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[j.DST_COLOR,j.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[j.SRC_ALPHA,j.ONE]),this.projection=new e.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new e.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(j),this.spriteBatch=new e.WebGLSpriteBatch(j),this.maskManager=new e.WebGLMaskManager(j),this.filterManager=new e.WebGLFilterManager(j,this.transparent),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.spriteBatch=this.spriteBatch,j.useProgram(this.shaderManager.defaultShader.program),j.disable(j.DEPTH_TEST),j.disable(j.CULL_FACE),j.enable(j.BLEND),j.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(a){if(!this.contextLost){this.__stage!==a&&(this.__stage=a),e.WebGLRenderer.updateTextures(),a.updateTransform();var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,null),b.clearColor(a.backgroundColorSplit[0],a.backgroundColorSplit[1],a.backgroundColorSplit[2],!this.transparent),b.clear(b.COLOR_BUFFER_BIT),this.renderDisplayObject(a,this.projection),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)))}},e.WebGLRenderer.prototype.renderDisplayObject=function(a,b){this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=b,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,null),a._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var a=0;for(a=0;a<e.Texture.frameUpdates.length;a++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[a]);for(a=0;a<e.texturesToDestroy.length;a++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[a]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(a){for(var b=a._glTextures.length-1;b>=0;b--){var c=a._glTextures[b],d=e.glContexts[b];d&&c&&d.deleteTexture(c)}a._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(a){a.updateFrame=!1,a._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},e.createWebGLTexture=function(a,b){return a.hasLoaded&&(a._glTextures[b.id]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===e.BaseTexture.SCALE_MODE.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===e.BaseTexture.SCALE_MODE.LINEAR?b.LINEAR:b.NEAREST),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),b.bindTexture(b.TEXTURE_2D,null)),a._glTextures[b.id]},e.updateWebGLTexture=function(a,b){a._glTextures[b.id]&&(b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===e.BaseTexture.SCALE_MODE.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===e.BaseTexture.SCALE_MODE.LINEAR?b.LINEAR:b.NEAREST),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),b.bindTexture(b.TEXTURE_2D,null))},e.WebGLRenderer.prototype.handleContextLost=function(a){a.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(a){try{this.gl=this.view.getContext("webgl",this.options)}catch(b){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var c=this.gl;c.id=e.WebGLRenderer.glContextId++,this.shaderManager.setContext(c),this.spriteBatch.setContext(c),this.maskManager.setContext(c),this.filterManager.setContext(c),this.renderSession.gl=this.gl,c.disable(c.DEPTH_TEST),c.disable(c.CULL_FACE),c.enable(c.BLEND),c.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var d in e.TextureCache){var f=e.TextureCache[d].baseTexture;f._glTextures=[]}this.contextLost=!1},e.WebGLRenderer.glContextId=0,e.WebGLMaskManager=function(a){this.maskStack=[],this.maskPosition=0,this.setContext(a)},e.WebGLMaskManager.prototype.setContext=function(a){this.gl=a},e.WebGLMaskManager.prototype.pushMask=function(a,b){var c=this.gl;0===this.maskStack.length&&(c.enable(c.STENCIL_TEST),c.stencilFunc(c.ALWAYS,1,1)),this.maskStack.push(a),c.colorMask(!1,!1,!1,!0),c.stencilOp(c.KEEP,c.KEEP,c.INCR),e.WebGLGraphics.renderGraphics(a,b),c.colorMask(!0,!0,!0,!0),c.stencilFunc(c.NOTEQUAL,0,this.maskStack.length),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)},e.WebGLMaskManager.prototype.popMask=function(a){var b=this.gl,c=this.maskStack.pop();c&&(b.colorMask(!1,!1,!1,!1),b.stencilOp(b.KEEP,b.KEEP,b.DECR),e.WebGLGraphics.renderGraphics(c,a),b.colorMask(!0,!0,!0,!0),b.stencilFunc(b.NOTEQUAL,0,this.maskStack.length),b.stencilOp(b.KEEP,b.KEEP,b.KEEP)),0===this.maskStack.length&&b.disable(b.STENCIL_TEST)},e.WebGLShaderManager=function(a){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.setContext(a)},e.WebGLShaderManager.prototype.setContext=function(a){this.gl=a,this.primitiveShader=new e.PrimitiveShader(a),this.defaultShader=new e.PixiShader(a),this.fastShader=new e.PixiFastShader(a),this.activateShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(b=0;b<a.length;b++){var c=a[b];this.tempAttribState[c]=!0}var d=this.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.tempAttribState[b]?d.enableVertexAttribArray(b):d.disableVertexAttribArray(b))},e.WebGLShaderManager.prototype.activateShader=function(a){this.currentShader=a,this.gl.useProgram(a.program),this.setAttribs(a.attributes)},e.WebGLShaderManager.prototype.activatePrimitiveShader=function(){var a=this.gl;a.useProgram(this.primitiveShader.program),this.setAttribs(this.primitiveShader.attributes)},e.WebGLShaderManager.prototype.deactivatePrimitiveShader=function(){var a=this.gl;a.useProgram(this.defaultShader.program),this.setAttribs(this.defaultShader.attributes)},e.WebGLSpriteBatch=function(a){this.vertSize=6,this.size=1e4;var b=4*this.size*this.vertSize,c=6*this.size;this.vertices=new Float32Array(b),this.indices=new Uint16Array(c),this.lastIndexCount=0;for(var d=0,e=0;c>d;d+=6,e+=4)this.indices[d+0]=e+0,this.indices[d+1]=e+1,this.indices[d+2]=e+2,this.indices[d+3]=e+0,this.indices[d+4]=e+2,this.indices[d+5]=e+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(a)},e.WebGLSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(a){this.renderSession=a,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(a){(a.texture.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=a.texture.baseTexture),a.blendMode!==this.currentBlendMode&&this.setBlendMode(a.blendMode);var b=a._uvs||a.texture._uvs;if(b){var c,d,e,f,g=a.worldAlpha,h=a.tint,i=this.vertices,j=a.texture.frame.width,k=a.texture.frame.height,l=a.anchor.x,m=a.anchor.y;if(a.texture.trimmed){var n=a.texture.trim;d=n.x-l*n.realWidth,c=d+j,f=n.y-m*n.realHeight,e=f+k}else c=j*(1-l),d=j*-l,e=k*(1-m),f=k*-m;var o=4*this.currentBatchSize*this.vertSize,p=a.worldTransform,q=p[0],r=p[3],s=p[1],t=p[4],u=p[2],v=p[5];i[o++]=q*d+s*f+u,i[o++]=t*f+r*d+v,i[o++]=b[0],i[o++]=b[1],i[o++]=g,i[o++]=h,i[o++]=q*c+s*f+u,i[o++]=t*f+r*c+v,i[o++]=b[2],i[o++]=b[3],i[o++]=g,i[o++]=h,i[o++]=q*c+s*e+u,i[o++]=t*e+r*c+v,i[o++]=b[4],i[o++]=b[5],i[o++]=g,i[o++]=h,i[o++]=q*d+s*e+u,i[o++]=t*e+r*d+v,i[o++]=b[6],i[o++]=b[7],i[o++]=g,i[o++]=h,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(a){var b=a.tilingTexture;(b.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=b.baseTexture),a.blendMode!==this.currentBlendMode&&this.setBlendMode(a.blendMode),a._uvs||(a._uvs=new Float32Array(8));var c=a._uvs,d=a.tilePosition.x/b.baseTexture.width,e=a.tilePosition.y/b.baseTexture.height,f=a.width/b.baseTexture.width/(a.tileScale.x*a.tileScaleOffset.x),g=a.height/b.baseTexture.height/(a.tileScale.y*a.tileScaleOffset.y);c[0]=0-d,c[1]=0-e,c[2]=1*f-d,c[3]=0-e,c[4]=1*f-d,c[5]=1*g-e,c[6]=0-d,c[7]=1*g-e;var h=a.worldAlpha,i=a.tint,j=this.vertices,k=a.width,l=a.height,m=a.anchor.x,n=a.anchor.y,o=k*(1-m),p=k*-m,q=l*(1-n),r=l*-n,s=4*this.currentBatchSize*this.vertSize,t=a.worldTransform,u=t[0],v=t[3],w=t[1],x=t[4],y=t[2],z=t[5];j[s++]=u*p+w*r+y,j[s++]=x*r+v*p+z,j[s++]=c[0],j[s++]=c[1],j[s++]=h,j[s++]=i,j[s++]=u*o+w*r+y,j[s++]=x*r+v*o+z,j[s++]=c[2],j[s++]=c[3],j[s++]=h,j[s++]=i,j[s++]=u*o+w*q+y,j[s++]=x*q+v*o+z,j[s++]=c[4],j[s++]=c[5],j[s++]=h,j[s++]=i,j[s++]=u*p+w*q+y,j[s++]=x*q+v*p+z,j[s++]=c[6],j[s++]=c[7],j[s++]=h,j[s++]=i,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;if(a.bindTexture(a.TEXTURE_2D,this.currentBaseTexture._glTextures[a.id]||e.createWebGLTexture(this.currentBaseTexture,a)),this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,b)}a.drawElements(a.TRIANGLES,6*this.currentBatchSize,a.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){var a=this.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;a.uniform2f(this.shader.projectionVector,b.x,b.y);var c=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,c,0),a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,c,8),a.vertexAttribPointer(this.shader.colorAttribute,2,a.FLOAT,!1,c,16),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLSpriteBatch.prototype.setBlendMode=function(a){this.flush(),this.currentBlendMode=a;var b=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(b[0],b[1])},e.WebGLFastSpriteBatch=function(a){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var b=4*this.size*this.vertSize,c=6*this.maxSize;this.vertices=new Float32Array(b),this.indices=new Uint16Array(c),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var d=0,f=0;c>d;d+=6,f+=4)this.indices[d+0]=f+0,this.indices[d+1]=f+1,this.indices[d+2]=f+2,this.indices[d+3]=f+0,this.indices[d+4]=f+2,this.indices[d+5]=f+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.tempMatrix=e.mat3.create(),this.setContext(a)},e.WebGLFastSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLFastSpriteBatch.prototype.begin=function(a,b){this.renderSession=b,this.shader=this.renderSession.shaderManager.fastShader,e.mat3.transpose(a.worldTransform,this.tempMatrix),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(a){var b=a.children,c=b[0];if(c.texture._uvs){this.currentBaseTexture=c.texture.baseTexture,c.blendMode!==this.currentBlendMode&&this.setBlendMode(c.blendMode);for(var d=0,e=b.length;e>d;d++)this.renderSprite(b[d]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(a){if(a.texture.baseTexture===this.currentBaseTexture||(this.currentBaseTexture=a.texture.baseTexture,this.flush(),a.texture._uvs)){var b,c,d,e,f,g,h,i,j=this.vertices;if(b=a.texture._uvs,c=a.texture.frame.width,d=a.texture.frame.height,a.texture.trimmed){var k=a.texture.trim;f=k.x-a.anchor.x*k.realWidth,e=f+a.texture.frame.width,h=k.y-a.anchor.y*k.realHeight,g=h+a.texture.frame.height}else e=a.texture.frame.width*(1-a.anchor.x),f=a.texture.frame.width*-a.anchor.x,g=a.texture.frame.height*(1-a.anchor.y),h=a.texture.frame.height*-a.anchor.y;i=4*this.currentBatchSize*this.vertSize,j[i++]=f,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b[0],j[i++]=b[1],j[i++]=a.alpha,j[i++]=e,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b[2],j[i++]=b[3],j[i++]=a.alpha,j[i++]=e,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b[4],j[i++]=b[5],j[i++]=a.alpha,j[i++]=f,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b[6],j[i++]=b[7],j[i++]=a.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;if(this.currentBaseTexture._glTextures[a.id]||e.createWebGLTexture(this.currentBaseTexture,a),a.bindTexture(a.TEXTURE_2D,this.currentBaseTexture._glTextures[a.id]),this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,b)}a.drawElements(a.TRIANGLES,6*this.currentBatchSize,a.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var a=this.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;a.uniform2f(this.shader.projectionVector,b.x,b.y),a.uniformMatrix3fv(this.shader.uMatrix,!1,this.tempMatrix);var c=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,c,0),a.vertexAttribPointer(this.shader.aPositionCoord,2,a.FLOAT,!1,c,8),a.vertexAttribPointer(this.shader.aScale,2,a.FLOAT,!1,c,16),a.vertexAttribPointer(this.shader.aRotation,1,a.FLOAT,!1,c,24),a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,c,28),a.vertexAttribPointer(this.shader.colorAttribute,1,a.FLOAT,!1,c,36),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLFastSpriteBatch.prototype.setBlendMode=function(a){this.flush(),this.currentBlendMode=a;var b=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(b[0],b[1])},e.WebGLFilterManager=function(a,b){this.transparent=b,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(a)},e.WebGLFilterManager.prototype.setContext=function(a){this.gl=a,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(a,b){this.renderSession=a,this.defaultShader=a.shaderManager.defaultShader;var c=this.renderSession.projection;this.width=2*c.x,this.height=2*-c.y,this.buffer=b},e.WebGLFilterManager.prototype.pushFilter=function(a){var b=this.gl,c=this.renderSession.projection,d=this.renderSession.offset;this.filterStack.push(a);var f=a.filterPasses[0];this.offsetX+=a.target.filterArea.x,this.offsetY+=a.target.filterArea.y;var g=this.texturePool.pop();g?g.resize(this.width,this.height):g=new e.FilterTexture(this.gl,this.width,this.height),b.bindTexture(b.TEXTURE_2D,g.texture),a.target.filterArea=a.target.getBounds();var h=a.target.filterArea,i=f.padding;h.x-=i,h.y-=i,h.width+=2*i,h.height+=2*i,h.x<0&&(h.x=0),h.width>this.width&&(h.width=this.width),h.y<0&&(h.y=0),h.height>this.height&&(h.height=this.height),b.bindFramebuffer(b.FRAMEBUFFER,g.frameBuffer),b.viewport(0,0,h.width,h.height),c.x=h.width/2,c.y=-h.height/2,d.x=-h.x,d.y=-h.y,b.uniform2f(this.defaultShader.projectionVector,h.width/2,-h.height/2),b.uniform2f(this.defaultShader.offsetVector,-h.x,-h.y),b.colorMask(!0,!0,!0,!0),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),a._glFilterTexture=g},e.WebGLFilterManager.prototype.popFilter=function(){var a=this.gl,b=this.filterStack.pop(),c=b.target.filterArea,d=b._glFilterTexture,f=this.renderSession.projection,g=this.renderSession.offset;if(b.filterPasses.length>1){a.viewport(0,0,c.width,c.height),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=c.height,this.vertexArray[2]=c.width,this.vertexArray[3]=c.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=c.width,this.vertexArray[7]=0,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray);var h=d,i=this.texturePool.pop();i||(i=new e.FilterTexture(this.gl,this.width,this.height)),a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.BLEND);for(var j=0;j<b.filterPasses.length-1;j++){var k=b.filterPasses[j];a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,h.texture),this.applyFilterPass(k,c,c.width,c.height);var l=h;h=i,i=l}a.enable(a.BLEND),d=h,this.texturePool.push(i)}var m=b.filterPasses[b.filterPasses.length-1];this.offsetX-=c.x,this.offsetY-=c.y;var n=this.width,o=this.height,p=0,q=0,r=this.buffer;if(0===this.filterStack.length)a.colorMask(!0,!0,!0,this.transparent);else{var s=this.filterStack[this.filterStack.length-1];c=s.target.filterArea,n=c.width,o=c.height,p=c.x,q=c.y,r=s._glFilterTexture.frameBuffer}f.x=n/2,f.y=-o/2,g.x=p,g.y=q,c=b.target.filterArea;var t=c.x-p,u=c.y-q;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=t,this.vertexArray[1]=u+c.height,this.vertexArray[2]=t+c.width,this.vertexArray[3]=u+c.height,this.vertexArray[4]=t,this.vertexArray[5]=u,this.vertexArray[6]=t+c.width,this.vertexArray[7]=u,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray),a.viewport(0,0,n,o),a.bindFramebuffer(a.FRAMEBUFFER,r),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,d.texture),this.applyFilterPass(m,c,n,o),a.useProgram(this.defaultShader.program),a.uniform2f(this.defaultShader.projectionVector,n/2,-o/2),a.uniform2f(this.defaultShader.offsetVector,-p,-q),this.texturePool.push(d),b._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(a,b,c,d){var f=this.gl,g=a.shaders[f.id];g||(g=new e.PixiShader(f),g.fragmentSrc=a.fragmentSrc,g.uniforms=a.uniforms,g.init(),a.shaders[f.id]=g),f.useProgram(g.program),f.uniform2f(g.projectionVector,c/2,-d/2),f.uniform2f(g.offsetVector,0,0),a.uniforms.dimensions&&(a.uniforms.dimensions.value[0]=this.width,a.uniforms.dimensions.value[1]=this.height,a.uniforms.dimensions.value[2]=this.vertexArray[0],a.uniforms.dimensions.value[3]=this.vertexArray[5]),g.syncUniforms(),f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer),f.vertexAttribPointer(g.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer),f.vertexAttribPointer(g.aTextureCoord,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.vertexAttribPointer(g.colorAttribute,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var a=this.gl;this.vertexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.bufferData(a.ARRAY_BUFFER,this.uvArray,a.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer),a.bufferData(a.ARRAY_BUFFER,this.colorArray,a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),a.STATIC_DRAW)},e.FilterTexture=function(a,b,c){this.gl=a,this.frameBuffer=a.createFramebuffer(),this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0),this.resize(b,c)},e.FilterTexture.prototype.clear=function(){var a=this.gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(a,b){if(this.width!==a||this.height!==b){this.width=a,this.height=b;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,null)}},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(a,b){b.save();var c=a.alpha,d=a.worldTransform;b.setTransform(d[0],d[3],d[1],d[4],d[2],d[5]),e.CanvasGraphics.renderGraphicsMask(a,b),b.clip(),a.worldAlpha=c},e.CanvasMaskManager.prototype.popMask=function(a){a.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(a,b){var c=a.texture;b=e.CanvasTinter.roundColor(b);var d="#"+("00000"+(0|b).toString(16)).substr(-6);if(c.tintCache=c.tintCache||{},c.tintCache[d])return c.tintCache[d];var f=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(c,b,f),e.CanvasTinter.convertTintToImage){var g=new Image;g.src=f.toDataURL(),c.tintCache[d]=g}else c.tintCache[d]=f,e.CanvasTinter.canvas=null;return f},e.CanvasTinter.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.frame;c.width=e.width,c.height=e.height,d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="multiply",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithOverlay=function(a,b,c){var d=c.getContext("2d"),e=a.frame;c.width=e.width,c.height=e.height,d.globalCompositeOperation="copy",d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithPerPixel=function(a,b,c){var d=c.getContext("2d"),f=a.frame;c.width=f.width,c.height=f.height,d.globalCompositeOperation="copy",d.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height);
for(var g=e.hex2rgb(b),h=g[0],i=g[1],j=g[2],k=d.getImageData(0,0,f.width,f.height),l=k.data,m=0;m<l.length;m+=4)l[m+0]*=h,l[m+1]*=i,l[m+2]*=j;d.putImageData(k,0,0)},e.CanvasTinter.roundColor=function(a){var b=e.CanvasTinter.cacheStepsPerColorChannel,c=e.hex2rgb(a);return c[0]=Math.min(255,c[0]/b*b),c[1]=Math.min(255,c[1]/b*b),c[2]=Math.min(255,c[2]/b*b),e.rgb2hex(c)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(a,b,c,d){e.defaultRenderer=e.defaultRenderer||this,this.type=e.CANVAS_RENDERER,this.transparent=d,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over")),this.width=a||800,this.height=b||600,this.view=c||document.createElement("canvas"),this.context=this.view.getContext("2d"),this.smoothProperty=null,"imageSmoothingEnabled"in this.context?this.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.smoothProperty="oImageSmoothingEnabled"),this.scaleMode=null,this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={},this.renderSession.context=this.context,this.renderSession.maskManager=this.maskManager},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(a){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,a.updateTransform(),this.view.style.backgroundColor===a.backgroundColorString||this.transparent||(this.view.style.backgroundColor=a.backgroundColorString),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(a),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b},e.CanvasRenderer.prototype.renderDisplayObject=function(a,b){this.renderSession.context=b||this.context,a._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(a){var b=this.context,c=a.verticies,d=c.length/2;this.count++,b.beginPath();for(var e=1;d-2>e;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},e.CanvasRenderer.prototype.renderStrip=function(a){var b=this.context,c=a.verticies,d=a.uvs,e=c.length/2;this.count++;for(var f=1;e-2>f;f++){var g=2*f,h=c[g],i=c[g+2],j=c[g+4],k=c[g+1],l=c[g+3],m=c[g+5],n=d[g]*a.texture.width,o=d[g+2]*a.texture.width,p=d[g+4]*a.texture.width,q=d[g+1]*a.texture.height,r=d[g+3]*a.texture.height,s=d[g+5]*a.texture.height;b.save(),b.beginPath(),b.moveTo(h,k),b.lineTo(i,l),b.lineTo(j,m),b.closePath(),b.clip();var t=n*r+q*p+o*s-r*p-q*o-n*s,u=h*r+q*j+i*s-r*j-q*i-h*s,v=n*i+h*p+o*j-i*p-h*o-n*j,w=n*r*j+q*i*p+h*o*s-h*r*p-q*o*j-n*i*s,x=k*r+q*m+l*s-r*m-q*l-k*s,y=n*l+k*p+o*m-l*p-k*o-n*m,z=n*r*m+q*l*p+k*o*s-k*r*p-q*o*m-n*l*s;b.transform(u/t,x/t,v/t,y/t,w/t,z/t),b.drawImage(a.texture.baseTexture.source,0,0),b.restore()}},e.CanvasBuffer=function(a,b){this.width=a,this.height=b,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(a,b){this.width=this.canvas.width=a,this.height=this.canvas.height=b},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(a,b){for(var c=a.worldAlpha,d="",f=0;f<a.graphicsData.length;f++){var g=a.graphicsData[f],h=g.points;if(b.strokeStyle=d="#"+("00000"+(0|g.lineColor).toString(16)).substr(-6),b.lineWidth=g.lineWidth,g.type===e.Graphics.POLY){b.beginPath(),b.moveTo(h[0],h[1]);for(var i=1;i<h.length/2;i++)b.lineTo(h[2*i],h[2*i+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke())}else if(g.type===e.Graphics.RECT)(g.fillColor||0===g.fillColor)&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fillRect(h[0],h[1],h[2],h[3])),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.strokeRect(h[0],h[1],h[2],h[3]));else if(g.type===e.Graphics.CIRC)b.beginPath(),b.arc(h[0],h[1],h[2],0,2*Math.PI),b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke());else if(g.type===e.Graphics.ELIP){var j=g.points,k=2*j[2],l=2*j[3],m=j[0]-k/2,n=j[1]-l/2;b.beginPath();var o=.5522848,p=k/2*o,q=l/2*o,r=m+k,s=n+l,t=m+k/2,u=n+l/2;b.moveTo(m,u),b.bezierCurveTo(m,u-q,t-p,n,t,n),b.bezierCurveTo(t+p,n,r,u-q,r,u),b.bezierCurveTo(r,u+q,t+p,s,t,s),b.bezierCurveTo(t-p,s,m,u+q,m,u),b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){c>1&&(c=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var d=0;1>d;d++){var f=a.graphicsData[d],g=f.points;if(f.type===e.Graphics.POLY){b.beginPath(),b.moveTo(g[0],g[1]);for(var h=1;h<g.length/2;h++)b.lineTo(g[2*h],g[2*h+1]);g[0]===g[g.length-2]&&g[1]===g[g.length-1]&&b.closePath()}else if(f.type===e.Graphics.RECT)b.beginPath(),b.rect(g[0],g[1],g[2],g[3]),b.closePath();else if(f.type===e.Graphics.CIRC)b.beginPath(),b.arc(g[0],g[1],g[2],0,2*Math.PI),b.closePath();else if(f.type===e.Graphics.ELIP){var i=f.points,j=2*i[2],k=2*i[3],l=i[0]-j/2,m=i[1]-k/2;b.beginPath();var n=.5522848,o=j/2*n,p=k/2*n,q=l+j,r=m+k,s=l+j/2,t=m+k/2;b.moveTo(l,t),b.bezierCurveTo(l,t-p,s-o,m,s,m),b.bezierCurveTo(s+o,m,q,t-p,q,t),b.bezierCurveTo(q,t+p,s+o,r,s,r),b.bezierCurveTo(s-o,r,l,t+p,l,t),b.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap=a,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(a,b,c){this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=a||0,this.lineColor=b||0,this.lineAlpha=arguments.length<3?1:c,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath)},e.Graphics.prototype.moveTo=function(a,b){this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(a,b),this.graphicsData.push(this.currentPath)},e.Graphics.prototype.lineTo=function(a,b){this.currentPath.points.push(a,b),this.dirty=!0},e.Graphics.prototype.beginFill=function(a,b){this.filling=!0,this.fillColor=a||0,this.fillAlpha=arguments.length<2?1:b},e.Graphics.prototype.endFill=function(){this.filling=!1,this.fillColor=null,this.fillAlpha=1},e.Graphics.prototype.drawRect=function(a,b,c,d){this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,d],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0},e.Graphics.prototype.drawCircle=function(a,b,c){this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,c],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0},e.Graphics.prototype.drawEllipse=function(a,b,c,d){this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,d],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0},e.Graphics.prototype.clear=function(){this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null},e.Graphics.prototype.generateTexture=function(){var a=this.getBounds(),b=new e.CanvasBuffer(a.width,a.height),c=e.Texture.fromCanvas(b.canvas);return b.context.translate(-a.x,-a.y),e.CanvasGraphics.renderGraphics(this,b.context),c},e.Graphics.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,a.gl),this.dirty=!1),void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,a);if(a.spriteBatch.stop(),this._mask&&a.maskManager.pushMask(this.mask,a),this._filters&&a.filterManager.pushFilter(this._filterBlock),this.blendMode!==a.spriteBatch.currentBlendMode){this.spriteBatch.currentBlendMode=this.blendMode;var b=e.blendModesWebGL[a.spriteBatch.currentBlendMode];this.spriteBatch.gl.blendFunc(b[0],b[1])}if(e.WebGLGraphics.renderGraphics(this,a),this.children.length){a.spriteBatch.start();for(var c=0,d=this.children.length;d>c;c++)this.children[c]._renderWebGL(a);a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(a),a.drawCount++,a.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var b=a.context,c=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]),b.setTransform(c[0],c[3],c[1],c[4],c[2],c[5]),e.CanvasGraphics.renderGraphics(this,b);for(var d=0,f=this.children.length;f>d;d++)this.children[d]._renderCanvas(a)}},e.Graphics.prototype.getBounds=function(){this.bounds||this.updateBounds();var a=this.bounds.x,b=this.bounds.width+this.bounds.x,c=this.bounds.y,d=this.bounds.height+this.bounds.y,e=this.worldTransform,f=e[0],g=e[3],h=e[1],i=e[4],j=e[2],k=e[5],l=f*b+h*d+j,m=i*d+g*b+k,n=f*a+h*d+j,o=i*d+g*a+k,p=f*a+h*c+j,q=i*c+g*a+k,r=f*b+h*c+j,s=i*c+g*b+k,t=-1/0,u=-1/0,v=1/0,w=1/0;v=v>l?l:v,v=v>n?n:v,v=v>p?p:v,v=v>r?r:v,w=w>m?m:w,w=w>o?o:w,w=w>q?q:w,w=w>s?s:w,t=l>t?l:t,t=n>t?n:t,t=p>t?p:t,t=r>t?r:t,u=m>u?m:u,u=o>u?o:u,u=q>u?q:u,u=s>u?s:u;var x=this._bounds;return x.x=v,x.width=t-v,x.y=w,x.height=u-w,x},e.Graphics.prototype.updateBounds=function(){for(var a,b,c,d=1/0,f=-1/0,g=1/0,h=-1/0,i=0;i<this.graphicsData.length;i++){var j=this.graphicsData[i],k=j.type,l=j.lineWidth;if(a=j.points,k===e.Graphics.RECT){b=a.x-l/2,c=a.y-l/2;var m=a.width+l,n=a.height+l;d=d>b?b:d,f=b+m>f?b+m:f,g=g>c?b:g,h=c+n>h?c+n:h}else if(k===e.Graphics.CIRC||k===e.Graphics.ELIP){b=a.x,c=a.y;var o=a.radius+l/2;d=d>b-o?b-o:d,f=b+o>f?b+o:f,g=g>c-o?c-o:g,h=c+o>h?c+o:h}else for(var p=0;p<a.length;p+=2)b=a[p],c=a[p+1],d=d>b-l?b-l:d,f=b+l>f?b+l:f,g=g>c-l?c-l:g,h=c+l>h?c+l:h}var q=this.boundsPadding;this.bounds=new e.Rectangle(d-q,g-q,f-d+2*q,h-g+2*q)},e.Graphics.prototype._generateCachedSprite=function(){var a=this.getBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,a.height);else{var b=new e.CanvasBuffer(a.width,a.height),c=e.Texture.fromCanvas(b.canvas);this._cachedSprite=new e.Sprite(c),this._cachedSprite.buffer=b,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width),this._cachedSprite.anchor.y=-(a.y/a.height),this._cachedSprite.buffer.context.translate(-a.x,-a.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context)},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.tempMatrix=e.mat3.create(),e.Strip=function(a,b,c){e.DisplayObjectContainer.call(this),this.texture=a,this.blendMode=e.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(d){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=b,this.height=c,a.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype.setTexture=function(a){this.texture=a,this.width=a.frame.width,this.height=a.frame.height,this.updateFrame=!0},e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(a,b){e.Strip.call(this,a),this.points=b;try{this.verticies=new Float32Array(4*b.length),this.uvs=new Float32Array(4*b.length),this.colors=new Float32Array(2*b.length),this.indices=new Uint16Array(2*b.length)}catch(c){this.verticies=new Array(4*b.length),this.uvs=new Array(4*b.length),this.colors=new Array(2*b.length),this.indices=new Array(2*b.length)}this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=a[0],d=this.indices,e=this.colors;this.count-=.2,b[0]=0,b[1]=1,b[2]=0,b[3]=1,e[0]=1,e[1]=1,d[0]=0,d[1]=1;for(var f,g,h,i=a.length,j=1;i>j;j++)f=a[j],g=4*j,h=j/(i-1),j%2?(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1):(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1),g=2*j,e[g]=1,e[g+1]=1,g=2*j,d[g]=g,d[g+1]=g+1,c=f}},e.Rope.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){var b,c=a[0],d={x:0,y:0};this.count-=.2;var f=this.verticies;f[0]=c.x+d.x,f[1]=c.y+d.y,f[2]=c.x-d.x,f[3]=c.y-d.y;for(var g,h,i,j,k,l=a.length,m=1;l>m;m++)g=a[m],h=4*m,b=m<a.length-1?a[m+1]:g,d.y=-(b.x-c.x),d.x=b.y-c.y,i=10*(1-m/(l-1)),i>1&&(i=1),j=Math.sqrt(d.x*d.x+d.y*d.y),k=this.texture.height/2,d.x/=j,d.y/=j,d.x*=k,d.y*=k,f[h]=g.x+d.x,f[h+1]=g.y+d.y,f[h+2]=g.x-d.x,f[h+3]=g.y-d.y,c=g;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(a){this.texture=a,this.updateFrame=!0},e.TilingSprite=function(a,b,c){e.Sprite.call(this,a),this.width=b||100,this.height=c||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(a){this._width=a}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(a){this._height=a}}),e.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.TilingSprite.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha){var b,c;if(this.mask||this.filters){for(this.mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),this.filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),this.tilingTexture?a.spriteBatch.renderTilingSprite(this):this.generateTilingTexture(!0),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this.filters&&a.filterManager.popFilter(),this.mask&&a.maskManager.popMask(a),a.spriteBatch.start()}else for(this.tilingTexture?a.spriteBatch.renderTilingSprite(this):this.generateTilingTexture(!0),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},e.TilingSprite.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){var b=a.context;this._mask&&a.maskManager.pushMask(this._mask,b),b.globalAlpha=this.worldAlpha;var c=this.worldTransform;b.setTransform(c[0],c[3],c[1],c[4],c[2],c[5]),this.__tilePattern||(this.generateTilingTexture(!1),this.tilingTexture&&(this.__tilePattern=b.createPattern(this.tilingTexture.baseTexture.source,"repeat"))),this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]),b.beginPath();var d=this.tilePosition,f=this.tileScale;b.scale(f.x,f.y),b.translate(d.x,d.y),b.fillStyle=this.__tilePattern,b.fillRect(-d.x,-d.y,this.width/f.x,this.height/f.y),b.scale(1/f.x,1/f.y),b.translate(-d.x,-d.y),b.closePath(),this._mask&&a.maskManager.popMask(a.context)}},e.TilingSprite.prototype.getBounds=function(){var a=this._width,b=this._height,c=a*(1-this.anchor.x),d=a*-this.anchor.x,e=b*(1-this.anchor.y),f=b*-this.anchor.y,g=this.worldTransform,h=g[0],i=g[3],j=g[1],k=g[4],l=g[2],m=g[5],n=h*d+j*f+l,o=k*f+i*d+m,p=h*c+j*f+l,q=k*f+i*c+m,r=h*c+j*e+l,s=k*e+i*c+m,t=h*d+j*e+l,u=k*e+i*d+m,v=-1/0,w=-1/0,x=1/0,y=1/0;x=x>n?n:x,x=x>p?p:x,x=x>r?r:x,x=x>t?t:x,y=y>o?o:y,y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,v=n>v?n:v,v=p>v?p:v,v=r>v?r:v,v=t>v?t:v,w=o>w?o:w,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w;var z=this._bounds;return z.x=x,z.width=v-x,z.y=y,z.height=w-y,this._currentBounds=z,z},e.TilingSprite.prototype.generateTilingTexture=function(a){var b=this.texture;if(b.baseTexture.hasLoaded){var c,d,f=b.baseTexture,g=b.frame,h=g.width!==f.width||g.height!==f.height;this.tilingTexture=b;var i=!1;if(a?(c=e.getNextPowerOfTwo(b.frame.width),d=e.getNextPowerOfTwo(b.frame.height),g.width!==c&&g.height!==d&&(i=!0)):h&&(c=g.width,d=g.height,i=!0),i){var j=new e.CanvasBuffer(c,d);j.context.drawImage(b.baseTexture.source,g.x,g.y,g.width,g.height,0,0,c,d),this.tilingTexture=e.Texture.fromCanvas(j.canvas),this.tileScaleOffset.x=g.width/c,this.tileScaleOffset.y=g.height/d}this.tilingTexture.baseTexture._powerOf2=!0}};var j={};j.BoneData=function(a,b){this.name=a,this.parent=b},j.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},j.SlotData=function(a,b){this.name=a,this.boneData=b},j.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},j.Bone=function(a,b){this.data=a,this.parent=b,this.setToSetupPose()},j.Bone.yDown=!1,j.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(a,b){var c=this.parent;null!=c?(this.worldX=this.x*c.m00+this.y*c.m01+c.worldX,this.worldY=this.x*c.m10+this.y*c.m11+c.worldY,this.worldScaleX=c.worldScaleX*this.scaleX,this.worldScaleY=c.worldScaleY*this.scaleY,this.worldRotation=c.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var d=this.worldRotation*Math.PI/180,e=Math.cos(d),f=Math.sin(d);this.m00=e*this.worldScaleX,this.m10=f*this.worldScaleX,this.m01=-f*this.worldScaleY,this.m11=e*this.worldScaleY,a&&(this.m00=-this.m00,this.m01=-this.m01),b&&(this.m10=-this.m10,this.m11=-this.m11),j.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY}},j.Slot=function(a,b,c){this.data=a,this.skeleton=b,this.bone=c,this.setToSetupPose()},j.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(a){this.attachment=a,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(a){this._attachmentTime=this.skeleton.time-a},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},j.Skin=function(a){this.name=a,this.attachments={}},j.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d),10),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},j.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},j.Animation.prototype={apply:function(a,b,c){c&&this.duration&&(b%=this.duration);for(var d=this.timelines,e=0,f=d.length;f>e;e++)d[e].apply(a,b,1)},mix:function(a,b,c,d){c&&this.duration&&(b%=this.duration);for(var e=this.timelines,f=0,g=e.length;g>f;f++)e[f].apply(a,b,d)}},j.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(!e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},j.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},j.Curves=function(a){this.curves=[],this.curves.length=6*(a-1)},j.Curves.prototype={setLinear:function(a){this.curves[6*a]=0},setStepped:function(a){this.curves[6*a]=-1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=6*a,r=this.curves;r[q]=b*i+m*j+o*h,r[q+1]=c*i+n*j+p*h,r[q+2]=m*k+o*l,r[q+3]=n*k+p*l,r[q+4]=o*l,r[q+5]=p*l},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=6*a,d=this.curves,e=d[c];if(!e)return b;if(-1==e)return 0;for(var f=d[c+1],g=d[c+2],h=d[c+3],i=d[c+4],j=d[c+5],k=e,l=f,m=8;;){if(k>=b){var n=k-e,o=l-f;return o+(l-o)*(b-n)/(k-n)}if(!m)break;m--,e+=g,f+=h,g+=i,h+=j,k+=e,l+=f}return l+(1-l)*(b-k)/(1-k)}},j.RotateTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=2*a},j.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c){var d,e=this.frames;if(!(b<e[0])){var f=a.bones[this.boneIndex];if(b>=e[e.length-2]){for(d=f.data.rotation+e[e.length-1]-f.rotation;d>180;)d-=360;for(;-180>d;)d+=360;return void(f.rotation+=d*c)}var g=j.binarySearch(e,b,2),h=e[g-1],i=e[g],k=1-(b-i)/(e[g-2]-i);for(k=this.curves.getCurvePercent(g/2-1,k),d=e[g+1]-h;d>180;)d-=360;for(;-180>d;)d+=360;for(d=f.data.rotation+(h+d*k)-f.rotation;d>180;)d-=360;for(;-180>d;)d+=360;f.rotation+=d*c}}},j.TranslateTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=3*a},j.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.x+=(e.data.x+d[d.length-2]-e.x)*c,void(e.y+=(e.data.y+d[d.length-1]-e.y)*c);var f=j.binarySearch(d,b,3),g=d[f-2],h=d[f-1],i=d[f],k=1-(b-i)/(d[f+-3]-i);k=this.curves.getCurvePercent(f/3-1,k),e.x+=(e.data.x+g+(d[f+1]-g)*k-e.x)*c,e.y+=(e.data.y+h+(d[f+2]-h)*k-e.y)*c}}},j.ScaleTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=3*a},j.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.scaleX+=(e.data.scaleX-1+d[d.length-2]-e.scaleX)*c,void(e.scaleY+=(e.data.scaleY-1+d[d.length-1]-e.scaleY)*c);var f=j.binarySearch(d,b,3),g=d[f-2],h=d[f-1],i=d[f],k=1-(b-i)/(d[f+-3]-i);k=this.curves.getCurvePercent(f/3-1,k),e.scaleX+=(e.data.scaleX-1+g+(d[f+1]-g)*k-e.scaleX)*c,e.scaleY+=(e.data.scaleY-1+h+(d[f+2]-h)*k-e.scaleY)*c}}},j.ColorTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=5*a},j.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(c,d){c*=5,this.frames[c]=d,this.frames[c+1]=r,this.frames[c+2]=g,this.frames[c+3]=b,this.frames[c+4]=a},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.slots[this.slotIndex];if(b>=d[d.length-5]){var f=d.length-1;return e.r=d[f-3],e.g=d[f-2],e.b=d[f-1],void(e.a=d[f])}var g=j.binarySearch(d,b,5),h=d[g-4],i=d[g-3],k=d[g-2],l=d[g-1],m=d[g],n=1-(b-m)/(d[g-5]-m);n=this.curves.getCurvePercent(g/5-1,n);var o=h+(d[g+1]-h)*n,p=i+(d[g+2]-i)*n,q=k+(d[g+3]-k)*n,r=l+(d[g+4]-l)*n;1>c?(e.r+=(o-e.r)*c,e.g+=(p-e.g)*c,e.b+=(q-e.b)*c,e.a+=(r-e.a)*c):(e.r=o,e.g=p,e.b=q,e.a=r)}}},j.AttachmentTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},j.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b){var c=this.frames;if(!(b<c[0])){var d;d=b>=c[c.length-1]?c.length-1:j.binarySearch(c,b,1)-1;var e=this.attachmentNames[d];a.slots[this.slotIndex].setAttachment(e?a.getAttachmentBySlotIndex(this.slotIndex,e):null)}}},j.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},j.SkeletonData.prototype={defaultSkin:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},j.Skeleton=function(a){this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],e=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new j.Bone(d,e))}for(this.slots=[],this.drawOrder=[],b=0,c=a.slots.length;c>b;b++){var f=a.slots[b],g=this.bones[a.bones.indexOf(f.boneData)],h=new j.Slot(f,this,g);this.slots.push(h),this.drawOrder.push(h)}},j.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var a=this.flipX,b=this.flipY,c=this.bones,d=0,e=c.length;e>d;d++)c[d].updateWorldTransform(a,b)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose()},setSlotsToSetupPose:function(){for(var a=this.slots,b=0,c=a.length;c>b;b++)a[b].setToSetupPose(b)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){this.skin&&a&&a._attachAll(this,this.skin),this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.size;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachment(d,b),null==g))throw"Attachment not found: "+b+", for slot: "+a;return void f.setAttachment(g)}}throw"Slot not found: "+a},update:function(a){time+=a}},j.AttachmentType={region:0},j.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},j.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,e=c+this.regionWidth*a,f=d+this.regionHeight*b,g=this.rotation*Math.PI/180,h=Math.cos(g),i=Math.sin(g),j=c*h+this.x,k=c*i,l=d*h+this.y,m=d*i,n=e*h+this.x,o=e*i,p=f*h+this.y,q=f*i,r=this.offset;r[0]=j-m,r[1]=l+k,r[2]=j-q,r[3]=p+k,r[4]=n-q,r[5]=p+o,r[6]=n-m,r[7]=l+o},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},j.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={}},j.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=this.animationToMixTime[a.name+":"+b.name];return c?c:this.defaultMix}},j.AnimationState=function(a){this.data=a,this.queue=[]},j.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(a){if(this.currentTime+=a,this.previousTime+=a,this.mixTime+=a,this.queue.length>0){var b=this.queue[0];this.currentTime>=b.delay&&(this._setAnimation(b.animation,b.loop),this.queue.shift())}},apply:function(a){if(this.current)if(this.previous){this.previous.apply(a,this.previousTime,this.previousLoop);var b=this.mixTime/this.mixDuration;b>=1&&(b=1,this.previous=null),this.current.mix(a,this.currentTime,this.currentLoop,b)}else this.current.apply(a,this.currentTime,this.currentLoop)
},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(a,b){this.previous=null,a&&this.current&&(this.mixDuration=this.data.getMix(this.current,a),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=a,this.currentLoop=b,this.currentTime=0},setAnimationByName:function(a,b){var c=this.data.skeletonData.findAnimation(a);if(!c)throw"Animation not found: "+a;this.setAnimation(c,b)},setAnimation:function(a,b){this.queue.length=0,this._setAnimation(a,b)},addAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;this.addAnimation(d,b,c)},addAnimation:function(a,b,c){var d={};if(d.animation=a,d.loop=b,!c||0>=c){var e=this.queue.length?this.queue[this.queue.length-1].animation:this.current;c=null!=e?e.duration-this.data.getMix(e,a)+(c||0):0}d.delay=c,this.queue.push(d)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},j.SkeletonJson=function(a){this.attachmentLoader=a},j.SkeletonJson.prototype={scale:1,readSkeletonData:function(a){for(var b,c=new j.SkeletonData,d=a.bones,e=0,f=d.length;f>e;e++){var g=d[e],h=null;if(g.parent&&(h=c.findBone(g.parent),!h))throw"Parent bone not found: "+g.parent;b=new j.BoneData(g.name,h),b.length=(g.length||0)*this.scale,b.x=(g.x||0)*this.scale,b.y=(g.y||0)*this.scale,b.rotation=g.rotation||0,b.scaleX=g.scaleX||1,b.scaleY=g.scaleY||1,c.bones.push(b)}var i=a.slots;for(e=0,f=i.length;f>e;e++){var k=i[e];if(b=c.findBone(k.bone),!b)throw"Slot bone not found: "+k.bone;var l=new j.SlotData(k.name,b),m=k.color;m&&(l.r=j.SkeletonJson.toColor(m,0),l.g=j.SkeletonJson.toColor(m,1),l.b=j.SkeletonJson.toColor(m,2),l.a=j.SkeletonJson.toColor(m,3)),l.attachmentName=k.attachment,c.slots.push(l)}var n=a.skins;for(var o in n)if(n.hasOwnProperty(o)){var p=n[o],q=new j.Skin(o);for(var r in p)if(p.hasOwnProperty(r)){var s=c.findSlotIndex(r),t=p[r];for(var u in t)if(t.hasOwnProperty(u)){var v=this.readAttachment(q,u,t[u]);null!=v&&q.addAttachment(s,u,v)}}c.skins.push(q),"default"==q.name&&(c.defaultSkin=q)}var w=a.animations;for(var x in w)w.hasOwnProperty(x)&&this.readAnimation(x,w[x],c);return c},readAttachment:function(a,b,c){b=c.name||b;var d=j.AttachmentType[c.type||"region"];if(d==j.AttachmentType.region){var e=new j.RegionAttachment;return e.x=(c.x||0)*this.scale,e.y=(c.y||0)*this.scale,e.scaleX=c.scaleX||1,e.scaleY=c.scaleY||1,e.rotation=c.rotation||0,e.width=(c.width||32)*this.scale,e.height=(c.height||32)*this.scale,e.updateOffset(),e.rendererObject={},e.rendererObject.name=b,e.rendererObject.scale={},e.rendererObject.scale.x=e.scaleX,e.rendererObject.scale.y=e.scaleY,e.rendererObject.rotation=-e.rotation*Math.PI/180,e}throw"Unknown attachment type: "+d},readAnimation:function(a,b,c){var d,e,f,g,h,i,k,l=[],m=0,n=b.bones;for(var o in n)if(n.hasOwnProperty(o)){var p=c.findBoneIndex(o);if(-1==p)throw"Bone not found: "+o;var q=n[o];for(f in q)if(q.hasOwnProperty(f))if(h=q[f],"rotate"==f){for(e=new j.RotateTimeline(h.length),e.boneIndex=p,d=0,i=0,k=h.length;k>i;i++)g=h[i],e.setFrame(d,g.time,g.angle),j.SkeletonJson.readCurve(e,d,g),d++;l.push(e),m=Math.max(m,e.frames[2*e.getFrameCount()-2])}else{if("translate"!=f&&"scale"!=f)throw"Invalid timeline type for a bone: "+f+" ("+o+")";var r=1;for("scale"==f?e=new j.ScaleTimeline(h.length):(e=new j.TranslateTimeline(h.length),r=this.scale),e.boneIndex=p,d=0,i=0,k=h.length;k>i;i++){g=h[i];var s=(g.x||0)*r,t=(g.y||0)*r;e.setFrame(d,g.time,s,t),j.SkeletonJson.readCurve(e,d,g),d++}l.push(e),m=Math.max(m,e.frames[3*e.getFrameCount()-3])}}var u=b.slots;for(var v in u)if(u.hasOwnProperty(v)){var w=u[v],x=c.findSlotIndex(v);for(f in w)if(w.hasOwnProperty(f))if(h=w[f],"color"==f){for(e=new j.ColorTimeline(h.length),e.slotIndex=x,d=0,i=0,k=h.length;k>i;i++){g=h[i];var y=g.color,z=j.SkeletonJson.toColor(y,0),A=j.SkeletonJson.toColor(y,1),B=j.SkeletonJson.toColor(y,2),C=j.SkeletonJson.toColor(y,3);e.setFrame(d,g.time,z,A,B,C),j.SkeletonJson.readCurve(e,d,g),d++}l.push(e),m=Math.max(m,e.frames[5*e.getFrameCount()-5])}else{if("attachment"!=f)throw"Invalid timeline type for a slot: "+f+" ("+v+")";for(e=new j.AttachmentTimeline(h.length),e.slotIndex=x,d=0,i=0,k=h.length;k>i;i++)g=h[i],e.setFrame(d++,g.time,g.name);l.push(e),m=Math.max(m,e.frames[e.getFrameCount()-1])}}c.animations.push(new j.Animation(a,l,m))}},j.SkeletonJson.readCurve=function(a,b,c){var d=c.curve;d&&("stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]))},j.SkeletonJson.toColor=function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+a;return parseInt(a.substring(2*b,2),16)/255},j.Atlas=function(a,b){this.textureLoader=b,this.pages=[],this.regions=[];var c=new j.AtlasReader(a),d=[];d.length=4;for(var e=null;;){var f=c.readLine();if(null==f)break;if(f=c.trim(f),f.length)if(e){var g=new j.AtlasRegion;g.name=f,g.page=e,g.rotate="true"==c.readValue(),c.readTuple(d);var h=parseInt(d[0],10),i=parseInt(d[1],10);c.readTuple(d);var k=parseInt(d[0],10),l=parseInt(d[1],10);g.u=h/e.width,g.v=i/e.height,g.rotate?(g.u2=(h+l)/e.width,g.v2=(i+k)/e.height):(g.u2=(h+k)/e.width,g.v2=(i+l)/e.height),g.x=h,g.y=i,g.width=Math.abs(k),g.height=Math.abs(l),4==c.readTuple(d)&&(g.splits=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10)],4==c.readTuple(d)&&(g.pads=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10)],c.readTuple(d))),g.originalWidth=parseInt(d[0],10),g.originalHeight=parseInt(d[1],10),c.readTuple(d),g.offsetX=parseInt(d[0],10),g.offsetY=parseInt(d[1],10),g.index=parseInt(c.readValue(),10),this.regions.push(g)}else{e=new j.AtlasPage,e.name=f,e.format=j.Atlas.Format[c.readValue()],c.readTuple(d),e.minFilter=j.Atlas.TextureFilter[d[0]],e.magFilter=j.Atlas.TextureFilter[d[1]];var m=c.readValue();e.uWrap=j.Atlas.TextureWrap.clampToEdge,e.vWrap=j.Atlas.TextureWrap.clampToEdge,"x"==m?e.uWrap=j.Atlas.TextureWrap.repeat:"y"==m?e.vWrap=j.Atlas.TextureWrap.repeat:"xy"==m&&(e.uWrap=e.vWrap=j.Atlas.TextureWrap.repeat),b.load(e,f),this.pages.push(e)}else e=null}},j.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},j.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},j.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},j.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},j.AtlasPage=function(){},j.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},j.AtlasRegion=function(){},j.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},j.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)},j.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw"Invalid line: "+b;for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f){if(!d)throw"Invalid line: "+b;break}a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},j.AtlasAttachmentLoader=function(a){this.atlas=a},j.AtlasAttachmentLoader.prototype={newAttachment:function(a,b,c){switch(b){case j.AttachmentType.region:var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" ("+b+")";var e=new j.RegionAttachment(c);return e.rendererObject=d,e.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e}throw"Unknown attachment type: "+b}},j.Bone.yDown=!0,e.AnimCache={},e.Spine=function(a){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[a],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+a);this.skeleton=new j.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new j.AnimationStateData(this.spineData),this.state=new j.AnimationState(this.stateData),this.slotContainers=[];for(var b=0,c=this.skeleton.drawOrder.length;c>b;b++){var d=this.skeleton.drawOrder[b],f=d.attachment,g=new e.DisplayObjectContainer;if(this.slotContainers.push(g),this.addChild(g),f instanceof j.RegionAttachment){var h=f.rendererObject.name,i=this.createSprite(d,f.rendererObject);d.currentSprite=i,d.currentSpriteName=h,g.addChild(i)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var a=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(a),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var b=this.skeleton.drawOrder,c=0,d=b.length;d>c;c++){var f=b[c],g=f.attachment,h=this.slotContainers[c];if(g instanceof j.RegionAttachment){if(g.rendererObject&&(!f.currentSpriteName||f.currentSpriteName!=g.name)){var i=g.rendererObject.name;if(void 0!==f.currentSprite&&(f.currentSprite.visible=!1),f.sprites=f.sprites||{},void 0!==f.sprites[i])f.sprites[i].visible=!0;else{var k=this.createSprite(f,g.rendererObject);h.addChild(k)}f.currentSprite=f.sprites[i],f.currentSpriteName=i}h.visible=!0;var l=f.bone;h.position.x=l.worldX+g.x*l.m00+g.y*l.m01,h.position.y=l.worldY+g.x*l.m10+g.y*l.m11,h.scale.x=l.worldScaleX,h.scale.y=l.worldScaleY,h.rotation=-(f.bone.worldRotation*Math.PI/180)}else h.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.Spine.prototype.createSprite=function(a,b){var c=e.TextureCache[b.name]?b.name:b.name+".png",d=new e.Sprite(e.Texture.fromFrame(c));return d.scale=b.scale,d.rotation=b.rotation,d.anchor.x=d.anchor.y=.5,a.sprites=a.sprites||{},a.sprites[b.name]=d,d},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTexture=function(a,b){if(e.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=b||e.BaseTexture.SCALE_MODE.DEFAULT,this.hasLoaded=!1,this.source=a,a){if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var c=this;this.source.onload=function(){c.hasLoaded=!0,c.width=c.source.width,c.height=c.source.height,e.texturesToUpdate.push(c),c.dispatchEvent({type:"loaded",content:c})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);this.imageUrl=null,this._powerOf2=!1,this._glTextures=[]}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.imageUrl in e.BaseTextureCache&&delete e.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null),this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(a){this.hasLoaded=!1,this.source.src=null,this.source.src=a},e.BaseTexture.fromImage=function(a,b,c){var d=e.BaseTextureCache[a];if(!d){var f=new Image;b&&(f.crossOrigin=""),f.src=a,d=new e.BaseTexture(f,c),d.imageUrl=a,e.BaseTextureCache[a]=d}return d},e.BaseTexture.SCALE_MODE={DEFAULT:0,LINEAR:0,NEAREST:1},e.TextureCache={},e.FrameCache={},e.Texture=function(a,b){if(e.EventTarget.call(this),b||(this.noFrame=!0,b=new e.Rectangle(0,0,1,1)),a instanceof e.Texture&&(a=a.baseTexture),this.baseTexture=a,this.frame=b,this.trim=new e.Point,this.scope=this,a.hasLoaded)this.noFrame&&(b=new e.Rectangle(0,0,a.width,a.height)),this.setFrame(b);else{var c=this;a.addEventListener("loaded",function(){c.onBaseTextureLoaded()})}},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;a.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,a.width,a.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(a){a&&this.baseTexture.destroy()},e.Texture.prototype.setFrame=function(a){if(this.frame=a,this.width=a.width,this.height=a.height,a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new Float32Array(8));var a=this.frame,b=this.baseTexture.width,c=this.baseTexture.height;this._uvs[0]=a.x/b,this._uvs[1]=a.y/c,this._uvs[2]=(a.x+a.width)/b,this._uvs[3]=a.y/c,this._uvs[4]=(a.x+a.width)/b,this._uvs[5]=(a.y+a.height)/c,this._uvs[6]=a.x/b,this._uvs[7]=(a.y+a.height)/c},e.Texture.fromImage=function(a,b,c){var d=e.TextureCache[a];return d||(d=new e.Texture(e.BaseTexture.fromImage(a,b,c)),e.TextureCache[a]=d),d},e.Texture.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache ');return b},e.Texture.fromCanvas=function(a,b){var c=new e.BaseTexture(a,b);return new e.Texture(c)},e.Texture.addTextureToCache=function(a,b){e.TextureCache[b]=a},e.Texture.removeTextureFromCache=function(a){var b=e.TextureCache[a];return e.TextureCache[a]=null,b},e.Texture.frameUpdates=[],e.Texture.SCALE_MODE=e.BaseTexture.SCALE_MODE,e.RenderTexture=function(a,b,c){if(e.EventTarget.call(this),this.width=a||100,this.height=b||100,this.indetityMatrix=e.mat3.create(),this.frame=new e.Rectangle(0,0,this.width,this.height),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.hasLoaded=!0,this.renderer=c||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var d=this.renderer.gl;this.textureBuffer=new e.FilterTexture(d,this.width,this.height),this.baseTexture._glTextures[d.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(a,b){if(this.width=a,this.height=b,this.frame.width=this.width,this.frame.height=this.height,this.renderer.type===e.WEBGL_RENDERER){this.projection.x=this.width/2,this.projection.y=-this.height/2;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.baseTexture._glTextures[c.id]),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.width,this.height,0,c.RGBA,c.UNSIGNED_BYTE,null)}else this.textureBuffer.resize(this.width,this.height);e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype.renderWebGL=function(a,b,c){var d=this.renderer.gl;d.colorMask(!0,!0,!0,!0),d.viewport(0,0,this.width,this.height),d.bindFramebuffer(d.FRAMEBUFFER,this.textureBuffer.frameBuffer),c&&this.textureBuffer.clear();var f=a.children,g=a.worldTransform;a.worldTransform=e.mat3.create(),a.worldTransform[4]=-1,a.worldTransform[5]=-2*this.projection.y,b&&(a.worldTransform[2]=b.x,a.worldTransform[5]-=b.y);for(var h=0,i=f.length;i>h;h++)f[h].updateTransform();this.renderer.renderDisplayObject(a,this.projection),a.worldTransform=g},e.RenderTexture.prototype.renderCanvas=function(a,b,c){var d=a.children;a.worldTransform=e.mat3.create(),b&&(a.worldTransform[2]=b.x,a.worldTransform[5]=b.y);for(var f=0,g=d.length;g>f;f++)d[f].updateTransform();c&&this.textureBuffer.clear();var h=this.textureBuffer.context;this.renderer.renderDisplayObject(a,h),h.setTransform(1,0,0,1,0,0)},e.AssetLoader=function(a,b){e.EventTarget.call(this),this.assetURLs=a,this.crossorigin=b,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(a){var b="data:",c=a.slice(0,b.length).toLowerCase();if(c===b){var d=a.slice(b.length),e=d.indexOf(",");if(-1===e)return null;var f=d.slice(0,e).split(";")[0];return f&&"text/plain"!==f.toLowerCase()?f.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function a(){b.onAssetLoaded()}var b=this;this.loadCount=this.assetURLs.length;for(var c=0;c<this.assetURLs.length;c++){var d=this.assetURLs[c],e=this._getDataType(d);e||(e=d.split("?").shift().split(".").pop().toLowerCase());var f=this.loadersByType[e];if(!f)throw new Error(e+" is an unsupported file type");var g=new f(d,this.crossorigin);g.addEventListener("loaded",a),g.load()}},e.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest;var a=this;this.ajaxRequest.onreadystatechange=function(){a.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.JsonLoader.prototype.onJSONLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var a=this,b=this.baseUrl+this.json.meta.image,c=new e.ImageLoader(b,this.crossorigin),d=this.json.frames;this.texture=c.texture.baseTexture,c.addEventListener("loaded",function(){a.onLoaded()});for(var f in d){var g=d[f].frame;if(g&&(e.TextureCache[f]=new e.Texture(this.texture,{x:g.x,y:g.y,width:g.w,height:g.h}),d[f].trimmed)){var h=e.TextureCache[f];h.trimmed=!0;var i=d[f].sourceSize,k=d[f].spriteSourceSize;h.trim.x=k.x,h.trim.y=k.y,h.trim.realWidth=i.w,h.trim.realHeight=i.h}}c.load()}else if(this.json.bones){var l=new j.SkeletonJson,m=l.readSkeletonData(this.json);e.AnimCache[this.url]=m,this.onLoaded()}else this.onLoaded();else this.onError()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.crossorigin=b,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var a=this.ajaxRequest.responseText.split(/\r?\n/),b=-3,c=0,d=null,f=!1,g=0,h=0,i=this.onLoaded.bind(this);for(g=0;g<a.length;g++)if(a[g]=a[g].replace(/^\s+|\s+$/g,""),""===a[g]&&(f=g+1),a[g].length>0){if(f===g)this.atlas.meta.image.push(a[g]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),b=-3;else if(b>0)if(b%7===1)null!=d&&(this.atlas.frames[c][d.name]=d),d={name:a[g],frame:{}};else{var j=a[g].split(" ");if(b%7===3)d.frame.x=Number(j[1].replace(",","")),d.frame.y=Number(j[2]);else if(b%7===4)d.frame.w=Number(j[1].replace(",","")),d.frame.h=Number(j[2]);else if(b%7===5){var k={x:0,y:0,w:Number(j[1].replace(",","")),h:Number(j[2])};k.w>d.frame.w||k.h>d.frame.h?(d.trimmed=!0,d.realSize=k):d.trimmed=!1}}b++}if(null!=d&&(this.atlas.frames[c][d.name]=d),this.atlas.meta.image.length>0){for(this.images=[],h=0;h<this.atlas.meta.image.length;h++){var l=this.baseUrl+this.atlas.meta.image[h],m=this.atlas.frames[h];this.images.push(new e.ImageLoader(l,this.crossorigin));for(g in m){var n=m[g].frame;n&&(e.TextureCache[g]=new e.Texture(this.images[h].texture.baseTexture,{x:n.x,y:n.y,width:n.w,height:n.h}),m[g].trimmed&&(e.TextureCache[g].realSize=m[g].realSize,e.TextureCache[g].trim.x=0,e.TextureCache[g].trim.y=0))}}for(this.currentImageId=0,h=0;h<this.images.length;h++)this.images[h].addEventListener("loaded",i);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onLoaded()}),b.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(a,b){e.EventTarget.call(this),this.texture=e.Texture.fromImage(a,b),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var a=this;this.texture.baseTexture.addEventListener("loaded",function(){a.onLoaded()})}},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(a,b,c){this.frames=[];for(var d=Math.floor(this.texture.width/a),f=Math.floor(this.texture.height/b),g=0,h=0;f>h;h++)for(var i=0;d>i;i++,g++){var j=new e.Texture(this.texture,{x:i*a,y:h*b,width:a,height:b});this.frames.push(j),c&&(e.TextureCache[c+"-"+g]=j)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var k=this;this.texture.baseTexture.addEventListener("loaded",function(){k.onLoaded()})}},e.BitmapFontLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var a=this;this.ajaxRequest.onreadystatechange=function(){a.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var a=this.ajaxRequest.responseXML;if(!a||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var b=new DOMParser;a=b.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var c=document.createElement("div");c.innerHTML=this.ajaxRequest.responseText,a=c}var d=this.baseUrl+a.getElementsByTagName("page")[0].getAttribute("file"),f=new e.ImageLoader(d,this.crossorigin);this.texture=f.texture.baseTexture;var g={},h=a.getElementsByTagName("info")[0],i=a.getElementsByTagName("common")[0];g.font=h.getAttribute("face"),g.size=parseInt(h.getAttribute("size"),10),g.lineHeight=parseInt(i.getAttribute("lineHeight"),10),g.chars={};for(var j=a.getElementsByTagName("char"),k=0;k<j.length;k++){var l=parseInt(j[k].getAttribute("id"),10),m=new e.Rectangle(parseInt(j[k].getAttribute("x"),10),parseInt(j[k].getAttribute("y"),10),parseInt(j[k].getAttribute("width"),10),parseInt(j[k].getAttribute("height"),10));g.chars[l]={xOffset:parseInt(j[k].getAttribute("xoffset"),10),yOffset:parseInt(j[k].getAttribute("yoffset"),10),xAdvance:parseInt(j[k].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[l]=new e.Texture(this.texture,m)}}var n=a.getElementsByTagName("kerning");for(k=0;k<n.length;k++){var o=parseInt(n[k].getAttribute("first"),10),p=parseInt(n[k].getAttribute("second"),10),q=parseInt(n[k].getAttribute("amount"),10);g.chars[p].kerning[o]=q}e.BitmapText.fonts[g.font]=g;var r=this;f.addEventListener("loaded",function(){r.onLoaded()}),f.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onLoaded()}),b.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(a,b){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=b||{},this.fragmentSrc=a||[]},e.AlphaMaskFilter=function(a){e.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:a},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mask.value.x=a.width,this.uniforms.mask.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(a){this.uniforms.mask.value=a}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(a){this.uniforms.matrix.value=a}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(a){this.uniforms.gray.value=a}}),e.DisplacementFilter=function(a){e.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:a},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=a.width,this.uniforms.mapDimensions.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(a){this.uniforms.displacementMap.value=a}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]
},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.dirty=!0,this.uniforms.pixelSize.value=a}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.dirty=!0,this.uniforms.blur.value=1/7e3*a}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(a){this.uniforms.invert.value=a}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(a){this.uniforms.sepia.value=a}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.dirty=!0,this.uniforms.offset.value=a}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(a){this.dirty=!0,this.uniforms.radius.value=a}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(a){this.uniforms.step.value=a}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.DotScreenFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):"undefined"!=typeof define&&define.amd?define(e):d.PIXI=e}).call(this);var GoodBoySplash=function(){function a(a){assetLoader=new PIXI.AssetLoader(l,!0),assetLoader.onComplete=a,assetLoader.load()}function b(){f=document.createElement("canvas"),g=new PIXI.Stage(2435146,!0),h=PIXI.autoDetectRenderer(j,k),document.body.appendChild(h.view),a(function(){var a=0;i=setInterval(function(){a++,a===l.length&&(a=0),g.stage.children=[];var b=SpritePool.getInstance().get(l[a]);b.anchor.x=.5,b.anchor.y=.5,b.position.x=.5*j,b.position.y=.5*k,b.scale.set(1),g.addChild(b),h.render(g)},200)})}function c(){clearInterval(i);for(var a=1;100>=a;a++)setTimeout(function(a){return function(){d(100-a)}}(a),10*a)}function d(a){h.view.style.opacity=a,0===a&&document.body.removeChild(h.view)}function e(a,b){j=a,k=b,h.view.style.width=j+"px",h.view.style.height=k+"px",h.resize(j,k)}var f=!1,g=!1,h=!1,i=!1,j=0,k=0,l=["img/loading_01.png","img/loading_02.png","img/loading_03.png","img/loading_04.png","img/goodboy_logo.png"];return{resize:e,init:b,hide:c}}();SpritePool._isBirth=!1,SpritePool.getInstance=function(){return null!=SpritePool._instance?SpritePool._instance:new SpritePool};var Fido=Fido||{};Fido.Device=function(){this.arora=!1,this.chrome=!1,this.epiphany=!1,this.firefox=!1,this.mobileSafari=!1,this.ie=!1,this.ieVersion=0,this.midori=!1,this.opera=!1,this.safari=!1,this.webApp=!1,this.cocoonJS=!1,this.android=!1,this.chromeOS=!1,this.iOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.desktop=!1,this.pixelRatio=0,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.blob=!1,this.canvas=!1,this.localStorage=!1,this.file=!1,this.fileSystem=!1,this.webGL=!1,this.worker=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1;var a=navigator.userAgent;this._checkBrowser(a),this._checkOS(a),this._checkDevice(a),this._checkAudio(),this._checkFeatures()},Fido.Device.prototype._checkBrowser=function(a){/Arora/.test(a)?this.arora=!0:/Chrome/.test(a)?this.chrome=!0:/Epiphany/.test(a)?this.epiphany=!0:/Firefox/.test(a)?this.firefox=!0:/Mobile Safari/.test(a)?this.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(a)?(this.ie=!0,this.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(a)?this.midori=!0:/Opera/.test(a)?this.opera=!0:/Safari/.test(a)&&(this.safari=!0),navigator.standalone&&(this.webApp=!0),navigator.isCocoonJS&&(this.cocoonJS=!0)},Fido.Device.prototype._checkOS=function(a){/Android/.test(a)?this.android=!0:/CrOS/.test(a)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(a)?this.iOS=!0:/Linux/.test(a)?this.linux=!0:/Mac OS/.test(a)?this.macOS=!0:/Windows/.test(a)&&(this.windows=!0),(this.windows||this.macOS||this.linux)&&(this.desktop=!0)},Fido.Device.prototype._checkDevice=function(){this.pixelRatio=window.devicePixelRatio||1,this.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone"),this.iPhone4=2===this.pixelRatio&&this.iPhone,this.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad")},Fido.Device.prototype._checkFeatures=function(){"undefined"!=typeof window.Blob&&(this.blob=!0),this.canvas=!!window.CanvasRenderingContext2D;try{this.localStorage=!!localStorage.getItem}catch(a){this.localStorage=!1}this.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),this.fileSystem=!!window.requestFileSystem,this.webGL=!!window.WebGLRenderingContext,this.worker=!!window.Worker,("ontouchstart"in document.documentElement||window.navigator.msPointerEnabled)&&(this.touch=!0)},Fido.Device.prototype._checkAudio=function(){this.audioData=!!window.Audio,this.webaudio=!(!window.webkitAudioContext&&!window.AudioContext);var a=document.createElement("audio"),b=!1;try{(b=!!a.canPlayType)&&(a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.ogg=!0),a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.mp3=!0),a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.wav=!0),(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))&&(this.m4a=!0))}catch(c){}},Fido.Device.prototype.getInfo=function(){var a="DEVICE OUTPUT\n\n";return a+="---\n",a+="Browser Info :: \n",a+="Arora : "+this.arora+"\n",a+="Chrome : "+this.chrome+"\n",a+="Epiphany : "+this.epiphany+"\n",a+="Firefox : "+this.firefox+"\n",a+="Mobile Safari : "+this.mobileSafari+"\n",a+="IE : "+this.ie,a+=this.ie?" (Version "+this.ieVersion+")\n":"\n",a+="Midori : "+this.midori+"\n",a+="Opera : "+this.opera+"\n",a+="Safari : "+this.safari+"\n",a+="Web App : "+this.webApp+"\n",a+="CocoonJS : "+this.cocoonJS+"\n",a+="Android : "+this.android+"\n",a+="---\n",a+="Operating System :: \n",a+="Chrome OS : "+this.chromeOS+"\n",a+="iOS : "+this.iOS+"\n",a+="Linux : "+this.linux+"\n",a+="Mac OS : "+this.macOS+"\n",a+="Windows : "+this.windows+"\n",a+="Desktop : "+this.desktop+"\n",a+="---\n",a+="Device Type : \n",a+="Pixel Ratio : "+this.pixelRatio+"\n",a+="iPhone : "+this.iPhone+"\n",a+="iPhone 4 : "+this.iPhone4+"\n",a+="iPad : "+this.iPad+"\n",a+="---\n",a+="Features :: \n",a+="Blob : "+this.blob+"\n",a+="Canvas : "+this.canvas+"\n",a+="LocalStorage : "+this.localStorage+"\n",a+="File : "+this.file+"\n",a+="File System : "+this.fileSystem+"\n",a+="WebGL : "+this.webGL+"\n",a+="Workers : "+this.worker+"\n",a+="---\n",a+="Audio :: \n",a+="AudioData : "+this.audioData+"\n",a+="WebAudio : "+this.webAudio+"\n",a+="Supports .ogg : "+this.ogg+"\n",a+="Supports Opus : "+this.opus+"\n",a+="Supports .mp3 : "+this.mp3+"\n",a+="Supports .wav : "+this.wav+"\n",a+="Supports .m4a : "+this.m4a+"\n",a+="Supports .webm : "+this.webm};var Fido=Fido||{};Fido.LocalStorage=function(a){this.id=a},Fido.LocalStorage.prototype.store=function(a,b){localStorage.setItem(this.id+"."+a,b)},Fido.LocalStorage.prototype.get=function(a){return localStorage.getItem(this.id+"."+a)||0},Fido.LocalStorage.prototype.remove=function(a){localStorage.removeItem(this.id+"."+a)},Fido.LocalStorage.prototype.reset=function(){for(var a in localStorage)-1!==a.indexOf(this.id+".")&&localStorage.removeItem(a)};var FidoAudio=function(){function a(){if(p.cocoonJS===!0)for(var a=0;a<r.length;a++){var b=r[a];switch(b.type){case"music":CocoonJS.App.markAsMusic(b.src);var c=document.createElement("audio");c.src=b.src,c.loop=b.loop,b.audio=(new CocoonJS.Music).setAudio(c),b.audio.volume(b.volume),m[b.name]=b,b.autoPlay===!0&&m[b.name].audio.play();break;case"sfx":var d=new Audio;d.src=b.src,b.audio=(new CocoonJS.Audio).setAudio(d),b.audio.volume(b.volume),m[b.name]=b}}else for(var a=0;a<r.length;a++){var b=r[a];b.audio=new Howl({urls:[b.src],autoplay:b.autoPlay,loop:b.loop,volume:b.volume}),m[b.name]=b}"true"===q.get("gameMuted")&&FidoAudio.muteAll()}function b(){return o}function c(){if(o=!0,q.store("gameMuted",!0),p.cocoonJS===!0){var a=!1;for(a in m){var b=m[a],c={volume:b.audio.getVolume()};d(b,c)}}else{var e={volume:1};TweenLite.to(e,1,{volume:0,onUpdate:function(){Howler.volume(this.target.volume)},onComplete:function(){Howler.mute()}})}}function d(a,b){TweenLite.to(b,1,{volume:0,onUpdate:function(){a.audio.volume(this.target.volume)}})}function e(a,b){TweenLite.to(b,1,{volume:a.volume,onUpdate:function(){a.audio.volume(this.target.volume)}})}function f(){if(o=!1,q.store("gameMuted",!1),p.cocoonJS===!0){var a=!1;for(a in m){var b=m[a];e(b,{volume:0})}}else{var c={volume:0};Howler.unmute(),TweenLite.to(c,1,{volume:1,onUpdate:function(){Howler.volume(this.target.volume)}})}}function g(a){m.hasOwnProperty(a)?m[a].audio.play():console.log("WARNING :: Couldn't find sound '"+a+"'.")}function h(a){var b=m[a],c={volume:0};d(b,c)}function i(a,b){if(j(a)){var c=m[a],d=b||n,e={volume:0};TweenLite.to(e,d,{volume:c.maxVolume,onUpdate:function(){k(a,this.target.volume)}})}}function j(a){return m.hasOwnProperty(a)}function k(a,b){j(a)&&(o===!0?m[a].volume=b:m[a].audio.volume(b))}function l(a){m[a].audio.stop()}var m={},n=1,o=!1,p=new Fido.Device,q=new Fido.LocalStorage,r=[{src:"audio/mainLoop.ogg",volume:.6,maxVolume:.6,loop:!0,autoPlay:!1,type:"music",name:"gameMusic"},{src:"audio/footLoopRegular.ogg",volume:0,maxVolume:.6,loop:!0,autoPlay:!1,type:"music",name:"runRegular"},{src:"audio/footLoopFast.ogg",volume:0,maxVolume:.6,loop:!0,autoPlay:!1,type:"music",name:"runFast"},{src:"audio/thrustLoop.ogg",volume:0,maxVolume:.4,loop:!0,autoPlay:!0,type:"music",name:"thrusters"},{src:"audio/pickupGrab.ogg",volume:.5,maxVolume:.5,loop:!1,autoPlay:!1,type:"sfx",name:"pickup"},{src:"audio/blockHit.ogg",volume:.2,maxVolume:.2,loop:!1,autoPlay:!1,type:"sfx",name:"blockHit"},{src:"audio/lavaSplosh.ogg",volume:.5,maxVolume:.5,loop:!1,autoPlay:!1,type:"sfx",name:"lavaSplosh"},{src:"audio/fallThud.ogg",volume:1,maxVolume:1,loop:!1,autoPlay:!1,type:"sfx",name:"thudBounce"},{src:"audio/DeathJingle.ogg",volume:.7,maxVolume:.7,loop:!1,autoPlay:!1,type:"sfx",name:"deathJingle"},{src:"audio/hyperMode.ogg",volume:.2,maxVolume:.2,loop:!1,autoPlay:!1,type:"sfx",name:"hyperMode"}];return{init:a,play:g,stop:l,fadeOut:h,fadeIn:i,setVolume:k,muteAll:c,unMuteAll:f,isMuted:b}}();!function(){CocoonJS=window.CocoonJS?window.CocoonJS:{},CocoonJS.nativeExtensionObjectAvailable="undefined"!=typeof window.ext,CocoonJS.Size={width:0,height:0},CocoonJS.extend=function(a,b){var c=a.prototype,d=function(){};d.prototype=b.prototype,a.prototype=new d,a.superclass=b.prototype,a.prototype.constructor=a,b.prototype.constructor===Object.prototype.constructor&&(b.prototype.constructor=b);for(var e in c)c.hasOwnProperty(e)&&(a.prototype[e]=c[e])},CocoonJS.makeNativeExtensionObjectFunctionCall=function(a,b,c,d){if(CocoonJS.nativeExtensionObjectAvailable){var e=Array.prototype.slice.call(c);e.unshift(b);var f=ext[a],g=d?f.makeCallAsync:f.makeCall,h=g.apply(f,e),i=h;if("string"==typeof h)try{i=JSON.parse(h)}catch(j){}return i}},CocoonJS.getObjectFromPath=function(a,b){for(var c=b.split("."),d=a,e=0,f=c.length;f>e;++e)d[c[e]]=d[c[e]]||void 0,d=d[c[e]];return d},CocoonJS.getKeyForValueInDictionary=function(a,b){var c=null;for(var d in a)if(a[d]===b){c=d;break}return c},CocoonJS.findStringInStringArrayThatIsIndexOf=function(a,b,c){var d=null;b=c?b:b.toUpperCase();for(var e=0;null==d&&e<a.length;e++)d=c?a[e]:a[e].toUpperCase(),d=d.indexOf(b)>=0?a[e]:null;return d},CocoonJS.EventHandler=function(a,b,c,d){return this.listeners=[],this.listenersOnce=[],this.chainFunction=d,this.addEventListener=function(e){if(d){var f=function(){d.call(this,arguments.callee.sourceListener,Array.prototype.slice.call(arguments))};e.CocoonJSEventHandlerChainFunction=f,f.sourceListener=e,e=f}var g=CocoonJS.getObjectFromPath(CocoonJS,b);if(g&&g.nativeExtensionObjectAvailable)ext[a].addEventListener(c,e);else{var h=this.listeners.indexOf(e);0>h&&this.listeners.push(e)}},this.addEventListenerOnce=function(e){if(d){var f=function(){d(arguments.callee.sourceListener,Array.prototype.slice.call(arguments))};f.sourceListener=e,e=f}var g=CocoonJS.getObjectFromPath(CocoonJS,b);if(g.nativeExtensionObjectAvailable)ext[a].addEventListenerOnce(c,e);else{var h=this.listeners.indexOf(e);0>h&&this.listenersOnce.push(e)}},this.removeEventListener=function(e){d&&(e=e.CocoonJSEventHandlerChainFunction,delete e.CocoonJSEventHandlerChainFunction);var f=CocoonJS.getObjectFromPath(CocoonJS,b);if(f.nativeExtensionObjectAvailable)ext[a].removeEventListener(c,e);else{var g=this.listeners.indexOf(e);g>=0&&this.listeners.splice(g,1)}},this.notifyEventListeners=function(){var d=CocoonJS.getObjectFromPath(CocoonJS,b);if(d&&d.nativeExtensionObjectAvailable)ext[a].notifyEventListeners(c);else{var e=Array.prototype.slice.call(arguments),f=Array.prototype.slice.call(this.listeners),g=Array.prototype.slice.call(this.listenersOnce),h=this;setTimeout(function(){for(var a=0;a<f.length;a++)f[a].apply(h,e);for(var a=0;a<g.length;a++)g[a].apply(h,e)},0),h.listenersOnce=[]}},this},CocoonJS.Timer=function(){return this.reset(),this},CocoonJS.Timer.prototype={currentTimeInMillis:0,lastTimeInMillis:0,elapsedTimeInMillis:0,elapsedTimeInSeconds:0,accumTimeInMillis:0,reset:function(){this.currentTimeInMillis=this.lastTimeInMillis=(new Date).getTime(),this.accumTimeInMillis=this.elapsedTimeInMillis=this.elapsedTimeInSeconds=0},update:function(){this.currentTimeInMillis=(new Date).getTime(),this.elapsedTimeInMillis=this.currentTimeInMillis-this.lastTimeInMillis,this.elapsedTimeInSeconds=this.elapsedTimeInMillis/1e3,this.lastTimeInMillis=this.currentTimeInMillis,this.accumTimeInMillis+=this.elapsedTimeInMillis}}}(),function(){if("undefined"==typeof window.CocoonJS||null===window.CocoonJS)throw"The CocoonJS object must exist and be valid before creating any extension object.";CocoonJS.App=CocoonJS.App?CocoonJS.App:{},CocoonJS.App.nativeExtensionObjectAvailable=CocoonJS.nativeExtensionObjectAvailable&&"undefined"!=typeof window.ext.IDTK_APP,CocoonJS.App.FPSLayout={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right"},CocoonJS.App.KeyboardType={TEXT:"text",NUMBER:"num",PHONE:"phone",EMAIL:"email",URL:"url"},CocoonJS.App.StorageType={APP_STORAGE:"APP_STORAGE",INTERNAL_STORAGE:"INTERNAL_STORAGE",EXTERNAL_STORAGE:"EXTERNAL_STORAGE",TEMPORARY_STORAGE:"TEMPORARY_STORAGE"},CocoonJS.App.CaptureType={EVERYTHING:0,JUST_COCOONJS_GL_SURFACE:1,JUST_SYSTEM_VIEWS:2},CocoonJS.App.forward=function(a){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","forward",arguments):navigator.isCocoonJS?void 0:"CocoonJS_App_ForCocoonJS_WebViewIFrame"==window.name?window.parent.eval(a):window.frames.CocoonJS_App_ForCocoonJS_WebViewIFrame.window.eval(a)},CocoonJS.App.forwardAsync=function(a,b){return CocoonJS.App.nativeExtensionObjectAvailable?"undefined"!=typeof b?ext.IDTK_APP.makeCallAsync("forward",a,b):ext.IDTK_APP.makeCallAsync("forward",a):navigator.isCocoonJS?void 0:"CocoonJS_App_ForCocoonJS_WebViewIFrame"==window.name?window.parent.eval(a):window.parent.frames.CocoonJS_App_ForCocoonJS_WebViewIFrame.window.eval(a)},CocoonJS.App.showTextDialog=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable)return CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","showTextDialog",arguments,!0);if(!navigator.isCocoonJS){b||(b=""),c||(c="");var d=prompt(b,c),e=d?CocoonJS.App.onTextDialogFinished:CocoonJS.App.onTextDialogCancelled;e.notifyEventListeners(d)}},CocoonJS.App.showMessageBox=function(a,b){if(CocoonJS.App.nativeExtensionObjectAvailable)return CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","showMessageBox",arguments,!0);if(!navigator.isCocoonJS){b||(b="");var c=confirm(b),d=c?CocoonJS.App.onMessageBoxConfirmed:CocoonJS.App.onMessageBoxDenied;d.notifyEventListeners()}},CocoonJS.App.load=function(a){if(CocoonJS.App.nativeExtensionObjectAvailable)return CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","loadPath",arguments);if(!navigator.isCocoonJS){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState)if(200===b.status){var c;c=CocoonJS.App.EmulatedWebViewIFrame?"CocoonJS.App.onLoadInCocoonJSSucceed.notifyEventListeners('"+a+"');":"CocoonJS.App.onLoadInTheWebViewSucceed.notifyEventListeners('"+a+"');",CocoonJS.App.forwardAsync(c),window.location.href=a}else if(404===b.status){this.onreadystatechange=null;var c;c=CocoonJS.App.EmulatedWebViewIFrame?"CocoonJS.App.onLoadInCocoonJSFailed.notifyEventListeners('"+a+"');":"CocoonJS.App.onLoadInTheWebViewFailed.notifyEventListeners('"+a+"');",CocoonJS.App.forwardAsync(c)}},b.open("GET",a,!0),b.send()}},CocoonJS.App.reload=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","reload",arguments):navigator.isCocoonJS?void 0:"CocoonJS_App_ForCocoonJS_WebViewIFrame"==window.name?window.parent.location.reload():window.parent.frames.CocoonJS_App_ForCocoonJS_WebViewIFrame.window.location.reload()},CocoonJS.App.openURL=function(a){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","openURL",arguments,!0):void(navigator.isCocoonJS||window.open(a,"_blank"))},CocoonJS.App.forceToFinish=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","forceToFinish",arguments):void(navigator.isCocoonJS||window.close())},CocoonJS.App.setAutoLockEnabled=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","setAutoLockEnabled",arguments):void 0},CocoonJS.App.createScreenCanvas=function(){var a;return navigator.isCocoonJS?a=document.createElement("screencanvas"):navigator.isCocoonJS||(a=document.createElement("canvas"),a.width=window.innerWidth,a.height=window.innerHeight),a},CocoonJS.App.disableTouchInCocoonJS=function(){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCall("disableTouchLayer","CocoonJSView")},CocoonJS.App.enableTouchInCocoonJS=function(){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCall("enableTouchLayer","CocoonJSView")},CocoonJS.App.disableTouchInTheWebView=function(){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCall("disableTouchLayer","WebView")},CocoonJS.App.enableTouchInTheWebView=function(){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCall("enableTouchLayer","WebView")},CocoonJS.App.setAccelerometerUpdateIntervalInSeconds=function(a){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("setAccelerometerUpdateIntervalInSeconds",a):void 0},CocoonJS.App.getAccelerometerUpdateIntervalInSeconds=function(){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("getAccelerometerUpdateIntervalInSeconds"):void 0},CocoonJS.App.setGyroscopeUpdateIntervalInSeconds=function(a){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("setGyroscopeUpdateIntervalInSeconds",a):void 0},CocoonJS.App.getGyroscopeUpdateIntervalInSeconds=function(){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCall("getGyroscopeUpdateIntervalInSeconds")},CocoonJS.App.setupOriginProxyType=function(a,b,c,d){if(CocoonJS.App.nativeExtensionObjectAvailable){if(!a)throw"The given typeName must be valid.";if(!b&&!c&&!d)throw"There is no point on setting up a proxy for no attributes, functions nor eventHandlers.";b=b?b:[],c=c?c:[],d=d?d:[];var e=window,f="CocoonJS.App.setupDestinationProxyType("+JSON.stringify(a)+", "+JSON.stringify(d)+");";CocoonJS.App.forward(f);var g=e[a];e[a]=function(){var f=this;this._cocoonjs_proxy_object_data={};var g="CocoonJS.App.newDestinationProxyObject("+JSON.stringify(a)+");";this._cocoonjs_proxy_object_data.id=CocoonJS.App.forward(g),this._cocoonjs_proxy_object_data.eventHandlers={},this._cocoonjs_proxy_object_data.typeName=a,this._cocoonjs_proxy_object_data.eventListeners={},e[a]._cocoonjs_proxy_type_data.proxyObjects[this._cocoonjs_proxy_object_data.id]=this;for(var h=0;h<b.length;h++)!function(b){f.__defineSetter__(b,function(c){var d="CocoonJS.App.setDestinationProxyObjectAttribute("+JSON.stringify(a)+", "+f._cocoonjs_proxy_object_data.id+", "+JSON.stringify(b)+", "+JSON.stringify(c)+");";return CocoonJS.App.forwardAsync(d)}),f.__defineGetter__(b,function(){var c="CocoonJS.App.getDestinationProxyObjectAttribute("+JSON.stringify(a)+", "+f._cocoonjs_proxy_object_data.id+", "+JSON.stringify(b)+");";return CocoonJS.App.forwardAsync(c)})}(b[h]);for(var h=0;h<c.length;h++)!function(b){f[b]=function(){var c=Array.prototype.slice.call(arguments);c.unshift(b),c.unshift(this._cocoonjs_proxy_object_data.id),c.unshift(a);for(var d="CocoonJS.App.callDestinationProxyObjectFunction(",e=0;e<c.length;e++)d+=(1!==e?JSON.stringify(c[e]):c[e])+(e<c.length-1?", ":"");d+=");";var f=CocoonJS.App.forwardAsync(d);return f}}(c[h]);for(var h=0;h<d.length;h++)!function(a){f.__defineSetter__(a,function(b){f._cocoonjs_proxy_object_data.eventHandlers[a]=b}),f.__defineGetter__(a,function(){return f._cocoonjs_proxy_object_data.eventHandlers[a]})}(d[h]);return f.addEventListener=function(a,b){var c=!0,d=f._cocoonjs_proxy_object_data.eventListeners[a];if(d)c=d.indexOf(b)<0;else{d=[],f._cocoonjs_proxy_object_data.eventListeners[a]=d;var e="CocoonJS.App.addDestinationProxyObjectEventListener("+JSON.stringify(f._cocoonjs_proxy_object_data.typeName)+", "+f._cocoonjs_proxy_object_data.id+", "+JSON.stringify(a)+");";CocoonJS.App.forwardAsync(e)}c&&d.push(b)},f.removeEventListener=function(a,b){var c=f._cocoonjs_proxy_object_data.eventListeners[a];if(c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}},this},e[a]._cocoonjs_proxy_type_data={originalType:g,proxyObjects:[]},e[a]._cocoonjs_proxy_type_data.deleteProxyObject=function(b){var c=CocoonJS.getKeyForValueInDictionary(this.proxyObjects,b);
if(c){var d="CocoonJS.App.deleteDestinationProxyObject("+JSON.stringify(a)+", "+b._cocoonjs_proxy_object_data.id+");";CocoonJS.App.forwardAsync(d),b._cocoonjs_proxy_object_data=null,delete this.proxyObjects[c]}},e[a]._cocoonjs_proxy_type_data.callProxyObjectEventHandler=function(a,b){var c=this.proxyObjects[a],d=c._cocoonjs_proxy_object_data.eventHandlers[b];d&&d({target:c})},e[a]._cocoonjs_proxy_type_data.callProxyObjectEventListeners=function(a,b){for(var c=this.proxyObjects[a],d=c._cocoonjs_proxy_object_data.eventListeners[b].slice(),e=0;e<d.length;e++)d[e]({target:c})}}},CocoonJS.App.takedownOriginProxyType=function(a){if(CocoonJS.App.nativeExtensionObjectAvailable){var b=window;b[a]&&b[a]._cocoonjs_proxy_type_data&&(b[a]=b[a]._cocoonjs_proxy_type_data.originalType)}},CocoonJS.App.deleteOriginProxyObject=function(a){if(CocoonJS.App.nativeExtensionObjectAvailable){var b=window;a&&a._cocoonjs_proxy_object_data&&b[a._cocoonjs_proxy_object_data.typeName]._cocoonjs_proxy_type_data.deleteProxyObject(a)}},CocoonJS.App.callOriginProxyObjectEventHandler=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable){var d=window;d[a]._cocoonjs_proxy_type_data.callProxyObjectEventHandler(b,c)}},CocoonJS.App.callOriginProxyObjectEventListeners=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable){var d=window;d[a]._cocoonjs_proxy_type_data.callProxyObjectEventListeners(b,c)}},CocoonJS.App.setupDestinationProxyType=function(a,b){if(CocoonJS.App.nativeExtensionObjectAvailable){var c=window;c[a]._cocoonjs_proxy_type_data={nextId:0,proxyObjects:{},eventHandlerNames:b}}},CocoonJS.App.takedownDestinationProxyType=function(a){if(CocoonJS.App.nativeExtensionObjectAvailable){var b=window;parent[a]&&b[a]._cocoonjs_proxy_type_data&&delete b[a]._cocoonjs_proxy_type_data}},CocoonJS.App.newDestinationProxyObject=function(a){if(CocoonJS.App.nativeExtensionObjectAvailable){var b=window,c=new b[a];c._cocoonjs_proxy_object_data={},c._cocoonjs_proxy_object_data.typeName=a;var d=b[a]._cocoonjs_proxy_type_data.nextId;b[a]._cocoonjs_proxy_type_data.proxyObjects[d]=c,c._cocoonjs_proxy_object_data.id=d,b[a]._cocoonjs_proxy_type_data.nextId++;for(var e=0;e<b[a]._cocoonjs_proxy_type_data.eventHandlerNames.length;e++)!function(a){c[a]=function(){var b=this,c="CocoonJS.App.callOriginProxyObjectEventHandler("+JSON.stringify(b._cocoonjs_proxy_object_data.typeName)+", "+b._cocoonjs_proxy_object_data.id+", "+JSON.stringify(a)+");";CocoonJS.App.forwardAsync(c)}}(b[a]._cocoonjs_proxy_type_data.eventHandlerNames[e]);return c._cocoonjs_proxy_object_data.eventListeners={},d}},CocoonJS.App.callDestinationProxyObjectFunction=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable){var d=window,e=Array.prototype.slice.call(arguments);e.splice(0,3);var f=d[a]._cocoonjs_proxy_type_data.proxyObjects[b],g=f[c].apply(f,e);return g}},CocoonJS.App.setDestinationProxyObjectAttribute=function(a,b,c,d){if(CocoonJS.App.nativeExtensionObjectAvailable){var e=window,f=e[a]._cocoonjs_proxy_type_data.proxyObjects[b];f[c]=d}},CocoonJS.App.getDestinationProxyObjectAttribute=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable){var d=window,e=d[a]._cocoonjs_proxy_type_data.proxyObjects[b];return e[c]}},CocoonJS.App.deleteDestinationProxyObject=function(a,b){if(CocoonJS.App.nativeExtensionObjectAvailable){var c=window;delete c[a]._cocoonjs_proxy_type_data.proxyObjects[b]}},CocoonJS.App.addDestinationProxyObjectEventListener=function(a,b,c){if(CocoonJS.App.nativeExtensionObjectAvailable){var d=window,e=d[a]._cocoonjs_proxy_type_data.proxyObjects[b],f=function(){var a=this,b="CocoonJS.App.callOriginProxyObjectEventListeners("+JSON.stringify(a._cocoonjs_proxy_object_data.typeName)+", "+a._cocoonjs_proxy_object_data.id+", "+JSON.stringify(c)+");";CocoonJS.App.forwardAsync(b)};e._cocoonjs_proxy_object_data.eventListeners[c]=f,e.addEventListener(c,f)}},CocoonJS.App.proxifyXHR=function(){var a=["timeout","withCredentials","upload","status","statusText","responseType","response","responseText","responseXML","readyState"],b=["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","overrideMimeType"],c=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"];CocoonJS.App.setupOriginProxyType("XMLHttpRequest",a,b,c)},CocoonJS.App.proxifyAudio=function(){var a=["src","loop","volume","preload"],b=["play","pause","load","canPlayType"],c=["onended","oncanplay","oncanplaythrough","onerror"];CocoonJS.App.setupOriginProxyType("Audio",a,b,c)},CocoonJS.App.captureScreen=function(a,b,c){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("captureScreen",a,b,c):void 0},CocoonJS.App.captureScreenAsync=function(a,b,c,d){CocoonJS.App.nativeExtensionObjectAvailable&&window.ext.IDTK_APP.makeCallAsync("captureScreen",a,b,c,d)},CocoonJS.App.getDeviceId=function(){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("getDeviceId"):void 0},CocoonJS.App.DeviceInfo={os:null,version:null,dpi:null,brand:null,model:null,imei:null,platformId:null,odin:null,openudid:null},CocoonJS.App.getDeviceInfo=function(){return CocoonJS.App.nativeExtensionObjectAvailable?window.ext.IDTK_APP.makeCall("getDeviceInfo"):void 0},CocoonJS.App.onTextDialogFinished=new CocoonJS.EventHandler("IDTK_APP","App","ontextdialogfinish"),CocoonJS.App.onTextDialogCancelled=new CocoonJS.EventHandler("IDTK_APP","App","ontextdialogcancel"),CocoonJS.App.onMessageBoxConfirmed=new CocoonJS.EventHandler("IDTK_APP","App","onmessageboxconfirmed"),CocoonJS.App.onMessageBoxDenied=new CocoonJS.EventHandler("IDTK_APP","App","onmessageboxdenied"),CocoonJS.App.onSuspended=new CocoonJS.EventHandler("IDTK_APP","App","onsuspended"),CocoonJS.App.onActivated=new CocoonJS.EventHandler("IDTK_APP","App","onactivated")}(),function(){if("undefined"==typeof window.CocoonJS||null===window.CocoonJS)throw"The CocoonJS object must exist and be valid before adding more functionalities to an extension.";if("undefined"==typeof window.CocoonJS.App||null===window.CocoonJS.App)throw"The CocoonJS.App object must exist and be valid before adding more functionalities to it.";CocoonJS.App=CocoonJS.App?CocoonJS.App:{},CocoonJS.App.nativeExtensionObjectAvailable||!function(){CocoonJS.App.EmulatedWebView=document.createElement("div"),CocoonJS.App.EmulatedWebView.setAttribute("id","CocoonJS_App_ForCocoonJS_WebViewDiv"),CocoonJS.App.EmulatedWebView.style.width=0,CocoonJS.App.EmulatedWebView.style.height=0,CocoonJS.App.EmulatedWebView.style.position="absolute",CocoonJS.App.EmulatedWebView.style.left=0,CocoonJS.App.EmulatedWebView.style.top=0,CocoonJS.App.EmulatedWebView.style.backgroundColor="transparent",CocoonJS.App.EmulatedWebView.style.border="0px solid #000",CocoonJS.App.EmulatedWebViewIFrame=document.createElement("IFRAME"),CocoonJS.App.EmulatedWebViewIFrame.setAttribute("id","CocoonJS_App_ForCocoonJS_WebViewIFrame"),CocoonJS.App.EmulatedWebViewIFrame.setAttribute("name","CocoonJS_App_ForCocoonJS_WebViewIFrame"),CocoonJS.App.EmulatedWebViewIFrame.style.width=0,CocoonJS.App.EmulatedWebViewIFrame.style.height=0,CocoonJS.App.EmulatedWebViewIFrame.frameBorder=0,CocoonJS.App.EmulatedWebViewIFrame.allowtransparency=!0,CocoonJS.App.EmulatedWebView.appendChild(CocoonJS.App.EmulatedWebViewIFrame),document.body||(document.body=document.createElement("body")),document.body.appendChild(CocoonJS.App.EmulatedWebView)}(),CocoonJS.App.pause=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","pause",arguments):void 0},CocoonJS.App.resume=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","resume",arguments):void 0},CocoonJS.App.loadInTheWebView=function(a,b){if(CocoonJS.App.nativeExtensionObjectAvailable){var c="ext.IDTK_APP.makeCall('loadPath'";return"undefined"!=typeof a&&(c+=", '"+a+"'","undefined"!=typeof b&&(c+=", '"+b+"'")),c+=");",CocoonJS.App.forwardAsync(c)}if(!navigator.isCocoonJS){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var b=function(){CocoonJS.App.onLoadInTheWebViewSucceed.notifyEventListeners(a),CocoonJS.App.EmulatedWebViewIFrame.removeEventListener("load",b)};CocoonJS.App.EmulatedWebViewIFrame.addEventListener("load",b),CocoonJS.App.EmulatedWebViewIFrame.contentWindow.location.href=a}else 404===d.status&&(this.onreadystatechange=null,CocoonJS.App.onLoadInTheWebViewFailed.notifyEventListeners(a))},d.open("GET",a,!0),d.send()}},CocoonJS.App.reloadWebView=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.App.forwardAsync("ext.IDTK_APP.makeCall('reload');"):void(navigator.isCocoonJS||CocoonJS.App.EmulatedWebViewIFrame.contentWindow.location.reload())},CocoonJS.App.showTheWebView=function(a,b,c,d){if(CocoonJS.App.nativeExtensionObjectAvailable){var e="ext.IDTK_APP.makeCall('show'";return"undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&"undefined"!=typeof d&&(e+=", "+a+", "+b+", "+c+", "+d),e+=");",CocoonJS.App.forwardAsync(e)}navigator.isCocoonJS||(CocoonJS.App.EmulatedWebViewIFrame.style.width=(c?c:window.innerWidth)+"px",CocoonJS.App.EmulatedWebViewIFrame.style.height=(d?d:window.innerHeight)+"px",CocoonJS.App.EmulatedWebView.style.left=(a?a:0)+"px",CocoonJS.App.EmulatedWebView.style.top=(b?b:0)+"px",CocoonJS.App.EmulatedWebView.style.width=(c?c:window.innerWidth)+"px",CocoonJS.App.EmulatedWebView.style.height=(d?d:window.innerHeight)+"px",CocoonJS.App.EmulatedWebView.style.display="block")},CocoonJS.App.hideTheWebView=function(){if(CocoonJS.App.nativeExtensionObjectAvailable){var a="ext.IDTK_APP.makeCall('hide');";return CocoonJS.App.forwardAsync(a)}navigator.isCocoonJS||(CocoonJS.App.EmulatedWebView.style.display="none")},CocoonJS.App.markAsMusic=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","addForceMusic",arguments):void 0},CocoonJS.App.setAntialias=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","setDefaultAntialias",arguments):void 0},CocoonJS.App.setAppShouldFinishCallback=function(a){navigator.isCocoonJS&&(window.onidtkappfinish=a)},CocoonJS.App.setTextureReduction=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","setDefaultTextureReducerThreshold",arguments):void 0},CocoonJS.App.logMemoryInfo=function(){return CocoonJS.App.nativeExtensionObjectAvailable?CocoonJS.makeNativeExtensionObjectFunctionCall("IDTK_APP","logMemoryInfo",arguments):void 0},CocoonJS.App.enableFPSInTheWebView=function(a,b){if(!CocoonJS.App.fpsInTheWebViewEnabled){a=a?a:CocoonJS.App.FPSLayout.TOP_RIGHT,b=b?b:"white";var c="(function(){var COCOONJS_WEBVIEW_EXTENSION_SCRIPT_FILES = ['js/CocoonJSExtensions/CocoonJS.js', 'js/CocoonJSExtensions/CocoonJS_App.js', 'js/CocoonJSExtensions/CocoonJS_App_ForWebView.js'];var loadedScriptCounter = 0;var loadedScriptFunction = function() { loadedScriptCounter++;if (loadedScriptCounter >= COCOONJS_WEBVIEW_EXTENSION_SCRIPT_FILES.length){CocoonJS.App.enableFPS("+JSON.stringify(a)+", "+JSON.stringify(b)+");}};for (var i = 0; i < COCOONJS_WEBVIEW_EXTENSION_SCRIPT_FILES.length; i++){var s = document.createElement('script');s.onload = loadedScriptFunction;s.src = COCOONJS_WEBVIEW_EXTENSION_SCRIPT_FILES[i];document.body.appendChild(s);}})();";setTimeout(function(){CocoonJS.App.forward(c)},3e3),CocoonJS.App.fpsInTheWebViewEnabled=!0}},CocoonJS.App.disableFPSInTheWebView=function(){},CocoonJS.App.onLoadInTheWebViewSucceed=new CocoonJS.EventHandler("IDTK_APP","App","forwardpageload"),CocoonJS.App.onLoadInTheWebViewFailed=new CocoonJS.EventHandler("IDTK_APP","App","forwardpagefail")}(),function(){CocoonJS.Audio=function(){return this},CocoonJS.Audio.prototype={audio:null,setAudio:function(a){return this.audio=a,this.audio.load(),this},loop:function(){return this},play:function(){return this.audio.play(),this},pause:function(){return this.audio.pause(),this},stop:function(){this.audio.pause(),this.audio.currentTime=0},volume:function(a){return this.audio?(this.audio.volume=a,this):void console.log("audio not present.")},getVolume:function(){return this.audio.volume}}}(),function(){CocoonJS.Music=function(){return this},CocoonJS.Music.prototype={audio:null,setAudio:function(a){return this.audio=a,this.audio.load(),this.audio.addEventListener("ended",function(a){a.target.playing=!1,console.log("Audio ends playing.")},!1),this},loop:function(){return this.audio?(this.audio.loop=!this.audio.loop,this):void console.log("audio not present.")},play:function(){if(!this.audio)return void console.log("audio not present.");if(!this.audio.playing)return this.audio.playing=!0,this.audio.play(),this},pause:function(){return this.audio?(this.audio.pause(),this.audio.playing=!1,this):void console.log("audio not present.")},volume:function(a){return this.audio?(this.audio.volume=a,this):void console.log("audio not present.")},getVolume:function(){return this.audio.volume},stop:function(){this.audio.pause(),this.audio.currentTime=0}}}(),function(){var a={},b=null,c=!0,d=!1;if("undefined"!=typeof AudioContext)b=new AudioContext;else if("undefined"!=typeof webkitAudioContext)b=new webkitAudioContext;else if("undefined"!=typeof Audio){c=!1;try{new Audio}catch(e){d=!0}}else c=!1,d=!0;if(c){var f="undefined"==typeof b.createGain?b.createGainNode():b.createGain();f.gain.value=1,f.connect(b.destination)}var g=function(){this._volume=1,this._muted=!1,this.usingWebAudio=c,this.noAudio=d,this._howls=[]};g.prototype={volume:function(a){var b=this;if(a=parseFloat(a),a>=0&&1>=a){b._volume=a,c&&(f.gain.value=a);for(var d in b._howls)if(b._howls.hasOwnProperty(d)&&b._howls[d]._webAudio===!1)for(var e=0;e<b._howls[d]._audioNode.length;e++)b._howls[d]._audioNode[e].volume=b._howls[d]._volume*b._volume;return b}return c?f.gain.value:b._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){var b=this;b._muted=a,c&&(f.gain.value=a?0:b._volume);for(var d in b._howls)if(b._howls.hasOwnProperty(d)&&b._howls[d]._webAudio===!1)for(var e=0;e<b._howls[d]._audioNode.length;e++)b._howls[d]._audioNode[e].muted=a}};var h=new g,i=null;if(!d){i=new Audio;var j={mp3:!!i.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var k=function(a){var b=this;b._autoplay=a.autoplay||!1,b._buffer=a.buffer||!1,b._duration=a.duration||0,b._format=a.format||null,b._loop=a.loop||!1,b._loaded=!1,b._sprite=a.sprite||{},b._src=a.src||"",b._pos3d=a.pos3d||[0,0,-.5],b._volume=void 0!==a.volume?a.volume:1,b._urls=a.urls||[],b._rate=a.rate||1,b._onload=[a.onload||function(){}],b._onloaderror=[a.onloaderror||function(){}],b._onend=[a.onend||function(){}],b._onpause=[a.onpause||function(){}],b._onplay=[a.onplay||function(){}],b._onendTimer=[],b._webAudio=c&&!b._buffer,b._audioNode=[],b._webAudio&&b._setupAudioNode(),h._howls.push(b),b.load()};if(k.prototype={load:function(){var b=this,c=null;if(d)return void b.on("loaderror");for(var e=0;e<b._urls.length;e++){var f,g;if(b._format)f=b._format;else{if(g=b._urls[e].toLowerCase().split("?")[0],f=g.match(/.+\.([^?]+)(\?|$)/),f=f&&f.length>=2?f:g.match(/data\:audio\/([^?]+);/),!f)return void b.on("loaderror");f=f[1]}if(j[f]){c=b._urls[e];break}}if(!c)return void b.on("loaderror");if(b._src=c,b._webAudio)l(b,c);else{var i=new Audio;b._audioNode.push(i),i.src=c,i._pos=0,i.preload="auto",i.volume=h._muted?0:b._volume*h.volume(),a[c]=b;var k=function(){b._duration=Math.ceil(10*i.duration)/10,0===Object.getOwnPropertyNames(b._sprite).length&&(b._sprite={_default:[0,1e3*b._duration]}),b._loaded||(b._loaded=!0,b.on("load")),b._autoplay&&b.play(),i.removeEventListener("canplaythrough",k,!1)};i.addEventListener("canplaythrough",k,!1),i.load()}return b},urls:function(a){var b=this;return a?(b.stop(),b._urls="string"==typeof a?[a]:a,b._loaded=!1,b.load(),b):b._urls},play:function(a,c){var d=this;return"function"==typeof a&&(c=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var f,g=e._pos>0?e._pos:d._sprite[a][0]/1e3,i=d._sprite[a][1]/1e3-e._pos,j=!(!d._loop&&!d._sprite[a][2]),k="string"==typeof c?c:Math.round(Date.now()*Math.random())+"";if(function(){var b={id:k,sprite:a,loop:j};f=setTimeout(function(){!d._webAudio&&j&&d.stop(b.id,b.timer).play(a,b.id),d._webAudio&&!j&&(d._nodeById(b.id).paused=!0,d._nodeById(b.id)._pos=0),d._webAudio||j||d.stop(b.id,b.timer),d.on("end",k)},1e3*i),d._onendTimer.push(f),b.timer=d._onendTimer[d._onendTimer.length-1]}(),d._webAudio){var l=d._sprite[a][0]/1e3,m=d._sprite[a][1]/1e3;e.id=k,e.paused=!1,n(d,[j,l,m],k),d._playStart=b.currentTime,e.gain.value=d._volume,"undefined"==typeof e.bufferSource.start?e.bufferSource.noteGrainOn(0,g,i):e.bufferSource.start(0,g,i)}else{if(4!==e.readyState)return d._clearEndTimer(f),function(){var b=d,f=a,g=c,h=e,i=function(){b.play(f,g),h.removeEventListener("canplaythrough",i,!1)};h.addEventListener("canplaythrough",i,!1)}(),d;e.id=k,e.currentTime=g,e.muted=h._muted,e.volume=d._volume*h.volume(),setTimeout(function(){e.play()},0)}return d.on("play"),"function"==typeof c&&c(k),d}),d):("function"==typeof c&&c(),d):(d.on("load",function(){d.play(a,c)}),d)},pause:function(a,b){var c=this;if(!c._loaded)return c.on("play",function(){c.pause(a)}),c;c._clearEndTimer(b||0);var d=a?c._nodeById(a):c._activeNode();if(d)if(d._pos=c.pos(null,a),c._webAudio){if(!d.bufferSource||d.paused)return c;d.paused=!0,"undefined"==typeof d.bufferSource.stop?d.bufferSource.noteOff(0):d.bufferSource.stop(0)}else d.pause();return c.on("pause"),c},stop:function(a,b){var c=this;if(!c._loaded)return c.on("play",function(){c.stop(a)}),c;c._clearEndTimer(b||0);var d=a?c._nodeById(a):c._activeNode();if(d)if(d._pos=0,c._webAudio){if(!d.bufferSource||d.paused)return c;d.paused=!0,"undefined"==typeof d.bufferSource.stop?d.bufferSource.noteOff(0):d.bufferSource.stop(0)}else d.pause(),d.currentTime=0;return c},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.volume=0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.volume=b._volume),b},volume:function(a,b){var c=this;if(a=parseFloat(a),a>=0&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*h.volume()),c}return c._volume},loop:function(a){var b=this;return"boolean"==typeof a?(b._loop=a,b):b._loop},sprite:function(a){var b=this;return"object"==typeof a?(b._sprite=a,b):b._sprite},pos:function(a,c){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=c?d._nodeById(c):d._activeNode();if(e)return a>=0?(d.pause(c),e._pos=a,d.play(e._sprite,c),d):d._webAudio?e._pos+(b.currentTime-d._playStart):e.currentTime;if(a>=0)return d;for(var f=0;f<d._audioNode.length;f++)if(d._audioNode[f].paused&&4===d._audioNode[f].readyState)return d._webAudio?d._audioNode[f]._pos:d._audioNode[f].currentTime},pos3d:function(a,b,c,d){var e=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(a>=0||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c))}return e},fade:function(a,b,c,d,e){var f=this,g=Math.abs(a-b),h=a>b?"down":"up",i=g/.01,j=c/i;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var k=1;i>=k;k++)!function(){var a=f._volume+("up"===h?.01:-.01)*k,c=Math.round(1e3*a)/1e3,g=b;setTimeout(function(){f.volume(c,e),c===g&&d&&d()},j*k)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c(),e.pause(d),e.on("end")},d)},_nodeById:function(a){for(var b=this,c=b._audioNode[0],d=0;d<b._audioNode.length;d++)if(b._audioNode[d].id===a){c=b._audioNode[d];break}return c},_activeNode:function(){for(var a=this,b=null,c=0;c<a._audioNode.length;c++)if(!a._audioNode[c].paused){b=a._audioNode[c];break}return a._drainPool(),b},_inactiveNode:function(a){for(var b=this,c=null,d=0;d<b._audioNode.length;d++)if(b._audioNode[d].paused&&4===b._audioNode[d].readyState){a(b._audioNode[d]),c=!0;break}if(b._drainPool(),!c){var e;b._webAudio?(e=b._setupAudioNode(),a(e)):(b.load(),e=b._audioNode[b._audioNode.length-1],e.addEventListener("loadedmetadata",function(){a(e)}))}},_drainPool:function(){var a,b=this,c=0;for(a=0;a<b._audioNode.length;a++)b._audioNode[a].paused&&c++;for(a=b._audioNode.length-1;a>=0&&!(5>=c);a--)b._audioNode[a].paused&&(b._webAudio&&b._audioNode[a].disconnect(0),c--,b._audioNode.splice(a,1))},_clearEndTimer:function(a){var b=this,c=b._onendTimer.indexOf(a);c=c>=0?c:0,b._onendTimer[c]&&(clearTimeout(b._onendTimer[c]),b._onendTimer.splice(c,1))},_setupAudioNode:function(){var a=this,c=a._audioNode,d=a._audioNode.length;return c[d]="undefined"==typeof b.createGain?b.createGainNode():b.createGain(),c[d].gain.value=a._volume,c[d].paused=!0,c[d]._pos=0,c[d].readyState=4,c[d].connect(f),c[d].panner=b.createPanner(),c[d].panner.setPosition(a._pos3d[0],a._pos3d[1],a._pos3d[2]),c[d].panner.connect(c[d]),c[d]},on:function(a,b){var c=this,d=c["_on"+a];if("function"==typeof b)d.push(b);else for(var e=0;e<d.length;e++)b?d[e].call(c,b):d[e].call(c);return c},off:function(a,b){for(var c=this,d=c["_on"+a],e=b.toString(),f=0;f<d.length;f++)if(e===d[f].toString()){d.splice(f,1);break}return c},unload:function(){for(var b=this,c=b._audioNode,d=0;d<b._audioNode.length;d++)c[d].paused||b.stop(c[d].id),b._webAudio?c[d].disconnect(0):c[d].src="";var e=h._howls.indexOf(b);null!==e&&e>=0&&h._howls.splice(e,1),delete a[b._src],b=null}},c)var l=function(c,d){if(d in a)c._duration=a[d].duration,m(c);else{var e=new XMLHttpRequest;e.open("GET",d,!0),e.responseType="arraybuffer",e.onload=function(){b.decodeAudioData(e.response,function(b){b&&(a[d]=b,m(c,b))},function(){c.on("loaderror")})},e.onerror=function(){c._webAudio&&(c._buffer=!0,c._webAudio=!1,c._audioNode=[],delete c._gainNode,c.load())};try{e.send()}catch(f){e.onerror()}}},m=function(a,b){a._duration=b?b.duration:a._duration,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play()},n=function(c,d,e){var f=c._nodeById(e);f.bufferSource=b.createBufferSource(),f.bufferSource.buffer=a[c._src],f.bufferSource.connect(f.panner),f.bufferSource.loop=d[0],d[0]&&(f.bufferSource.loopStart=d[1],f.bufferSource.loopEnd=d[1]+d[2]),f.bufferSource.playbackRate.value=c._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:h,Howl:k}}),"undefined"!=typeof exports&&(exports.Howler=h,exports.Howl=k),window.Howler=h,window.Howl=k}();var Math2={};Math2.random=function(a,b){return Math.random()*(b-a)+a},Math2.map=function(a,b,c,d,e){return(e-d)*((a-b)/(c-b))+d},Math2.randomPlusMinus=function(a){return a=a?a:.5,Math.random()>a?-1:1},Math2.randomInt=function(a,b){return b+=1,Math.floor(Math.random()*(b-a)+a)},Math2.randomBool=function(a){return a=a?a:.5,Math.random()<a?!0:!1},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(b){function c(){var f=e.concat(a.call(arguments));d.apply(this instanceof c?this:b,f)}var d=this,e=a.call(arguments,1);if("function"!=typeof d)throw new TypeError;return c.prototype=function f(a){return a&&(f.prototype=a),this instanceof f?void 0:new f}(d.prototype),c}}()),domready(function(){onReady()}),window.addEventListener("resize",function(){resize()}),window.onorientationchange=resize,PIXI.Texture.fromFrameId=PIXI.Texture.fromFrame;var GAME_MODE={TITLE:0,COUNT_DOWN:1,PLAYING:2,GAME_OVER:3,INTRO:4,PAUSED:5},width=800,height=600,isAdding=!1,loader,game,mouseX=0,mouseY=0,ratio,offsetX,offsetY,holder,loadInterval=!1,loadCount=0,gameMode=0,countdown,logo,black,interactive=!0,stressTest,pixiLogo,gameLoop=!1,thrustLoop=!1,thrusters=0,thrustersVolume=0,pauseButton=!1,pauseScreen=!1,resumeButton=!1,restartButton=!1,soundOnButton=!1,soundOffButton=!1,sound=!0,prevState=!1;Time=function(){this.deltaTime=1,this.lastTime=0},Time.constructor=Time,Time.prototype.update=function(){var a=Date.now(),b=a,c=b-this.lastTime;c>100&&(c=100),this.DELTA_TIME=.06*c,this.lastTime=b};var PIXI=PIXI||{};PIXI.StressTest=function(a){this.width=window.innerWidth||document.body.clientWidth,this.height=window.innerHeight||document.body.clientHeight,this.frameCount=0,this.tick=0,this.loadingFrames=["img/loading_01.png","img/loading_02.png","img/loading_03.png","img/loading_04.png"],this.currentLoadSprite=!1;var b=new PIXI.AssetLoader(this.loadingFrames,!0);b.load(),this.callback=a,this.stage=new PIXI.Stage(2435146),this.renderer=PIXI.autoDetectRenderer(this.width,this.height,!1,!0,!0),document.body.appendChild(this.renderer.view);var c=new PIXI.Sprite(PIXI.Texture.fromImage("img/goodboy_logo.png"));c.anchor.x=.5,c.anchor.y=.5,c.position.x=.5*this.width,c.position.y=.48*this.height,c.scale.set(1),this.stage.addChild(c),this.duration=3;var d=this;this.texture=PIXI.Texture.fromImage("img/testImage.png"),this.texture.baseTexture.addEventListener("loaded",function(){d.begin()}),this.frameRate=[]},PIXI.StressTest.constructor=PIXI.StressTest,PIXI.StressTest.prototype.begin=function(){this.testSprites=[];for(var a=0;300>a;a++){var b=new PIXI.Sprite(this.texture);b.anchor.x=.5,b.anchor.y=.5,b.position.x=50+400*Math.random(),b.position.y=10,this.stage.addChild(b),this.testSprites.push(b)}this.renderer.render(this.stage),this.startTime=Date.now(),this.lastTime=Date.now();var c=this;requestAnimFrame(function(){c.update()})},PIXI.StressTest.prototype.resize=function(a,b){this.width=a,this.height=b},PIXI.StressTest.prototype.update=function(){if(this.frameCount++,this.frameCount%12===1){this.tick===this.loadingFrames.length&&(this.tick=0);var a=SpritePool.getInstance().get(this.loadingFrames[this.tick]);a.anchor.x=.5,a.anchor.y=.5,a.position.x=.5*this.width,a.position.y=.58*this.height,a.scale.set(1),this.stage.addChild(a),this.currentLoadSprite!==!1&&this.stage.removeChild(this.currentLoadSprite),this.currentLoadSprite=a,this.tick++}for(var b=Date.now(),c=0;c<this.testSprites.length;c++)this.testSprites[c].rotation+=.3;this.renderer.render(this.stage);var d=b-this.lastTime;d*=.06,this.frameRate.push(d),this.lastTime=b;var e=b-this.startTime;if(e<1e3*this.duration){var f=this;requestAnimFrame(function(){f.update()})}else this.callback&&this.callback()},PIXI.StressTest.prototype.remove=function(){var a=this;document.body.removeChild(a.renderer.view),a.cover=null,a.renderer=null,a.result=a.frameRate.length/a.duration};var GAME=GAME||{};GAME.Background=function(){PIXI.DisplayObjectContainer.call(this),this.width=1e3,this.scrollPosition=1500,this.foggyTrees=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("05_far_BG.jpg"),40,this),this.rearSilhouette=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("03_rear_silhouette.png"),358,this),this.rearCanopy=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("03_rear_canopy.png"),0,this),this.tree1=PIXI.Sprite.fromFrame("02_tree_1.png"),this.tree1.anchor.x=.5,this.addChild(this.tree1),this.tree2=PIXI.Sprite.fromFrame("02_tree_2.png"),this.tree2.anchor.x=.5,this.tree2.position.y=50,this.addChild(this.tree2),this.farCanopy=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("02_front_canopy.png"),0,this),this.vines=new GAME.Vines(this),this.roofLeaves=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("00_roof_leaves.png"),0,this),this.frontSilhouette=new GAME.BackgroundElement(PIXI.Texture.fromFrameId("01_front_silhouette.png"),424,this),this.foggyTrees.speed=.5,this.rearSilhouette.speed=.6,this.rearCanopy.speed=.6,this.farCanopy.speed=.75,this.frontSilhouette.speed=.8,this.roofLeaves.speed=1},GAME.Background.constructor=GAME.Background,GAME.Background.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Background.prototype.updateTransform=function(){this.scrollPosition=GAME.camera.x+4e3;var a=1.5*-this.scrollPosition/2;a%=this.width+556,a+=this.width+556,a-=this.tree1.width/2,this.tree1.position.x=a-GAME.xOffset;var b=1.5*-(this.scrollPosition+this.width/2)/2;b%=this.width+556,b+=this.width+556,b-=this.tree2.width/2,this.tree2.position.x=b-GAME.xOffset,this.foggyTrees.setPosition(this.scrollPosition),this.rearSilhouette.setPosition(this.scrollPosition),this.rearCanopy.setPosition(this.scrollPosition),this.farCanopy.setPosition(this.scrollPosition),this.frontSilhouette.setPosition(this.scrollPosition),this.roofLeaves.setPosition(this.scrollPosition),this.vines.setPosition(this.scrollPosition),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},GAME.Vines=function(a){this.vines=[],this.owner=a;for(var b=0;10>b;b++){var c=new PIXI.Sprite.fromFrame("01_hanging_flower3.png");c.offset=100*b+50*Math.random(),c.speed=(1.5+.25*Math.random())/2,c.position.y=-200*Math.random(),a.addChild(c),c.position.x=200,this.vines.push(c)}this.speed=1},GAME.Vines.prototype.setPosition=function(a){for(var b=0;b<this.vines.length;b++){var c=this.vines[b],d=-(a+c.offset)*c.speed;d%=this.owner.width,d+=this.owner.width,c.position.x=d}},GAME.Background.prototype.joyRideMode=function(){},GAME.Background.prototype.normalMode=function(){},GAME.BackgroundElement=function(a,b,c){this.sprites=[],this.spriteWidth=a.width-1;var d=Math.ceil(940/this.spriteWidth);3>d&&(d=3);for(var e=0;d>e;e++){var f=new PIXI.Sprite(a);f.position.y=b,c.addChild(f),this.sprites.push(f)}this.speed=1},GAME.BackgroundElement.prototype.setPosition=function(a){for(var b=this.spriteWidth,c=0;c<this.sprites.length;c++){var d=-a*this.speed;d+=c*b,d%=b*this.sprites.length,d+=2*b,this.sprites[c].position.x=Math.floor(d)-GAME.xOffset}};var GAME=GAME||{};GAME.Lava=function(a){this.textures=[PIXI.Texture.fromFrameId("lava_slosh_01.png"),PIXI.Texture.fromFrameId("lava_slosh_02.png"),PIXI.Texture.fromFrameId("lava_slosh_03.png"),PIXI.Texture.fromFrameId("lava_slosh_04.png"),PIXI.Texture.fromFrameId("lava_slosh_05.png"),PIXI.Texture.fromFrameId("lava_slosh_06.png"),PIXI.Texture.fromFrameId("lava_slosh_07.png"),PIXI.Texture.fromFrameId("lava_slosh_08.png"),PIXI.Texture.fromFrameId("lava_slosh_07.png"),PIXI.Texture.fromFrameId("lava_slosh_06.png"),PIXI.Texture.fromFrameId("lava_slosh_05.png"),PIXI.Texture.fromFrameId("lava_slosh_04.png"),PIXI.Texture.fromFrameId("lava_slosh_03.png"),PIXI.Texture.fromFrameId("lava_slosh_02.png"),PIXI.Texture.fromFrameId("lava_slosh_01.png")];var b=this.textures[0];this.sprites=[],this.spriteWidth=b.width-1;var c=8;3>c&&(c=3);for(var d=0;c>d;d++){var e=new PIXI.Sprite(b);e.position.y=580,a.addChild(e),this.sprites.push(e)}this.speed=1,this.offset=0,this.count=0},GAME.Lava.prototype.setPosition=function(a){var b=this.spriteWidth,c=this.count%this.textures.length;c=Math.floor(c),this.offset+=2.5,a+=this.offset,this.count+=.3;for(var d=0;d<this.sprites.length;d++){var e=-a*this.speed;e+=d*b,e%=b*this.sprites.length,e+=2*b,this.sprites[d].setTexture(this.textures[c]),this.sprites[d].position.x=Math.floor(e)+800-GAME.xOffset}};var GAME=GAME||{};GAME.JoyBackground=function(){PIXI.DisplayObjectContainer.call(this),this.width=1e3,this.scrollPosition=1500;
this.swoosh=new GAME.BackgroundElement(PIXI.Texture.fromImage("img/stretched_hyper_tile.jpg"),0,this),this.swoosh.speed=.7,this.scale.y=1.7,this.scale.x=4},GAME.JoyBackground.constructor=GAME.LowFiBackground,GAME.JoyBackground.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.JoyBackground.prototype.updateTransform=function(){this.scrollPosition=GAME.camera.x+4e3,this.swoosh.setPosition(this.scrollPosition),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};var GAME=GAME||{};GAME.LowFiBackground=function(){PIXI.DisplayObjectContainer.call(this),this.width=1e3,this.scrollPosition=1500;this.swoosh=new GAME.BackgroundElement(PIXI.Texture.fromImage("img/iP4_BGtile.jpg"),0,this),this.swoosh.speed=.7},GAME.LowFiBackground.constructor=GAME.LowFiBackground,GAME.LowFiBackground.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.LowFiBackground.prototype.updateTransform=function(){this.scrollPosition=GAME.camera.x+4e3,this.swoosh.setPosition(this.scrollPosition),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};var GAME=GAME||{};GAME.RprView=function(a){this.engine=a,this.renderer=PIXI.autoDetectRenderer(600,800),GAME.HIGH_MODE=this.renderer instanceof PIXI.WebGLRenderer,this.stage=new PIXI.Stage,this.container=new PIXI.DisplayObjectContainer,this.container.hitArea=this.stage.hitArea,this.container.interactive=!0,this.hud=new PIXI.DisplayObjectContainer,this.game=new PIXI.DisplayObjectContainer,this.gameFront=new PIXI.DisplayObjectContainer,this.container.addChild(this.game),this.container.addChild(this.gameFront),this.stage.addChild(this.container),this.stage.addChild(this.hud),this.normalBackground=GAME.lowMode?new GAME.LowFiBackground:new GAME.Background(this.gameFront),this.joyBackground=new GAME.JoyBackground,this.lava=new GAME.Lava(this.gameFront),this.powerBar=new GAME.PowerBar,this.score=new GAME.Score,this.bestScore=new GAME.BestScore,this.background=this.normalBackground,this.score.position.x=300,this.game.addChild(this.background),this.hud.addChild(this.powerBar),this.hud.addChild(this.score),this.hud.addChild(this.bestScore),this.trail=new GAME.SteveTrail(this.game),this.trail2=new GAME.SteveTrailFire(this.game),this.powerBar.alpha=0,this.score.alpha=0,this.bestScore.alpha=0,this.count=0,this.zoom=1,this.white=PIXI.Sprite.fromImage("img/whiteSquare.jpg"),GAME.xOffset=this.container.position.x,this.dust=new GAME.PixiDust,this.container.addChild(this.dust),this.splash=new GAME.Splash,this.splash.position.y=300,this.splash.position.x=300,this.game.addChild(this.splash)},GAME.RprView.constructor=GAME.RprView,GAME.RprView.prototype.showHud=function(){var a={x:GAME.width+300,y:0};this.score.alpha=1,this.score.position.x=a.x,TweenLite.to(this.score.position,1,{x:GAME.width-295-20,ease:Elastic.easeOut}),this.bestScore.alpha=1,this.bestScore.position.x=a.x,this.bestScore.position.y-=14,TweenLite.to(this.bestScore.position,1,{x:GAME.width-20,ease:Elastic.easeOut}),this.powerBar.alpha=1,this.powerBar.position.x=GAME.width,TweenLite.to(this.powerBar.position,1,{x:GAME.width-295,ease:Elastic.easeOut,delay:.3})},GAME.RprView.prototype.hideHud=function(){},GAME.RprView.prototype.update=function(){if(this.count+=.01,!GAME.lowMode){var a=this.zoom-1,b=-GAME.width/2,c=-this.engine.steve.view.position.x,d=b+(c-b)*a;this.container.position.x=d*this.zoom,this.container.position.y=-this.engine.steve.view.position.y*this.zoom,this.container.position.x+=GAME.width/2,this.container.position.y+=GAME.height/2,GAME.xOffset=this.container.position.x,this.container.position.y>0&&(this.container.position.y=0);var e=-GAME.height*this.zoom;e+=GAME.height,this.container.position.y<e&&(this.container.position.y=e),this.container.scale.x=this.zoom,this.container.scale.y=this.zoom}this.trail.target=this.engine.steve,this.trail2.target=this.engine.steve,this.trail.update(),this.trail2.update(),this.dust.update(),this.lava.setPosition(GAME.camera.x+4e3),this.bestScore.update(),this.score.setScore(Math.round(this.engine.score)),this.powerBar.bar.scale.x=this.engine.pickupCount/(50*this.engine.bulletMult)*(248/252),this.renderer.render(this.stage)},GAME.RprView.prototype.joyrideMode=function(){this.game.removeChild(this.background),this.background=this.joyBackground,this.game.addChildAt(this.background,0),this.stage.addChild(this.white),this.white.alpha=1,TweenLite.to(this.white,.7,{alpha:0,ease:Sine.easeOut})},GAME.RprView.prototype.doSplash=function(){this.splash.splash(this.engine.steve.position)},GAME.RprView.prototype.normalMode=function(){this.game.removeChild(this.background),this.background=this.normalBackground,this.game.addChildAt(this.background,0),this.stage.addChild(this.white),this.white.alpha=1,TweenLite.to(this.white,.5,{alpha:0,ease:Sine.easeOut})},GAME.RprView.prototype.resize=function(a,b){GAME.width=a,GAME.height=b,this.renderer.resize(a,b),this.background.width=a,this.bestScore.position.x=a-20,this.bestScore.position.y=100,this.score.position.x=a-295-20,this.score.position.y=12,this.white.scale.x=a/16,this.white.scale.y=b/16,this.powerBar.position.x=a-295,this.powerBar.position.y=12};var GAME=GAME||{},enemyFrames,m_cCountdown=!1;GAME.Countdown=function(){PIXI.DisplayObjectContainer.call(this),this.three=PIXI.Sprite.fromFrame("3Get.png"),this.two=PIXI.Sprite.fromFrame("2tricksy.png"),this.one=PIXI.Sprite.fromFrame("1pixie.png"),this.three.anchor.x=this.three.anchor.y=.5,this.two.anchor.x=this.two.anchor.y=.5,this.one.anchor.x=this.one.anchor.y=.5,this.three.alpha=0,this.two.alpha=0,this.one.alpha=0,this.addChild(this.three),this.addChild(this.two),this.addChild(this.one),this.three.alpha=0,this.two.alpha=0,this.one.alpha=0,m_cCountdown=this},GAME.Countdown.constructor=GAME.Countdown,GAME.Countdown.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Countdown.prototype.startCountDown=function(a){this.visible=!0,this.onComplete=a,this.three.alpha=0,this.two.alpha=0,this.one.alpha=0,this.three.scale.x=this.three.scale.y=2,this.two.scale.x=this.two.scale.y=2,this.one.scale.x=this.one.scale.y=2;TweenLite.to(this.three,1*time2,{alpha:1,onComplete:function(){m_cCountdown.onThreeShown()}}),TweenLite.to(this.three.scale,1*time2,{x:1,y:1,ease:Elastic.easeOut})};var time=.1,time2=.5,delay=0;GAME.Countdown.prototype.onThreeShown=function(){var a=this;TweenLite.to(a.three,1*time,{alpha:0,ease:Sine.easeOut,delay:delay}),TweenLite.to(a.three.scale,1*time,{x:.5,y:.5,ease:Cubic.easeOut,delay:delay}),TweenLite.to(a.two,1*time2,{alpha:1,onComplete:function(){TweenLite.to(a.two,1*time,{alpha:0,delay:delay}),TweenLite.to(a.two.scale,1*time,{x:.5,y:.5,ease:Cubic.easeOut,delay:delay}),TweenLite.to(a.one,1*time2,{alpha:1,onComplete:function(){TweenLite.to(a.one.scale,1*time,{x:.5,y:.5,ease:Cubic.easeOut,delay:delay}),TweenLite.to(a.one,1*time,{alpha:0,onComplete:function(){a.visible=!1,a.onComplete()},delay:delay})},delay:delay}),TweenLite.to(a.one.scale,1*time2,{x:1,y:1,ease:Elastic.easeOut,delay:delay})},delay:delay}),TweenLite.to(this.two.scale,1*time2,{x:1,y:1,ease:Elastic.easeOut,delay:delay})};var GAME=GAME||{};GAME.Splash=function(){this.textures=[PIXI.Texture.fromFrameId("lavaFrame_01.png"),PIXI.Texture.fromFrameId("lavaFrame_02.png"),PIXI.Texture.fromFrameId("lavaFrame_03.png"),PIXI.Texture.fromFrameId("lavaFrame_04.png"),PIXI.Texture.fromFrameId("lavaFrame_05.png"),PIXI.Texture.fromFrameId("lavaFrame_06.png"),PIXI.Texture.fromFrameId("lavaFrame_07.png"),PIXI.Texture.fromFrameId("lavaFrame_08.png"),PIXI.Texture.fromFrameId("lavaFrame_09.png"),PIXI.Texture.fromFrameId("lavaFrame_10.png"),PIXI.Texture.fromFrameId("lavaFrame_11.png"),PIXI.Texture.fromFrameId("lavaFrame_12.png")],PIXI.MovieClip.call(this,this.textures),this.anchor.x=.5,this.anchor.y=1,this.scale.x=this.scale.y=2,this.animationSpeed=.3,this.visible=!1,this.realPosition},GAME.Splash.constructor=GAME.Splash,GAME.Splash.prototype=Object.create(PIXI.MovieClip.prototype),GAME.Splash.prototype.splash=function(a){this.realPosition=a.x,this.position.y=620,this.gotoAndPlay(0),this.visible=!0},GAME.Splash.prototype.updateTransform=function(){this.visible&&(PIXI.MovieClip.prototype.updateTransform.call(this),this.position.x=this.realPosition-GAME.camera.x,this.currentFrame>this.textures.length-1&&(this.stop(),this.visible=!1))};var GAME=GAME||{};GAME.PowerBar=function(){PIXI.DisplayObjectContainer.call(this),this.barBG=PIXI.Sprite.fromFrame("bulletTime_back.png"),this.addChild(this.barBG),this.barBG.position.x=20,this.barBG.position.y=30,this.bar=PIXI.Sprite.fromFrame("powerFillBar.png"),this.addChild(this.bar),this.bar.position.x=20,this.bar.position.y=30,this.frame=PIXI.Sprite.fromFrame("bulletTime_BG.png"),this.addChild(this.frame),this.position.x=100},GAME.PowerBar.constructor=GAME.PowerBar,GAME.PowerBar.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);var GAME=GAME||{};GAME.Score=function(){PIXI.DisplayObjectContainer.call(this),this.ratio=0,this.glyphs={0:"number_00.png",1:"number_01.png",2:"number_02.png",3:"number_03.png",4:"number_04.png",5:"number_05.png",6:"number_06.png",7:"number_07.png",8:"number_08.png",9:"number_09.png",",":"number_comma.png"};for(a in this.glyphs)this.glyphs[a]=PIXI.Texture.fromFrameId(this.glyphs[a]);this.digits=[];for(var a=0;8>a;a++)this.digits[a]=new PIXI.Sprite(this.glyphs[a]),this.addChild(this.digits[a]);this.setScore(formatScore(12345))},GAME.Score.constructor=PIXI.Score,GAME.Score.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Score.prototype.setScore=function(a){for(var b=formatScore(a).split(""),c=0,d=-10,e=0;e<b.length;e++){var f=this.digits[e];f.visible=!0,f.setTexture(this.glyphs[b[e]]),f.position.x=c,c+=f.width+d}for(var e=0;e<this.digits.length;e++)this.digits[e].position.x-=c;for(var e=b.length;e<this.digits.length;e++)this.digits[e].visible=!1},GAME.Score.prototype.jump=function(){this.ratio=2.2};var GAME=GAME||{};GAME.BestScore=function(){PIXI.DisplayObjectContainer.call(this),this.LocalStorage=new Fido.LocalStorage(GAME.bundleId),this.ratio=0,this.glyphs={0:"number_00.png",1:"number_01.png",2:"number_02.png",3:"number_03.png",4:"number_04.png",5:"number_05.png",6:"number_06.png",7:"number_07.png",8:"number_08.png",9:"number_09.png",",":"number_comma.png"};for(var a in this.glyphs)this.glyphs[a]=PIXI.Texture.fromFrameId(this.glyphs[a]);this.digits=[];for(var a=0;8>a;a++)this.digits[a]=new PIXI.Sprite(this.glyphs[a]),this.digits[a].scale.set(.36),this.addChild(this.digits[a]);this.title=PIXI.Sprite.fromFrame("assets/hud/PersonalBest.png"),this.title.anchor.x=0,this.title.anchor.y=0,this.title.position.y=1,this.addChild(this.title)},GAME.BestScore.constructor=PIXI.Score,GAME.BestScore.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.BestScore.prototype.setScore=function(a){var b=formatScore(a).split(""),c=0,d=3;this.title.position.x=0,c+=70+d;for(var e=0;e<b.length;e++){var f=this.digits[e];f.visible=!0,f.setTexture(this.glyphs[b[e]]),f.position.x=c,f.anchor.x=0,f.anchor.y=0,c+=f.width-d}c=150+c/2,this.title.position.x-=c;for(var e=0;e<this.digits.length;e++)this.digits[e].position.x-=c;for(var e=b.length;e<this.digits.length;e++)this.digits[e].visible=!1},GAME.BestScore.prototype.jump=function(){this.ratio=2.2},GAME.BestScore.prototype.update=function(){this.setScore(Math.round(parseInt(this.LocalStorage.get("highscore")))||0)};var GAME=GAME||{};GAME.GameObjectPool=function(a){this.classType=a,this.pool=[]},GAME.GameObjectPool.constructor=GAME.GameObjectPool,GAME.GameObjectPool.prototype.getObject=function(){var a=this.pool.pop();return a||(a=new this.classType),a},GAME.GameObjectPool.prototype.returnObject=function(){};var GAME=GAME||{},laserCount=0;GAME.CollisionManager=function(a){this.engine=a},GAME.CollisionManager.constructor=GAME.CollisionManager,GAME.CollisionManager.prototype.update=function(){this.playerVsBlock(),this.playerVsPickup(),this.playerVsFloor()},GAME.CollisionManager.prototype.playerVsBlock=function(){for(var a=this.engine.enemyManager.enemies,b=this.engine.steve,c=0;c<a.length;c++){var d=a[c],e=d.position.x-b.position.x;if(e>-d.width/2&&e<d.width/2){var f=d.position.y-b.position.y;f>-d.height/2-20&&f<d.height/2&&(b.joyRiding||(b.die(),this.engine.gameover(),d.hit()))}}},GAME.CollisionManager.prototype.playerVsPickup=function(){for(var a=this.engine.pickupManager.pickups,b=this.engine.steve,c=0;c<a.length;c++){var d=a[c];if(!d.isPickedUp){var e=d.position.x-b.position.x;if(e>-d.width/2&&e<d.width/2){var f=d.position.y-b.position.y;f>-d.height/2&&f<d.height/2&&(this.engine.pickupManager.removePickup(c),this.engine.pickup())}}}},GAME.CollisionManager.prototype.playerVsFloor=function(){var a=this.engine.floorManager.floors,b=this.engine.steve,c=a.length;if(b.onGround=!1,b.position.y>610){if(!this.engine.isPlaying)return b.speed.x*=.95,interactive||(showGameover(),interactive=!0),void(0===b.bounce&&(b.bounce++,b.boil(),this.engine.view.doSplash()));b.boil(),this.engine.view.doSplash(),this.engine.gameover()}for(var d=0;c>d;d++){var e=a[d],f=e.x-b.position.x+1135;if(b.position.y>477&&f>0&&1135>f){if(b.isDead){if(b.bounce++,b.bounce>2)return;FidoAudio.play("thudBounce"),b.view.setTexture(b.crashFrames[b.bounce]),b.speed.y*=-.7,b.speed.x*=.8,b.rotationSpeed=b.rotationSpeed>0?Math.random()*-.3:0===b.rotationSpeed?.3*Math.random():0}else b.speed.y=-.3;b.isFlying||(b.position.y=478,b.onGround=!0)}}b.position.y<0&&(b.position.y=0,b.speed.y*=0)};var GAME=GAME||{};GAME.FloorManager=function(a){this.engine=a,this.count=0,this.floors=[],this.floorPool=new GAME.GameObjectPool(GAME.Floor)},GAME.FloorManager.constructor=GAME.FloorManager,GAME.FloorManager.prototype.update=function(){for(var a=0;a<this.floors.length;a++){var b=this.floors[a];b.position.x=b.x-GAME.camera.x-16,b.position.x<-1135-GAME.xOffset-16&&(this.floorPool.returnObject(b),this.floors.splice(a,1),a--,this.engine.view.gameFront.removeChild(b))}},GAME.FloorManager.prototype.addFloor=function(a){var b=this.floorPool.getObject();b.x=a,b.position.y=482,this.engine.view.gameFront.addChild(b),this.floors.push(b)},GAME.FloorManager.prototype.destroyAll=function(){for(var a=0;a<this.floors.length;a++){var b=this.floors[a];this.floorPool.returnObject(b),this.engine.view.gameFront.removeChild(b)}this.floors=[]},GAME.Floor=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrameId("00_forest_floor.png"))},GAME.Floor.constructor=PIXI.Floor,GAME.Floor.prototype=Object.create(PIXI.Sprite.prototype);var GAME=GAME||{};GAME.SegmentManager=function(a){this.engine=a,this.sections=data,this.count=0,this.currentSegment=data[0],this.startSegment={length:2270,floor:[0,1135],blocks:[],coins:[]},this.chillMode=!0,this.last=0,this.position=0},GAME.SegmentManager.constructor=GAME.SegmentManager,GAME.SegmentManager.prototype.reset=function(a){a&&(this.count=0),this.currentSegment=this.startSegment,this.currentSegment.start=-200;for(var b=0;b<this.currentSegment.floor.length;b++)this.engine.floorManager.addFloor(this.currentSegment.start+this.currentSegment.floor[b])},GAME.SegmentManager.prototype.update=function(){this.position=GAME.camera.x+2*width;var a=this.position-this.currentSegment.start;if(a>this.currentSegment.length){if(this.engine.joyrideMode){var b=this.startSegment;b.start=this.currentSegment.start+this.currentSegment.length,this.currentSegment=b;for(var c=0;c<this.currentSegment.floor.length;c++)this.engine.floorManager.addFloor(this.currentSegment.start+this.currentSegment.floor[c]);return}var b=this.sections[this.count%this.sections.length];b.start=this.currentSegment.start+this.currentSegment.length,this.currentSegment=b;for(var c=0;c<this.currentSegment.floor.length;c++)this.engine.floorManager.addFloor(this.currentSegment.start+this.currentSegment.floor[c]);for(var d=this.currentSegment.blocks,e=d.length/2,c=0;e>c;c++)this.engine.enemyManager.addEnemy(this.currentSegment.start+d[2*c],d[2*c+1]);for(var f=this.currentSegment.coins,e=f.length/2,c=0;e>c;c++)this.engine.pickupManager.addPickup(this.currentSegment.start+f[2*c],f[2*c+1]);this.count++}};var GAME=GAME||{},enemyFrames;GAME.Enemy=function(){this.position=new PIXI.Point,this.view=new PIXI.Sprite(PIXI.Texture.fromFrameId("spike_box.png")),this.view.anchor.x=.5,this.view.anchor.y=.5,this.isHit=!1,this.width=150,this.height=150},GAME.Enemy.constructor=GAME.Enemy,GAME.Enemy.prototype.reset=function(){this.explosion&&(this.view.removeChild(this.explosion),this.explosion.reset()),this.isHit=!1,this.view.width=157},GAME.Enemy.prototype.hit=function(){this.isHit||(FidoAudio.stop("blockHit"),FidoAudio.play("blockHit"),this.isHit=!0,this.explosion||(this.explosion=new GAME.Explosion),this.explosion.explode(),this.view.addChild(this.explosion),this.view.setTexture(PIXI.Texture.fromImage("img/empty.png")))},GAME.Enemy.prototype.update=function(){this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y};var GAME=GAME||{},laserCount=0;GAME.EnemyManager=function(a){this.engine=a,this.enemies=[],this.enemyPool=new GAME.GameObjectPool(GAME.Enemy),this.spawnCount=0},GAME.EnemyManager.constructor=GAME.EnemyManager,GAME.EnemyManager.prototype.update=function(){for(var a=0;a<this.enemies.length;a++){var b=this.enemies[a];b.update(),b.view.position.x<-100-GAME.xOffset&&!this.engine.steve.isDead&&(this.enemyPool.returnObject(b),this.enemies.splice(a,1),this.engine.view.gameFront.removeChild(b.view),a--)}},GAME.EnemyManager.prototype.addEnemy=function(a,b){var c=this.enemyPool.getObject();c.position.x=a,c.position.y=b,this.enemies.push(c),this.engine.view.gameFront.addChild(c.view)},GAME.EnemyManager.prototype.destroyAll=function(){for(var a=0;a<this.enemies.length;a++){var b=this.enemies[a];b.reset(),this.enemyPool.returnObject(b),this.engine.view.gameFront.removeChild(b.view)}this.enemies=[]},GAME.EnemyManager.prototype.destroyAllOffScreen=function(){for(var a=0;a<this.enemies.length;a++){var b=this.enemies[a];b.x>GAME.camera.x+GAME.width&&(this.enemyPool.returnObject(b),this.engine.view.game.removeChild(b.view),this.enemies.splice(a,1),a--)}};var GAME=GAME||{},enemyFrames,pickupTextures;GAME.Pickup=function(){pickupTextures||(pickupTextures=["pickup_01.png","pickup_02.png","pickup_03.png","pickup_04.png","pickup_05.png","pickup_06.png","pickup_07.png","pickup_08.png"]),this.position=new PIXI.Point,this.view=new PIXI.DisplayObjectContainer,this.clip=new PIXI.Sprite(PIXI.Texture.fromFrameId(pickupTextures[Math2.randomInt(0,pickupTextures.length-1)])),this.clip.anchor.x=.5,this.clip.anchor.y=.5,this.shine=PIXI.Sprite.fromFrame("pickupShine.png"),this.shine.anchor.x=this.shine.anchor.y=.5,this.shine.scale.x=this.shine.scale.y=1,this.shine.alpha=.5,GAME.lowMode||this.view.addChild(this.shine),this.view.addChild(this.clip),this.width=100,this.height=100,this.count=300*Math.random()},GAME.Pickup.constructor=GAME.Pickup,GAME.Pickup.prototype.reset=function(){},GAME.Pickup.prototype.update=function(){this.isPickedUp?(this.view.scale.x=1-this.ratio,this.view.scale.y=1-this.ratio,this.position.x=this.pickupPosition.x+(this.steve.position.x-this.pickupPosition.x)*this.ratio,this.position.y=this.pickupPosition.y+(this.steve.position.y-this.pickupPosition.y)*this.ratio):(this.count+=.1*GAME.time.DELTA_TIME,this.clip.scale.x=.75+.1*Math.sin(this.count),this.clip.scale.y=.75-.1*Math.cos(this.count),this.clip.rotation=.2*Math.sin(1.5*this.count),this.shine.rotation=.2*this.count),this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y};var GAME=GAME||{},laserCount=0;GAME.PickupManager=function(a){this.engine=a,this.pickups=[],this.pickupPool=new GAME.GameObjectPool(GAME.Pickup),this.spawnCount=0,this.pos=0},GAME.PickupManager.constructor=GAME.PickupManager,GAME.PickupManager.prototype.update=function(){this.engine.joyrideMode&&(this.spawnCount+=GAME.time.DELTA_TIME,this.spawnCount>5&&(this.pos+=.15,this.spawnCount=0,this.addPickup(GAME.camera.x+GAME.width,280+180*Math.sin(this.pos))));for(var a=0;a<this.pickups.length;a++){var b=this.pickups[a];b.update(),b.isPickedUp?(b.ratio+=.3*(1-b.ratio)*GAME.time.DELTA_TIME,b.ratio>.99&&(this.pickupPool.returnObject(b),this.pickups.splice(a,1),this.engine.view.game.removeChild(b.view),a--)):b.view.position.x<-100-GAME.xOffset&&(this.engine.view.game.removeChild(b.view),this.pickupPool.returnObject(b),this.pickups.splice(a,1),a--)}},GAME.PickupManager.prototype.addPickup=function(a,b){var c=this.pickupPool.getObject();c.position.x=a,c.position.y=b,this.pickups.push(c),this.engine.view.game.addChild(c.view)},GAME.PickupManager.prototype.removePickup=function(a){var b=this.pickups[a];b.isPickedUp=!0,b.steve=this.engine.steve,b.pickupPosition={x:b.position.x,y:b.position.y},b.ratio=0},GAME.PickupManager.prototype.destroyAll=function(){for(var a=0;a<this.pickups.length;a++){var b=this.pickups[a];this.pickupPool.returnObject(b),this.engine.view.game.removeChild(b.view)}this.pickups=[]},GAME.PickupManager.prototype.destroyAllOffScreen=function(){for(var a=0;a<this.pickups.length;a++){var b=this.pickups[a];b.x>GAME.camera.x+GAME.width&&(this.pickupPool.returnObject(b),this.engine.view.game.removeChild(b.view),this.pickups.splice(a,1),a--)}};var GAME=GAME||{};GAME.HIGH_MODE=!0,GAME.camera=new PIXI.Point,GAME.height,GAME.bundleId="com.goodboy.runpixierun",GAME.newHighScore=!1,GAME.RprEngine=function(){this.onGameover,this.steve=new GAME.Steve,this.view=new GAME.RprView(this),this.segmentManager=new GAME.SegmentManager(this),this.enemyManager=new GAME.EnemyManager(this),this.pickupManager=new GAME.PickupManager(this),this.floorManager=new GAME.FloorManager(this),this.collisionManager=new GAME.CollisionManager(this),this.LocalStorage=new Fido.LocalStorage(GAME.bundleId),this.steve.view.visible=!1,this.bulletMult=1,this.pickupCount=0,this.score=0,this.joyrideMode=!1,this.joyrideCountdown=0,this.isPlaying=!1,this.levelCount=0,this.gameReallyOver=!1,this.isDying=!1,this.view.game.addChild(this.steve.view)},GAME.RprEngine.prototype.start=function(){this.segmentManager.reset(),this.enemyManager.destroyAll(),this.pickupManager.destroyAll(),this.isPlaying=!0,this.gameReallyOver=!1,this.score=0,this.steve.level=1,this.steve.position.y=477,this.steve.speed.y=0,this.steve.speed.x=this.steve.baseSpeed,this.steve.view.rotation=0,this.steve.isFlying=!1,this.steve.isDead=!1,this.steve.view.play(),this.steve.view.visible=!0,this.segmentManager.chillMode=!1,this.bulletMult=1},GAME.RprEngine.prototype.update=function(){GAME.time.update();var a=0;a>0&&(a=0),-70>a&&(a=-70),GAME.camera.y=a,gameMode!==GAME_MODE.PAUSED?(this.steve.update(),this.collisionManager.update(),this.segmentManager.update(),this.floorManager.update(),this.enemyManager.update(),this.pickupManager.update(),this.joyrideMode&&(this.joyrideCountdown-=GAME.time.DELTA_TIME,this.joyrideCountdown<=0&&this.joyrideComplete()),this.levelCount+=GAME.time.DELTA_TIME,this.levelCount>3600&&(this.levelCount=0,this.steve.level+=.05,GAME.time.speed+=.05)):this.joyrideMode&&(this.joyrideCountdown+=GAME.time.DELTA_TIME),this.view.update()},GAME.RprEngine.prototype.reset=function(){this.enemyManager.destroyAll(),this.floorManager.destroyAll(),this.segmentManager.reset(),this.view.zoom=1,this.pickupCount=0,this.levelCount=0,this.steve.level=1,this.view.game.addChild(this.steve.view)},GAME.RprEngine.prototype.joyrideComplete=function(){this.joyrideMode=!1,this.pickupCount=0,this.bulletMult+=.3,this.view.normalMode(),this.steve.normalMode(),this.enemyManager.destroyAll()},GAME.RprEngine.prototype.gameover=function(){this.isPlaying=!1,this.isDying=!0,this.segmentManager.chillMode=!0;var a=this.LocalStorage.get("highscore");(!a||this.score>a)&&(this.LocalStorage.store("highscore",this.score),GAME.newHighscore=!0),this.onGameover(),this.view.game.addChild(this.steve.view),TweenLite.to(this.view,.5,{zoom:2,ease:Cubic.easeOut})},GAME.RprEngine.prototype.gameoverReal=function(){this.gameReallyOver=!0,this.isDying=!1,this.onGameoverReal()},GAME.RprEngine.prototype.pickup=function(){if(!this.steve.isDead){if(this.score+=10,this.joyrideMode)return FidoAudio.stop("pickup"),void FidoAudio.play("pickup");this.view.score.jump(),this.pickupCount++,FidoAudio.stop("pickup"),FidoAudio.play("pickup"),this.pickupCount>=50*this.bulletMult&&!this.steve.isDead&&(this.pickupCount=0,this.joyrideMode=!0,this.joyrideCountdown=600,this.view.joyrideMode(),this.steve.joyrideMode(),this.steve.position.x=0,GAME.camera.x=game.steve.position.x-100,this.enemyManager.destroyAll(),this.pickupManager.destroyAll(),this.floorManager.destroyAll(),this.segmentManager.reset())}},Time=function(){this.DELTA_TIME=1,this.lastTime=Date.now(),this.speed=1},Time.constructor=Time,Time.prototype.update=function(){var a=Date.now(),b=a,c=b-this.lastTime;this.DELTA_TIME=.06*c,this.DELTA_TIME*=this.speed,this.DELTA_TIME>2.3&&(this.DELTA_TIME=2.3),this.lastTime=b},GAME.time=new Time;var GAME=GAME||{};GAME.Steve=function(){this.position=new PIXI.Point,this.runningFrames=[PIXI.Texture.fromFrame("characterRUNscaled_01.png"),PIXI.Texture.fromFrame("characterRUNscaled_02.png"),PIXI.Texture.fromFrame("characterRUNscaled_03.png"),PIXI.Texture.fromFrame("characterRUNscaled_04.png"),PIXI.Texture.fromFrame("characterRUNscaled_05.png"),PIXI.Texture.fromFrame("characterRUNscaled_06.png"),PIXI.Texture.fromFrame("characterRUNscaled_07.png"),PIXI.Texture.fromFrame("characterRUNscaled_08.png"),PIXI.Texture.fromFrame("characterRUNscaled_09.png")],this.flyingFrames=[PIXI.Texture.fromFrame("characterFLATflying_01.png"),PIXI.Texture.fromFrame("characterFLATflying_02.png"),PIXI.Texture.fromFrame("characterFLATflying_03.png")],this.crashFrames=[PIXI.Texture.fromFrame("characterFALLscaled3.png"),PIXI.Texture.fromFrame("characterFALLscaled1.png"),PIXI.Texture.fromFrame("characterFALLscaled3.png")],this.view=new PIXI.MovieClip(this.flyingFrames),this.view.animationSpeed=.23,this.view.anchor.x=.5,this.view.anchor.y=.5,this.position.y=477,this.ground=477,this.gravity=.3,this.baseSpeed=8,this.speed=new PIXI.Point(this.baseSpeed,0),this.activeCount=0,this.isFlying=!1,this.accel=0,this.width=26,this.height=37,this.onGround=!1,this.rotationSpeed=0,this.joyRiding=!1,this.level=1,this.realAnimationSpeed=.23,this.volume=.3},GAME.Steve.constructor=GAME.Steve,GAME.Steve.prototype.update=function(){this.isDead?this.updateDieing():this.updateRunning()},GAME.Steve.prototype.joyrideMode=function(){this.joyRiding=!0,FidoAudio.setVolume("runRegular",0),FidoAudio.play("hyperMode"),TweenLite.to(this.speed,.3,{x:20,ease:Cubic.easeIn}),this.realAnimationSpeed=.92},GAME.Steve.prototype.normalMode=function(){this.joyRiding=!1,FidoAudio.setVolume("runFast",0),this.onGround===!0&&FidoAudio.setVolume("runRegular",this.volume),TweenLite.to(this.speed,.6,{x:this.baseSpeed,ease:Cubic.easeOut}),this.realAnimationSpeed=.23},GAME.Steve.prototype.updateRunning=function(){this.view.animationSpeed=this.realAnimationSpeed*GAME.time.DELTA_TIME*this.level,this.isActive&&(this.isFlying=!0);var a=this.speed.y;this.isFlying?(this.accel=.6,this.speed.y-=this.accel*GAME.time.DELTA_TIME,this.speed.y>0&&(this.speed.y-=.3*GAME.time.DELTA_TIME)):this.speed.y<0&&(this.speed.y+=.05*GAME.time.DELTA_TIME),this.speed.y+=this.gravity*GAME.time.DELTA_TIME,this.speed.y>8&&(this.speed.y=8),this.speed.y<-9&&(this.speed.y=-9);this.speed.y-a;this.position.x+=this.speed.x*GAME.time.DELTA_TIME*this.level,this.position.y+=this.speed.y*GAME.time.DELTA_TIME,this.onGround!==this.onGroundCache&&(this.onGroundCache=this.onGround,this.onGround?(this.view.textures=this.runningFrames,this.joyRiding===!0?(FidoAudio.setVolume("runFast",this.volume),FidoAudio.setVolume("runRegular",0)):(FidoAudio.setVolume("runRegular",this.volume),FidoAudio.setVolume("runFast",0))):(FidoAudio.setVolume("runFast",0),FidoAudio.setVolume("runRegular",0),this.view.textures=this.flyingFrames)),GAME.camera.x=this.position.x-100,this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y-GAME.camera.y,this.view.rotation+=.1*(.05*this.speed.y-this.view.rotation)},GAME.Steve.prototype.updateDieing=function(){this.speed.x*=.999,this.onGround&&(this.speed.y*=.99),this.speed.y+=.1,this.accel+=.1*(0-this.accel)*GAME.time.DELTA_TIME,this.speed.y+=this.gravity*GAME.time.DELTA_TIME,this.position.x+=this.speed.x*GAME.time.DELTA_TIME,this.position.y+=this.speed.y*GAME.time.DELTA_TIME,GAME.camera.x=this.position.x-100,this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y-GAME.camera.y,this.view.rotation+=this.speed.x<5?this.rotationSpeed*(this.speed.x/5)*GAME.time.DELTA_TIME:this.rotationSpeed*GAME.time.DELTA_TIME},GAME.Steve.prototype.jump=function(){this.isDead&&this.speed.x<5&&(this.isDead=!1,this.speed.x=10),this.position.y!==this.ground?this.isFlying=!0:(this.isActive=!0,this.activeCount=0)},GAME.Steve.prototype.die=function(){this.isDead||(FidoAudio.setVolume("runFast",0),FidoAudio.setVolume("runRegular",0),FidoAudio.fadeOut("gameMusic"),TweenLite.to(GAME.time,.5,{speed:.1,ease:Cubic.easeOut,onComplete:function(){FidoAudio.play("deathJingle"),TweenLite.to(GAME.time,2,{speed:1,delay:1})}}),this.isDead=!0,this.bounce=0,this.speed.x=15,this.speed.y=-15,this.rotationSpeed=.3,this.view.stop())},GAME.Steve.prototype.boil=function(){this.isDead||(FidoAudio.setVolume("runFast",0),FidoAudio.setVolume("runRegular",0),FidoAudio.fadeOut("gameMusic"),FidoAudio.play("lavaSplosh"),FidoAudio.play("deathJingle"),this.isDead=!0)},GAME.Steve.prototype.fall=function(){this.isActive=!1,this.isFlying=!1},GAME.Steve.prototype.isAirbourne=function(){},GAME.Steve.prototype.stop=function(){this.view.stop(),FidoAudio.setVolume("runRegular",0)},GAME.Steve.prototype.resume=function(){this.view.play(),this.onGround&&FidoAudio.setVolume("runRegular",this.volume)},GAME.SteveTrail=function(a){this.stage=a,this.target=new PIXI.Point,this.particals=[],this.particalPool=new GAME.GameObjectPool(Partical),this.max=100,this.count=0},GAME.SteveTrail.constructor=GAME.SteveTrail,GAME.SteveTrail.prototype.update=function(){if(this.target.isFlying&&!this.target.isDead&&(this.count++,this.count%3)){var a=this.particalPool.getObject();this.stage.addChild(a),a.position.x=this.target.view.position.x+10*Math.random()-5-20,a.position.y=this.target.view.position.y+50,a.direction=0,a.dirSpeed=Math.random()>.5?-.1:.1,a.sign=this.particals.length%2?-1:1,a.scaly=2*Math.random()-1,a.speed.y=3*this.target.accel,a.alphay=2,a.rotation=Math.random()*Math.PI*2,a.scale.x=a.scale.y=.2+.5*Math.random(),this.particals.push(a)}for(var b=0;b<this.particals.length;b++){var a=this.particals[b];a.dirSpeed+=.003*a.sign,a.dirSpeed>2&&(a.dirSpeed=2),a.direction+=a.dirSpeed,a.speed.x=Math.sin(a.direction),a.speed.y=Math.cos(a.direction),a.position.x+=5*a.speed.x*a.scaly,a.position.y+=3*a.speed.y,a.alphay*=.85,a.rotation+=.1*a.speed.x,a.alpha=a.alphay>1?1:a.alphay,a.alpha<.01&&(this.stage.removeChild(a),this.particals.splice(b,1),this.particalPool.returnObject(a),b--)}},Partical=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrameId("starPops0004.png")),this.anchor.x=.5,this.anchor.y=.5,this.speed=new PIXI.Point},Partical.constructor=Partical,Partical.prototype=Object.create(PIXI.Sprite.prototype),GAME.Explosion=function(){PIXI.DisplayObjectContainer.call(this),this.particals=[],this.top=new ExplosionPartical("asplodeInner02.png"),this.bottom=new ExplosionPartical("asplodeInner01.png"),this.top.position.y=-20,this.bottom.position.y=20,this.top.position.x=20,this.bottom.position.x=20,this.anchor=new PIXI.Point,this.addChild(this.top),this.addChild(this.bottom),this.particals=[this.top,this.bottom];for(var a=0;5>a;a++)this.particals.push(new ExplosionPartical("asplodeSpike_01.png")),this.particals.push(new ExplosionPartical("asplodeSpike_02.png"));this.clouds=[];for(var a=0;5>a;a++){var b=new PIXI.Sprite.fromFrame("dustSwirl.png");this.clouds.push(b),this.addChild(b)}this.reset()},GAME.Explosion.constructor=GAME.Explosion,GAME.Explosion.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Explosion.prototype.explode=function(){this.exploding=!0},GAME.Explosion.prototype.reset=function(){for(var a=0;5>a;a++){var b=this.clouds[a];
b.anchor.x=.5,b.anchor.y=.5,b.scaleTarget=2+2*Math.random(),b.scale.x=b.scale.x=.5,b.alpha=.75,b.position.x=150*(Math.random()-.5),b.position.y=150*(Math.random()-.5),b.speed=new PIXI.Point(20*Math.random()-10,20*Math.random()-10),b.state=0,b.rotSpeed=.05*Math.random()}for(var a=0;a<this.particals.length;a++){var c=this.particals[a];this.addChild(c);var d=a/this.particals.length*Math.PI*2,e=7+Math.random();c.directionX=Math.cos(d)*e,c.directionY=Math.sin(d)*e,c.rotation=-d,c.rotationSpeed=.02*Math.random()}},GAME.Explosion.prototype.updateTransform=function(){if(this.exploding){for(var a=0;a<this.clouds.length;a++){var b=this.clouds[a];b.rotation+=b.rotSpeed,0===b.state?(b.scale.x+=.4*(b.scaleTarget-b.scale.x),b.scale.y=b.scale.x,b.scale.x>b.scaleTarget-.1&&(b.state=1)):(b.position.x+=.05*b.speed.x,b.position.y+=.05*b.speed.y)}for(var a=0;a<this.particals.length;a++){var c=this.particals[a];c.directionY+=.1,c.directionX*=.99,c.position.x+=c.directionX,c.position.y+=c.directionY,c.rotation+=c.rotationSpeed}}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},ExplosionPartical=function(a){PIXI.Sprite.call(this,PIXI.Texture.fromFrame(a)),this.anchor.x=.5,this.anchor.y=.5,this.speed=new PIXI.Point},ExplosionPartical.constructor=ExplosionPartical,ExplosionPartical.prototype=Object.create(PIXI.Sprite.prototype),GAME.SteveTrailFire=function(a){this.stage=a,this.target=new PIXI.Point,this.particals=[],this.particalPool=new GAME.GameObjectPool(ParticalFire),this.max=100,this.count=0,this.mOffset=PIXI.mat3.create(),this.mOffset[2]=-30,this.mOffset[5]=30,this.spare=PIXI.mat3.create()},GAME.SteveTrailFire.constructor=GAME.SteveTrailFire,GAME.SteveTrailFire.prototype.update=function(){if(this.target.isDead&&(this.mOffset,PIXI.mat3.multiply(this.mOffset,this.target.view.localTransform,this.spare),this.count++,this.count%3)){var a=this.particalPool.getObject();this.stage.addChild(a),a.position.x=this.spare[2],a.position.y=this.spare[5],a.speed.x=1+2*Math.random(),a.speed.y=1+2*Math.random(),a.speed.x*=-1,a.speed.y*=1,a.alphay=2,a.rotation=Math.random()*Math.PI*2,a.scale.x=a.scale.y=.2+.5*Math.random(),this.particals.push(a)}for(var b=0;b<this.particals.length;b++){var a=this.particals[b];a.scale.x=a.scale.y*=1.02,a.alphay*=.85,a.alpha=a.alphay>1?1:a.alphay,a.position.x+=2*a.speed.x,a.position.y+=2*a.speed.y,a.alpha<.01&&(this.stage.removeChild(a),this.particals.splice(b,1),this.particalPool.returnObject(a),b--)}},ParticalFire=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrameId("fireCloud.png")),this.anchor.x=.5,this.anchor.y=.5,this.speed=new PIXI.Point},ParticalFire.constructor=ParticalFire,ParticalFire.prototype=Object.create(PIXI.Sprite.prototype),GAME.PixiDust=function(){PIXI.DisplayObjectContainer.call(this),this.particals=[],this.particalPool=new GAME.GameObjectPool(ParticalDust),this.max=GAME.HIGH_MODE?100:10,this.count=0;for(var a=0;a<this.max;a++){var b=this.particalPool.getObject();b.home.x=Math.random()*-GAME.width,b.position.y=b.home.y=110640*Math.random(),b.speed=new PIXI.Point(.2*(Math.random()-.5),.4*(Math.random()-.5)),this.particals.push(b),this.addChild(b)}this.focalLength=150},GAME.PixiDust.constructor=GAME.PixiDust,GAME.PixiDust.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.PixiDust.prototype.update=function(){for(var a=0;a<this.particals.length;a++){var b=this.particals[a],c=this.focalLength/(this.focalLength+b.z),c=this.focalLength/(this.focalLength+b.z);b.scale.x=b.scale.y=c,b.home.x+=b.speed.x,b.position.y+=b.speed.y,b.position.x=(b.home.x-GAME.camera.x)*c*1.5,b.position.x%=GAME.width,b.position.x<0&&(b.position.x+=GAME.width),b.position.y%=640,b.position.y<0&&(b.position.y+=640)}},ParticalDust=function(){ParticalDust.globalCount++,PIXI.Sprite.call(this,PIXI.Texture.fromFrameId(ParticalDust.frames[ParticalDust.globalCount%3])),this.anchor.x=.5,this.anchor.y=.5,this.z=500*Math.random(),this.rotation=Math.random()*Math.PI*2,this.home=new PIXI.Point,this.alpha=.5},ParticalDust.globalCount=0,ParticalDust.frames=["mote01.png","mote02.png","mote03.png"],ParticalDust.constructor=Partical,ParticalDust.prototype=Object.create(PIXI.Sprite.prototype),onReady();